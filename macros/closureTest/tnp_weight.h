#ifndef tnp_weight_h
#define tnp_weight_h

#include "TMath.h"

// IN THIS FILE YOU WILL FIND:
// ++++++++++++++
//
// - Trigger:
//   * idx = 0:  nominal
//   * idx = 1..100: toy variations, stat. only
//   * idx = -1: syst variation, "new_MAX", +1 sigma
//   * idx = -2: syst variation, "new_MAX", -1 sigma
//   * idx = -10: binned
// - MuID, STA: 
//   * same organisation. BUT these SF are for systematics only.

double tnp_weight_trg_pbpb(double x, double eta, int idx);
double tnp_weight_trg_pp(double x, double eta, int idx);
double tnp_weight_muid_pbpb(double x, double eta);
double tnp_weight_muid_pp(double x, double eta, int idx=0);
double tnp_weight_sta_pp(double x, double eta, int idx=0);

///////////////////////////////////////////////////
//               T R G    P b P b                //
///////////////////////////////////////////////////
double tnp_weight_trg_pbpb(double x, double eta, int idx)
{
   // binned
   if (idx == -10) {
      if (fabs(eta) < 1.2) {
         // 0 < |eta| < 1.2
         if (x<4) return 1.05083;
         else if (x<4.5) return 1.00482;
         else if (x<5) return 0.991942;
         else if (x<5.5) return 0.999019;
         else if (x<6.5) return 0.998047;
         else if (x<8) return 0.982955;
         else if (x<10.5) return 0.994642;
         else if (x<14) return 0.982937;
         else if (x<18) return 0.980605;
         else return 1.00328;
      } else if (fabs(eta) < 1.8) {
         // 1.2 < |eta| < 1.8
         if (x<3) return 1.141;
         else if (x<3.5) return 1.08315;
         else if (x<4) return 1.03487;
         else if (x<4.5) return 1.01835;
         else if (x<5) return 0.997828;
         else if (x<6) return 0.987733;
         else if (x<7.5) return 1.00724;
         else if (x<10) return 0.994324;
         else if (x<15) return 1.01714;
         else return 1.01007;
      } else if (fabs(eta) < 2.1) {
         // 1.8 < |eta| < 2.1
         if (x<2) return 1.45635;
         else if (x<2.5) return 1.23666;
         else if (x<3) return 1.09206;
         else if (x<3.5) return 1.06978;
         else if (x<4) return 1.02001;
         else if (x<4.5) return 1.03328;
         else if (x<5.5) return 1.02344;
         else if (x<6.5) return 1.03221;
         else if (x<8) return 0.979755;
         else if (x<9.5) return 0.9832;
         else if (x<13) return 1.0359;
         else return 0.97688;
      } else {
         // 2.1 < |eta| < 2.4
         if (x<2.2) return 1.27031;
         else if (x<2.7) return 1.15418;
         else if (x<3.2) return 1.06914;
         else if (x<3.7) return 1.04694;
         else if (x<4.7) return 1.06675;
         else if (x<6.5) return 1.04215;
         else if (x<8.5) return 1.02019;
         else if (x<11) return 1.03374;
         else return 1.07708;
      }
   }

   // denominator (from MC)
   double den=1;
   if (fabs(eta)<1.2) den = 0.97701*TMath::Erf((x-2.38691)/1.31574);
   else if (fabs(eta)<1.8) den = 0.94675*TMath::Erf((x-2.29271)/1.19047);
   else if (fabs(eta)<2.1) den = 0.89781*TMath::Erf((x-0.80641)/2.31842);
   else den = 0.87208*TMath::Erf((x-0.63360)/1.99416);

   // numerator (from data)
   double num=1;

   if (fabs(eta)<1.2)
   {
      if (idx==0) num = 0.96859*TMath::Erf((x-1.86137)/1.57333);
      else if (idx == -1   ) num = 0.96934*TMath::Erf((x-1.86313)/1.55954);
      else if (idx == -2   ) num = 0.96786*TMath::Erf((x-1.86663)/1.57798);
      else if (idx == 1   ) num = 0.97220*TMath::Erf((x-0.68242)/2.39776);
      else if (idx == 2   ) num = 0.96885*TMath::Erf((x-2.06374)/1.46946);
      else if (idx == 3   ) num = 0.96628*TMath::Erf((x-1.99454)/1.48976);
      else if (idx == 4   ) num = 0.96903*TMath::Erf((x-2.05862)/1.44175);
      else if (idx == 5   ) num = 0.96828*TMath::Erf((x-1.69241)/1.68223);
      else if (idx == 6   ) num = 0.96664*TMath::Erf((x-1.84564)/1.56131);
      else if (idx == 7   ) num = 0.97196*TMath::Erf((x-1.89639)/1.59681);
      else if (idx == 8   ) num = 0.96775*TMath::Erf((x-1.90964)/1.56506);
      else if (idx == 9   ) num = 0.96701*TMath::Erf((x-2.07249)/1.42218);
      else if (idx == 10  ) num = 0.96758*TMath::Erf((x-2.24322)/1.24312);
      else if (idx == 11  ) num = 0.96434*TMath::Erf((x-1.76470)/1.66288);
      else if (idx == 12  ) num = 0.97217*TMath::Erf((x-1.50141)/1.86413);
      else if (idx == 13  ) num = 0.96988*TMath::Erf((x-2.05018)/1.45612);
      else if (idx == 14  ) num = 0.96816*TMath::Erf((x-1.55670)/1.82452);
      else if (idx == 15  ) num = 0.96473*TMath::Erf((x-2.15182)/1.34965);
      else if (idx == 16  ) num = 0.97441*TMath::Erf((x-0.87068)/2.42192);
      else if (idx == 17  ) num = 0.96730*TMath::Erf((x-1.86952)/1.58975);
      else if (idx == 18  ) num = 0.96938*TMath::Erf((x-2.33178)/1.24227);
      else if (idx == 19  ) num = 0.97152*TMath::Erf((x-1.01588)/2.19496);
      else if (idx == 20  ) num = 0.96818*TMath::Erf((x-2.03238)/1.47533);
      else if (idx == 21  ) num = 0.97003*TMath::Erf((x-1.31970)/2.00786);
      else if (idx == 22  ) num = 0.96844*TMath::Erf((x-2.14262)/1.36264);
      else if (idx == 23  ) num = 0.97174*TMath::Erf((x-1.66324)/1.76821);
      else if (idx == 24  ) num = 0.96475*TMath::Erf((x-2.61641)/0.96294);
      else if (idx == 25  ) num = 0.96945*TMath::Erf((x-1.96163)/1.51640);
      else if (idx == 26  ) num = 0.96596*TMath::Erf((x-2.51843)/1.01968);
      else if (idx == 27  ) num = 0.97182*TMath::Erf((x-1.34291)/2.04292);
      else if (idx == 28  ) num = 0.96863*TMath::Erf((x-1.80088)/1.59445);
      else if (idx == 29  ) num = 0.96562*TMath::Erf((x-1.85628)/1.57174);
      else if (idx == 30  ) num = 0.97149*TMath::Erf((x-1.25275)/2.02267);
      else if (idx == 31  ) num = 0.96800*TMath::Erf((x-1.16419)/2.03537);
      else if (idx == 32  ) num = 0.96567*TMath::Erf((x-1.92222)/1.50817);
      else if (idx == 33  ) num = 0.96846*TMath::Erf((x-2.05640)/1.42841);
      else if (idx == 34  ) num = 0.96960*TMath::Erf((x-1.02677)/2.21714);
      else if (idx == 35  ) num = 0.96744*TMath::Erf((x-1.84682)/1.56258);
      else if (idx == 36  ) num = 0.96905*TMath::Erf((x-1.27446)/2.03285);
      else if (idx == 37  ) num = 0.96981*TMath::Erf((x-1.21539)/2.10635);
      else if (idx == 38  ) num = 0.97227*TMath::Erf((x-1.43724)/1.90706);
      else if (idx == 39  ) num = 0.96527*TMath::Erf((x-2.26238)/1.26417);
      else if (idx == 40  ) num = 0.96588*TMath::Erf((x-1.74047)/1.62838);
      else if (idx == 41  ) num = 0.97303*TMath::Erf((x-2.05165)/1.44574);
      else if (idx == 42  ) num = 0.96872*TMath::Erf((x-1.49195)/1.83047);
      else if (idx == 43  ) num = 0.97314*TMath::Erf((x-1.08069)/2.21919);
      else if (idx == 44  ) num = 0.96384*TMath::Erf((x-2.00338)/1.40617);
      else if (idx == 45  ) num = 0.96519*TMath::Erf((x-2.52126)/1.00854);
      else if (idx == 46  ) num = 0.97054*TMath::Erf((x-1.66028)/1.74479);
      else if (idx == 47  ) num = 0.97420*TMath::Erf((x-1.02555)/2.20491);
      else if (idx == 48  ) num = 0.96606*TMath::Erf((x-1.61424)/1.78328);
      else if (idx == 49  ) num = 0.96764*TMath::Erf((x-1.51521)/1.82161);
      else if (idx == 50  ) num = 0.97195*TMath::Erf((x-1.06257)/2.21002);
      else if (idx == 51  ) num = 0.97055*TMath::Erf((x-1.61494)/1.78469);
      else if (idx == 52  ) num = 0.96670*TMath::Erf((x-2.36340)/1.19428);
      else if (idx == 53  ) num = 0.96992*TMath::Erf((x-1.54537)/1.77335);
      else if (idx == 54  ) num = 0.96967*TMath::Erf((x-1.88416)/1.58906);
      else if (idx == 55  ) num = 0.96974*TMath::Erf((x-2.11529)/1.40003);
      else if (idx == 56  ) num = 0.96406*TMath::Erf((x-2.62453)/0.92872);
      else if (idx == 57  ) num = 0.96689*TMath::Erf((x-1.53479)/1.80108);
      else if (idx == 58  ) num = 0.96813*TMath::Erf((x-2.21323)/1.35774);
      else if (idx == 59  ) num = 0.97106*TMath::Erf((x-1.54930)/1.76601);
      else if (idx == 60  ) num = 0.96423*TMath::Erf((x-1.95907)/1.50410);
      else if (idx == 61  ) num = 0.96930*TMath::Erf((x-1.33853)/1.92124);
      else if (idx == 62  ) num = 0.96498*TMath::Erf((x-1.42071)/1.91352);
      else if (idx == 63  ) num = 0.96474*TMath::Erf((x-2.08557)/1.40885);
      else if (idx == 64  ) num = 0.96872*TMath::Erf((x-1.15552)/2.00911);
      else if (idx == 65  ) num = 0.96577*TMath::Erf((x-2.27128)/1.25865);
      else if (idx == 66  ) num = 0.97023*TMath::Erf((x-2.13485)/1.40311);
      else if (idx == 67  ) num = 0.96968*TMath::Erf((x-1.89762)/1.59839);
      else if (idx == 68  ) num = 0.97091*TMath::Erf((x-1.35985)/2.00688);
      else if (idx == 69  ) num = 0.96638*TMath::Erf((x-1.49899)/1.84060);
      else if (idx == 70  ) num = 0.96831*TMath::Erf((x-2.16703)/1.31999);
      else if (idx == 71  ) num = 0.96879*TMath::Erf((x-2.19541)/1.35264);
      else if (idx == 72  ) num = 0.96393*TMath::Erf((x-1.81291)/1.53774);
      else if (idx == 73  ) num = 0.96796*TMath::Erf((x-1.84917)/1.56368);
      else if (idx == 74  ) num = 0.96939*TMath::Erf((x-1.68146)/1.68299);
      else if (idx == 75  ) num = 0.96803*TMath::Erf((x-1.72499)/1.65927);
      else if (idx == 76  ) num = 0.96870*TMath::Erf((x-1.85842)/1.57117);
      else if (idx == 77  ) num = 0.96828*TMath::Erf((x-1.74760)/1.67636);
      else if (idx == 78  ) num = 0.97064*TMath::Erf((x-1.11443)/2.17887);
      else if (idx == 79  ) num = 0.96288*TMath::Erf((x-2.04989)/1.39129);
      else if (idx == 80  ) num = 0.96998*TMath::Erf((x-1.70891)/1.68305);
      else if (idx == 81  ) num = 0.97054*TMath::Erf((x-2.21671)/1.34494);
      else if (idx == 82  ) num = 0.96795*TMath::Erf((x-2.52571)/1.07716);
      else if (idx == 83  ) num = 0.97430*TMath::Erf((x-1.08618)/2.16423);
      else if (idx == 84  ) num = 0.97414*TMath::Erf((x-1.08249)/2.20265);
      else if (idx == 85  ) num = 0.96836*TMath::Erf((x-1.82504)/1.54366);
      else if (idx == 86  ) num = 0.96901*TMath::Erf((x-1.86514)/1.57647);
      else if (idx == 87  ) num = 0.96142*TMath::Erf((x-2.13986)/1.34664);
      else if (idx == 88  ) num = 0.96499*TMath::Erf((x-2.23478)/1.26678);
      else if (idx == 89  ) num = 0.96774*TMath::Erf((x-1.83814)/1.55635);
      else if (idx == 90  ) num = 0.96772*TMath::Erf((x-2.16838)/1.34425);
      else if (idx == 91  ) num = 0.97023*TMath::Erf((x-1.88892)/1.59164);
      else if (idx == 92  ) num = 0.96593*TMath::Erf((x-1.83388)/1.55283);
      else if (idx == 93  ) num = 0.96747*TMath::Erf((x-1.66498)/1.70099);
      else if (idx == 94  ) num = 0.96667*TMath::Erf((x-1.85033)/1.56688);
      else if (idx == 95  ) num = 0.97162*TMath::Erf((x-1.94503)/1.52424);
      else if (idx == 96  ) num = 0.96896*TMath::Erf((x-1.97393)/1.49615);
      else if (idx == 97  ) num = 0.96648*TMath::Erf((x-2.08178)/1.36789);
      else if (idx == 98  ) num = 0.96547*TMath::Erf((x-1.82265)/1.54430);
      else if (idx == 99  ) num = 0.96643*TMath::Erf((x-2.04637)/1.41923);
      else if (idx == 100 ) num = 0.97157*TMath::Erf((x-1.52176)/1.82833);
   }
   else if (fabs(eta)<1.8)
   {
      if (idx==0) num = 0.94753*TMath::Erf((x-2.29787)/1.01635);
      else if (idx == -1   ) num = 0.94854*TMath::Erf((x-2.28198)/1.02715);
      else if (idx == -2   ) num = 0.94645*TMath::Erf((x-2.31364)/1.00454);
      else if (idx == 1   ) num = 0.93891*TMath::Erf((x-2.23717)/1.06326);
      else if (idx == 2   ) num = 0.95035*TMath::Erf((x-2.26085)/1.03494);
      else if (idx == 3   ) num = 0.94591*TMath::Erf((x-2.27134)/1.03744);
      else if (idx == 4   ) num = 0.94767*TMath::Erf((x-2.31942)/1.01378);
      else if (idx == 5   ) num = 0.94674*TMath::Erf((x-2.36126)/0.91640);
      else if (idx == 6   ) num = 0.94910*TMath::Erf((x-2.33385)/0.94013);
      else if (idx == 7   ) num = 0.94639*TMath::Erf((x-2.36999)/0.88805);
      else if (idx == 8   ) num = 0.95082*TMath::Erf((x-2.23857)/1.07721);
      else if (idx == 9   ) num = 0.94217*TMath::Erf((x-2.14948)/1.16471);
      else if (idx == 10  ) num = 0.94969*TMath::Erf((x-2.12712)/1.24420);
      else if (idx == 11  ) num = 0.95102*TMath::Erf((x-2.20301)/1.21113);
      else if (idx == 12  ) num = 0.94243*TMath::Erf((x-2.31937)/0.97791);
      else if (idx == 13  ) num = 0.94950*TMath::Erf((x-2.29777)/1.01542);
      else if (idx == 14  ) num = 0.94172*TMath::Erf((x-2.33558)/0.95436);
      else if (idx == 15  ) num = 0.94669*TMath::Erf((x-2.31585)/0.98138);
      else if (idx == 16  ) num = 0.94140*TMath::Erf((x-2.34193)/0.95721);
      else if (idx == 17  ) num = 0.94066*TMath::Erf((x-2.27864)/0.98999);
      else if (idx == 18  ) num = 0.94452*TMath::Erf((x-2.42255)/0.85359);
      else if (idx == 19  ) num = 0.94454*TMath::Erf((x-2.29662)/0.97185);
      else if (idx == 20  ) num = 0.95021*TMath::Erf((x-2.31958)/0.98094);
      else if (idx == 21  ) num = 0.93799*TMath::Erf((x-2.35816)/0.96618);
      else if (idx == 22  ) num = 0.94021*TMath::Erf((x-2.38063)/0.86438);
      else if (idx == 23  ) num = 0.94562*TMath::Erf((x-2.30220)/1.02183);
      else if (idx == 24  ) num = 0.94959*TMath::Erf((x-2.18641)/1.18186);
      else if (idx == 25  ) num = 0.94133*TMath::Erf((x-2.34208)/0.91977);
      else if (idx == 26  ) num = 0.94345*TMath::Erf((x-2.33624)/0.95720);
      else if (idx == 27  ) num = 0.94955*TMath::Erf((x-2.32529)/1.01382);
      else if (idx == 28  ) num = 0.94769*TMath::Erf((x-2.40304)/0.94482);
      else if (idx == 29  ) num = 0.94500*TMath::Erf((x-2.23991)/1.09392);
      else if (idx == 30  ) num = 0.94590*TMath::Erf((x-2.24537)/1.07922);
      else if (idx == 31  ) num = 0.94729*TMath::Erf((x-2.34982)/0.92482);
      else if (idx == 32  ) num = 0.94876*TMath::Erf((x-2.32311)/1.08668);
      else if (idx == 33  ) num = 0.94686*TMath::Erf((x-2.35707)/0.93423);
      else if (idx == 34  ) num = 0.95105*TMath::Erf((x-2.27679)/1.07726);
      else if (idx == 35  ) num = 0.94809*TMath::Erf((x-2.30707)/1.03075);
      else if (idx == 36  ) num = 0.94118*TMath::Erf((x-2.40481)/0.83860);
      else if (idx == 37  ) num = 0.94852*TMath::Erf((x-2.22760)/1.14815);
      else if (idx == 38  ) num = 0.94586*TMath::Erf((x-2.17168)/1.15843);
      else if (idx == 39  ) num = 0.94267*TMath::Erf((x-2.24319)/1.06628);
      else if (idx == 40  ) num = 0.94839*TMath::Erf((x-2.14492)/1.18519);
      else if (idx == 41  ) num = 0.94786*TMath::Erf((x-2.28279)/1.02619);
      else if (idx == 42  ) num = 0.95361*TMath::Erf((x-2.21456)/1.12783);
      else if (idx == 43  ) num = 0.95182*TMath::Erf((x-2.41061)/0.88103);
      else if (idx == 44  ) num = 0.94294*TMath::Erf((x-2.38684)/0.87276);
      else if (idx == 45  ) num = 0.94664*TMath::Erf((x-2.35609)/0.94301);
      else if (idx == 46  ) num = 0.95070*TMath::Erf((x-2.34107)/0.94133);
      else if (idx == 47  ) num = 0.94784*TMath::Erf((x-2.25026)/1.08360);
      else if (idx == 48  ) num = 0.94703*TMath::Erf((x-2.17728)/1.20770);
      else if (idx == 49  ) num = 0.94515*TMath::Erf((x-2.41059)/0.88878);
      else if (idx == 50  ) num = 0.94555*TMath::Erf((x-2.29110)/1.00743);
      else if (idx == 51  ) num = 0.95038*TMath::Erf((x-2.28148)/1.05756);
      else if (idx == 52  ) num = 0.94894*TMath::Erf((x-2.28407)/1.06279);
      else if (idx == 53  ) num = 0.94710*TMath::Erf((x-2.28041)/0.98982);
      else if (idx == 54  ) num = 0.95541*TMath::Erf((x-2.21251)/1.08614);
      else if (idx == 55  ) num = 0.94509*TMath::Erf((x-2.40371)/0.93810);
      else if (idx == 56  ) num = 0.94875*TMath::Erf((x-2.29816)/1.01736);
      else if (idx == 57  ) num = 0.94759*TMath::Erf((x-2.22405)/1.12716);
      else if (idx == 58  ) num = 0.93943*TMath::Erf((x-2.28038)/0.99497);
      else if (idx == 59  ) num = 0.94327*TMath::Erf((x-2.32332)/0.94012);
      else if (idx == 60  ) num = 0.95543*TMath::Erf((x-2.23935)/1.16646);
      else if (idx == 61  ) num = 0.94589*TMath::Erf((x-2.34510)/0.93029);
      else if (idx == 62  ) num = 0.94766*TMath::Erf((x-2.25065)/1.06147);
      else if (idx == 63  ) num = 0.94184*TMath::Erf((x-2.28080)/0.99395);
      else if (idx == 64  ) num = 0.94917*TMath::Erf((x-2.26009)/1.08544);
      else if (idx == 65  ) num = 0.94972*TMath::Erf((x-2.41995)/0.85267);
      else if (idx == 66  ) num = 0.94466*TMath::Erf((x-2.48403)/0.71985);
      else if (idx == 67  ) num = 0.94739*TMath::Erf((x-2.32931)/0.94870);
      else if (idx == 68  ) num = 0.94794*TMath::Erf((x-2.32716)/0.95947);
      else if (idx == 69  ) num = 0.94985*TMath::Erf((x-2.39698)/0.89027);
      else if (idx == 70  ) num = 0.94932*TMath::Erf((x-2.43105)/0.84032);
      else if (idx == 71  ) num = 0.94999*TMath::Erf((x-2.35592)/0.93848);
      else if (idx == 72  ) num = 0.94787*TMath::Erf((x-2.31019)/0.99908);
      else if (idx == 73  ) num = 0.94926*TMath::Erf((x-2.27031)/1.03409);
      else if (idx == 74  ) num = 0.94586*TMath::Erf((x-2.29391)/1.01078);
      else if (idx == 75  ) num = 0.94758*TMath::Erf((x-2.24904)/1.08838);
      else if (idx == 76  ) num = 0.94769*TMath::Erf((x-2.33403)/0.94723);
      else if (idx == 77  ) num = 0.94380*TMath::Erf((x-2.27129)/0.97183);
      else if (idx == 78  ) num = 0.95347*TMath::Erf((x-2.30362)/1.02225);
      else if (idx == 79  ) num = 0.94351*TMath::Erf((x-2.32622)/0.95336);
      else if (idx == 80  ) num = 0.94761*TMath::Erf((x-2.31138)/1.03476);
      else if (idx == 81  ) num = 0.95175*TMath::Erf((x-2.15296)/1.16244);
      else if (idx == 82  ) num = 0.94968*TMath::Erf((x-2.22026)/1.12878);
      else if (idx == 83  ) num = 0.94696*TMath::Erf((x-2.15635)/1.15505);
      else if (idx == 84  ) num = 0.94943*TMath::Erf((x-2.31939)/1.00900);
      else if (idx == 85  ) num = 0.95889*TMath::Erf((x-2.18729)/1.15953);
      else if (idx == 86  ) num = 0.95373*TMath::Erf((x-2.16682)/1.17205);
      else if (idx == 87  ) num = 0.94640*TMath::Erf((x-2.25505)/1.09624);
      else if (idx == 88  ) num = 0.94846*TMath::Erf((x-2.28179)/1.07669);
      else if (idx == 89  ) num = 0.94782*TMath::Erf((x-2.33945)/0.97821);
      else if (idx == 90  ) num = 0.95920*TMath::Erf((x-2.14912)/1.25437);
      else if (idx == 91  ) num = 0.94757*TMath::Erf((x-2.26889)/1.09399);
      else if (idx == 92  ) num = 0.95188*TMath::Erf((x-2.19279)/1.17627);
      else if (idx == 93  ) num = 0.94202*TMath::Erf((x-2.29387)/1.01334);
      else if (idx == 94  ) num = 0.94066*TMath::Erf((x-2.34927)/0.85274);
      else if (idx == 95  ) num = 0.94680*TMath::Erf((x-2.42209)/0.83081);
      else if (idx == 96  ) num = 0.94319*TMath::Erf((x-2.32340)/0.92327);
      else if (idx == 97  ) num = 0.94924*TMath::Erf((x-2.17215)/1.18594);
      else if (idx == 98  ) num = 0.95353*TMath::Erf((x-2.25046)/1.09236);
      else if (idx == 99  ) num = 0.94240*TMath::Erf((x-2.37859)/0.88922);
      else if (idx == 100 ) num = 0.94808*TMath::Erf((x-2.20120)/1.15939);
   }
   else if (fabs(eta)<2.1)
   {
      if (idx==0) num = 0.90308*TMath::Erf((x+0.38340)/3.01756);
      else if (idx == -1   ) num = 0.91411*TMath::Erf((x+0.88702)/3.47188);
      else if (idx == -2   ) num = 0.89193*TMath::Erf((x-0.03453)/2.62900);
      else if (idx == 1   ) num = 0.90133*TMath::Erf((x+2.51524)/4.71657);
      else if (idx == 2   ) num = 0.89938*TMath::Erf((x-0.06893)/2.63399);
      else if (idx == 3   ) num = 0.90375*TMath::Erf((x+0.70347)/3.45947);
      else if (idx == 4   ) num = 0.90401*TMath::Erf((x-0.39313)/2.41467);
      else if (idx == 5   ) num = 0.88480*TMath::Erf((x+2.29709)/4.56739);
      else if (idx == 6   ) num = 0.89109*TMath::Erf((x+1.06979)/3.42303);
      else if (idx == 7   ) num = 0.89845*TMath::Erf((x+0.46623)/3.22404);
      else if (idx == 8   ) num = 0.92622*TMath::Erf((x+1.27287)/3.96030);
      else if (idx == 9   ) num = 0.90232*TMath::Erf((x+0.89344)/3.45003);
      else if (idx == 10  ) num = 0.90578*TMath::Erf((x-0.09903)/2.53014);
      else if (idx == 11  ) num = 0.89629*TMath::Erf((x+1.99642)/4.39586);
      else if (idx == 12  ) num = 0.87757*TMath::Erf((x+0.22838)/2.55574);
      else if (idx == 13  ) num = 0.90430*TMath::Erf((x-0.21894)/2.59751);
      else if (idx == 14  ) num = 0.92484*TMath::Erf((x-0.38317)/2.49856);
      else if (idx == 15  ) num = 0.90022*TMath::Erf((x-0.62171)/2.13680);
      else if (idx == 16  ) num = 0.90568*TMath::Erf((x-0.31125)/2.43715);
      else if (idx == 17  ) num = 0.90842*TMath::Erf((x+0.46539)/3.03519);
      else if (idx == 18  ) num = 0.91753*TMath::Erf((x+0.32573)/3.14621);
      else if (idx == 19  ) num = 0.89349*TMath::Erf((x-0.46061)/2.26023);
      else if (idx == 20  ) num = 0.91794*TMath::Erf((x+5.49976)/7.03158);
      else if (idx == 21  ) num = 0.88517*TMath::Erf((x+0.84423)/3.21242);
      else if (idx == 22  ) num = 0.90298*TMath::Erf((x+0.68959)/3.38150);
      else if (idx == 23  ) num = 0.92797*TMath::Erf((x+0.08437)/3.08065);
      else if (idx == 24  ) num = 0.89026*TMath::Erf((x-0.16617)/2.65288);
      else if (idx == 25  ) num = 0.92337*TMath::Erf((x+4.44746)/6.85401);
      else if (idx == 26  ) num = 0.88888*TMath::Erf((x+0.35533)/2.85771);
      else if (idx == 27  ) num = 0.90306*TMath::Erf((x+0.05722)/2.83532);
      else if (idx == 28  ) num = 0.90449*TMath::Erf((x+0.43834)/3.08061);
      else if (idx == 29  ) num = 0.92440*TMath::Erf((x+1.49333)/4.26229);
      else if (idx == 30  ) num = 0.90958*TMath::Erf((x+1.55308)/4.19987);
      else if (idx == 31  ) num = 0.87435*TMath::Erf((x-1.21415)/1.28728);
      else if (idx == 32  ) num = 0.90720*TMath::Erf((x+0.86987)/3.25010);
      else if (idx == 33  ) num = 0.89337*TMath::Erf((x+0.20992)/2.73142);
      else if (idx == 34  ) num = 0.89829*TMath::Erf((x+3.37266)/5.40874);
      else if (idx == 35  ) num = 0.89568*TMath::Erf((x+2.42446)/4.55309);
      else if (idx == 36  ) num = 0.89148*TMath::Erf((x-0.55512)/1.96536);
      else if (idx == 37  ) num = 0.90946*TMath::Erf((x+0.67907)/3.28619);
      else if (idx == 38  ) num = 0.89490*TMath::Erf((x+1.06397)/3.65065);
      else if (idx == 39  ) num = 0.90462*TMath::Erf((x-0.38578)/2.37546);
      else if (idx == 40  ) num = 0.87301*TMath::Erf((x-0.47416)/1.91654);
      else if (idx == 41  ) num = 0.87731*TMath::Erf((x-0.20504)/2.27713);
      else if (idx == 42  ) num = 0.88756*TMath::Erf((x-0.78447)/1.81204);
      else if (idx == 43  ) num = 0.91966*TMath::Erf((x-0.14912)/2.79753);
      else if (idx == 44  ) num = 0.90146*TMath::Erf((x-0.65164)/2.00435);
      else if (idx == 45  ) num = 0.91837*TMath::Erf((x+0.04792)/2.94349);
      else if (idx == 46  ) num = 0.89783*TMath::Erf((x+0.52600)/3.31095);
      else if (idx == 47  ) num = 0.89940*TMath::Erf((x+0.34263)/3.16886);
      else if (idx == 48  ) num = 0.88998*TMath::Erf((x-0.10339)/2.62082);
      else if (idx == 49  ) num = 0.91888*TMath::Erf((x-0.28315)/2.59053);
      else if (idx == 50  ) num = 0.91343*TMath::Erf((x+0.11011)/2.78660);
      else if (idx == 51  ) num = 0.88749*TMath::Erf((x+0.82065)/3.24149);
      else if (idx == 52  ) num = 0.89758*TMath::Erf((x-0.71825)/1.98357);
      else if (idx == 53  ) num = 0.90252*TMath::Erf((x-0.16748)/2.49708);
      else if (idx == 54  ) num = 0.91812*TMath::Erf((x+1.31527)/3.98975);
      else if (idx == 55  ) num = 0.91096*TMath::Erf((x-0.39460)/2.42503);
      else if (idx == 56  ) num = 0.91327*TMath::Erf((x+1.76644)/4.49519);
      else if (idx == 57  ) num = 0.93348*TMath::Erf((x-0.72815)/2.09701);
      else if (idx == 58  ) num = 0.89835*TMath::Erf((x+0.73167)/3.06207);
      else if (idx == 59  ) num = 0.89840*TMath::Erf((x+0.00238)/2.51083);
      else if (idx == 60  ) num = 0.89302*TMath::Erf((x+0.80239)/3.24793);
      else if (idx == 61  ) num = 0.87143*TMath::Erf((x+1.12502)/3.22869);
      else if (idx == 62  ) num = 0.92543*TMath::Erf((x+0.35322)/3.14925);
      else if (idx == 63  ) num = 0.89613*TMath::Erf((x+0.54113)/2.89346);
      else if (idx == 64  ) num = 0.88552*TMath::Erf((x+0.86215)/3.20295);
      else if (idx == 65  ) num = 0.89764*TMath::Erf((x-0.18359)/2.28236);
      else if (idx == 66  ) num = 0.91130*TMath::Erf((x+0.79615)/3.39557);
      else if (idx == 67  ) num = 0.90162*TMath::Erf((x-0.16368)/2.57634);
      else if (idx == 68  ) num = 0.89933*TMath::Erf((x-0.50153)/2.17003);
      else if (idx == 69  ) num = 0.91062*TMath::Erf((x+1.48648)/4.17404);
      else if (idx == 70  ) num = 0.90863*TMath::Erf((x+0.14089)/2.77845);
      else if (idx == 71  ) num = 0.90796*TMath::Erf((x+0.25725)/2.95999);
      else if (idx == 72  ) num = 0.88684*TMath::Erf((x-0.30889)/2.24101);
      else if (idx == 73  ) num = 0.89895*TMath::Erf((x-0.35268)/2.35784);
      else if (idx == 74  ) num = 0.90060*TMath::Erf((x+1.31374)/3.69622);
      else if (idx == 75  ) num = 0.90401*TMath::Erf((x+0.67193)/3.19159);
      else if (idx == 76  ) num = 0.89913*TMath::Erf((x+4.89065)/5.91700);
      else if (idx == 77  ) num = 0.88745*TMath::Erf((x+0.00411)/2.68113);
      else if (idx == 78  ) num = 0.90692*TMath::Erf((x+0.57875)/3.35768);
      else if (idx == 79  ) num = 0.86222*TMath::Erf((x+0.36570)/2.68251);
      else if (idx == 80  ) num = 0.89631*TMath::Erf((x-0.20282)/2.45861);
      else if (idx == 81  ) num = 0.89445*TMath::Erf((x-0.68104)/2.16591);
      else if (idx == 82  ) num = 0.91009*TMath::Erf((x+1.65957)/4.13236);
      else if (idx == 83  ) num = 0.89310*TMath::Erf((x+0.63138)/2.93873);
      else if (idx == 84  ) num = 0.90464*TMath::Erf((x+2.03629)/4.12120);
      else if (idx == 85  ) num = 0.90484*TMath::Erf((x+1.94694)/4.34561);
      else if (idx == 86  ) num = 0.91820*TMath::Erf((x+1.99734)/4.55747);
      else if (idx == 87  ) num = 0.89881*TMath::Erf((x+1.13199)/3.60696);
      else if (idx == 88  ) num = 0.89174*TMath::Erf((x+0.10509)/2.66778);
      else if (idx == 89  ) num = 0.90317*TMath::Erf((x+0.75288)/3.46098);
      else if (idx == 90  ) num = 0.90123*TMath::Erf((x+4.28682)/6.39578);
      else if (idx == 91  ) num = 0.88905*TMath::Erf((x+0.27105)/2.65697);
      else if (idx == 92  ) num = 0.92952*TMath::Erf((x+0.04262)/2.75286);
      else if (idx == 93  ) num = 0.92110*TMath::Erf((x+2.64333)/5.14776);
      else if (idx == 94  ) num = 0.91314*TMath::Erf((x+1.93417)/4.45411);
      else if (idx == 95  ) num = 0.91004*TMath::Erf((x+0.02527)/2.80648);
      else if (idx == 96  ) num = 0.90279*TMath::Erf((x+0.25425)/3.03008);
      else if (idx == 97  ) num = 0.91834*TMath::Erf((x+2.26470)/5.01178);
      else if (idx == 98  ) num = 0.88781*TMath::Erf((x+0.64929)/3.11468);
      else if (idx == 99  ) num = 0.89985*TMath::Erf((x+2.55673)/4.90839);
      else if (idx == 100 ) num = 0.90635*TMath::Erf((x+0.29160)/2.98695);
   }
   else
   {
      if (idx==0) num = 0.91174*TMath::Erf((x+0.42843)/2.61737);
      else if (idx == -1   ) num = 0.91165*TMath::Erf((x+0.74551)/2.77943);
      else if (idx == -2   ) num = 0.91169*TMath::Erf((x+0.17925)/2.49352);
      else if (idx == 1   ) num = 0.88556*TMath::Erf((x-0.05093)/2.19732);
      else if (idx == 2   ) num = 0.93512*TMath::Erf((x+1.62238)/3.79510);
      else if (idx == 3   ) num = 0.92535*TMath::Erf((x+0.36939)/2.65491);
      else if (idx == 4   ) num = 0.92326*TMath::Erf((x+1.45818)/3.71173);
      else if (idx == 5   ) num = 0.88710*TMath::Erf((x-0.08378)/1.92964);
      else if (idx == 6   ) num = 0.90841*TMath::Erf((x+1.14399)/3.10913);
      else if (idx == 7   ) num = 0.92312*TMath::Erf((x+1.51513)/3.62567);
      else if (idx == 8   ) num = 0.89696*TMath::Erf((x+0.28327)/2.33805);
      else if (idx == 9   ) num = 0.91713*TMath::Erf((x+2.61254)/4.38020);
      else if (idx == 10  ) num = 0.87039*TMath::Erf((x+0.27459)/2.17674);
      else if (idx == 11  ) num = 0.94197*TMath::Erf((x+0.41717)/3.08282);
      else if (idx == 12  ) num = 0.91011*TMath::Erf((x+1.26963)/3.21006);
      else if (idx == 13  ) num = 0.89205*TMath::Erf((x+0.32470)/2.42502);
      else if (idx == 14  ) num = 0.88254*TMath::Erf((x-0.16029)/1.99310);
      else if (idx == 15  ) num = 0.91733*TMath::Erf((x+0.56530)/2.66756);
      else if (idx == 16  ) num = 0.92879*TMath::Erf((x+0.56715)/3.02109);
      else if (idx == 17  ) num = 0.90091*TMath::Erf((x+0.32390)/2.44721);
      else if (idx == 18  ) num = 0.90047*TMath::Erf((x-0.24963)/1.96296);
      else if (idx == 19  ) num = 0.95174*TMath::Erf((x+0.32860)/2.67137);
      else if (idx == 20  ) num = 0.92468*TMath::Erf((x-0.07924)/2.29450);
      else if (idx == 21  ) num = 0.89604*TMath::Erf((x-0.05031)/2.02791);
      else if (idx == 22  ) num = 0.90072*TMath::Erf((x-0.13398)/2.05239);
      else if (idx == 23  ) num = 0.90001*TMath::Erf((x-0.37983)/1.58726);
      else if (idx == 24  ) num = 0.94335*TMath::Erf((x+0.48368)/3.01309);
      else if (idx == 25  ) num = 0.87845*TMath::Erf((x-1.15032)/0.86968);
      else if (idx == 26  ) num = 0.87663*TMath::Erf((x-0.20549)/1.89327);
      else if (idx == 27  ) num = 0.89593*TMath::Erf((x+0.07299)/2.21400);
      else if (idx == 28  ) num = 0.89823*TMath::Erf((x+0.75857)/2.80539);
      else if (idx == 29  ) num = 0.90028*TMath::Erf((x+0.03872)/1.94030);
      else if (idx == 30  ) num = 0.94501*TMath::Erf((x+0.32269)/2.77848);
      else if (idx == 31  ) num = 0.88987*TMath::Erf((x+0.15127)/2.15727);
      else if (idx == 32  ) num = 0.89597*TMath::Erf((x+0.65894)/2.77349);
      else if (idx == 33  ) num = 0.88357*TMath::Erf((x+0.32272)/2.31358);
      else if (idx == 34  ) num = 0.91055*TMath::Erf((x+0.53697)/2.51001);
      else if (idx == 35  ) num = 0.89333*TMath::Erf((x-0.67775)/1.46018);
      else if (idx == 36  ) num = 0.90734*TMath::Erf((x-0.22058)/1.98696);
      else if (idx == 37  ) num = 0.91007*TMath::Erf((x+0.10334)/2.44059);
      else if (idx == 38  ) num = 0.89061*TMath::Erf((x-0.09604)/2.15249);
      else if (idx == 39  ) num = 0.90725*TMath::Erf((x+0.35874)/2.79728);
      else if (idx == 40  ) num = 0.87054*TMath::Erf((x-1.71684)/0.25814);
      else if (idx == 41  ) num = 0.91293*TMath::Erf((x+0.13197)/2.36298);
      else if (idx == 42  ) num = 0.87263*TMath::Erf((x-0.38698)/1.77750);
      else if (idx == 43  ) num = 0.91071*TMath::Erf((x+1.67319)/3.63544);
      else if (idx == 44  ) num = 0.89188*TMath::Erf((x-0.56284)/1.59353);
      else if (idx == 45  ) num = 0.91615*TMath::Erf((x+0.82864)/3.20319);
      else if (idx == 46  ) num = 0.91038*TMath::Erf((x-0.45720)/1.82855);
      else if (idx == 47  ) num = 0.92414*TMath::Erf((x-0.22087)/2.21285);
      else if (idx == 48  ) num = 0.88432*TMath::Erf((x+0.57883)/2.49281);
      else if (idx == 49  ) num = 0.90028*TMath::Erf((x-0.04745)/2.08324);
      else if (idx == 50  ) num = 0.87886*TMath::Erf((x+0.61502)/2.46084);
      else if (idx == 51  ) num = 0.87955*TMath::Erf((x+0.22107)/2.23334);
      else if (idx == 52  ) num = 0.89412*TMath::Erf((x+0.15168)/2.22112);
      else if (idx == 53  ) num = 0.91646*TMath::Erf((x+0.29646)/2.71776);
      else if (idx == 54  ) num = 0.88986*TMath::Erf((x+0.65144)/2.60518);
      else if (idx == 55  ) num = 0.88582*TMath::Erf((x+0.80599)/2.59040);
      else if (idx == 56  ) num = 0.89141*TMath::Erf((x+1.27088)/3.05764);
      else if (idx == 57  ) num = 0.86332*TMath::Erf((x+0.96815)/2.67610);
      else if (idx == 58  ) num = 0.91871*TMath::Erf((x+0.62789)/2.78795);
      else if (idx == 59  ) num = 0.92253*TMath::Erf((x+0.90289)/3.19798);
      else if (idx == 60  ) num = 0.93460*TMath::Erf((x+0.64892)/3.02476);
      else if (idx == 61  ) num = 0.90345*TMath::Erf((x+0.48103)/2.34694);
      else if (idx == 62  ) num = 0.94197*TMath::Erf((x+0.85863)/3.44957);
      else if (idx == 63  ) num = 0.90177*TMath::Erf((x-0.45037)/1.82742);
      else if (idx == 64  ) num = 0.91758*TMath::Erf((x+0.30191)/2.48286);
      else if (idx == 65  ) num = 0.91413*TMath::Erf((x-0.39183)/1.87413);
      else if (idx == 66  ) num = 0.91855*TMath::Erf((x-0.08918)/2.29942);
      else if (idx == 67  ) num = 0.91094*TMath::Erf((x+0.08127)/2.41802);
      else if (idx == 68  ) num = 0.90990*TMath::Erf((x+0.31698)/2.51846);
      else if (idx == 69  ) num = 0.87164*TMath::Erf((x+0.21257)/2.11652);
      else if (idx == 70  ) num = 0.91246*TMath::Erf((x+1.74237)/3.77912);
      else if (idx == 71  ) num = 0.87421*TMath::Erf((x-0.79314)/1.23412);
      else if (idx == 72  ) num = 0.87039*TMath::Erf((x-0.30021)/1.70053);
      else if (idx == 73  ) num = 0.85786*TMath::Erf((x-0.83068)/1.09659);
      else if (idx == 74  ) num = 0.89392*TMath::Erf((x-0.22577)/1.95690);
      else if (idx == 75  ) num = 0.89327*TMath::Erf((x-0.24873)/1.84525);
      else if (idx == 76  ) num = 0.90773*TMath::Erf((x+0.10269)/2.45636);
      else if (idx == 77  ) num = 0.92194*TMath::Erf((x-0.01758)/2.18684);
      else if (idx == 78  ) num = 0.91402*TMath::Erf((x+0.92906)/3.25360);
      else if (idx == 79  ) num = 0.89912*TMath::Erf((x+0.70545)/2.70498);
      else if (idx == 80  ) num = 0.89525*TMath::Erf((x+0.25565)/2.26352);
      else if (idx == 81  ) num = 0.91832*TMath::Erf((x+1.39577)/3.90724);
      else if (idx == 82  ) num = 0.91601*TMath::Erf((x-0.07235)/2.15516);
      else if (idx == 83  ) num = 0.89444*TMath::Erf((x-0.37968)/1.96507);
      else if (idx == 84  ) num = 0.89884*TMath::Erf((x+0.98593)/2.95295);
      else if (idx == 85  ) num = 0.90200*TMath::Erf((x+0.97603)/2.80845);
      else if (idx == 86  ) num = 0.90262*TMath::Erf((x-0.86479)/1.39761);
      else if (idx == 87  ) num = 0.87359*TMath::Erf((x+1.73489)/3.19910);
      else if (idx == 88  ) num = 0.88471*TMath::Erf((x+0.14941)/2.29428);
      else if (idx == 89  ) num = 0.91374*TMath::Erf((x+0.26769)/2.35604);
      else if (idx == 90  ) num = 0.90205*TMath::Erf((x+0.39789)/2.53676);
      else if (idx == 91  ) num = 0.91755*TMath::Erf((x+0.58025)/2.91726);
      else if (idx == 92  ) num = 0.91852*TMath::Erf((x+2.12959)/4.28679);
      else if (idx == 93  ) num = 0.90339*TMath::Erf((x-0.52417)/1.74583);
      else if (idx == 94  ) num = 0.90871*TMath::Erf((x+0.62459)/2.74819);
      else if (idx == 95  ) num = 0.89396*TMath::Erf((x+0.93206)/2.77567);
      else if (idx == 96  ) num = 0.88428*TMath::Erf((x+0.34629)/2.25652);
      else if (idx == 97  ) num = 0.93935*TMath::Erf((x+0.90253)/3.21417);
      else if (idx == 98  ) num = 0.92371*TMath::Erf((x-0.34233)/1.98688);
      else if (idx == 99  ) num = 0.90600*TMath::Erf((x+0.06380)/2.15114);
      else if (idx == 100 ) num = 0.94401*TMath::Erf((x+3.42680)/5.66206);
   }

   // return
   return num/den;
}

///////////////////////////////////////////////////
//               T R G    P P                    //
///////////////////////////////////////////////////
double tnp_weight_trg_pp(double x, double eta, int idx)
{
   // binned
   if (idx == -10) {
      if (fabs(eta) < 1.2) {
         // 0 < |eta| < 1.2
         if (x<4) return 1.05133;
         else if (x<4.5) return 1.01493;
         else if (x<5) return 1.00637;
         else if (x<5.5) return 1.00866;
         else if (x<6) return 1.00403;
         else if (x<7) return 0.999526;
         else if (x<8) return 0.993882;
         else if (x<10.5) return 0.999195;
         else if (x<14) return 0.994448;
         else if (x<18) return 0.997814;
         else return 0.99535;
      } else if (fabs(eta)<1.8) {
         // 1.2 < |eta| < 1.8
         if (x<3) return 1.20399;
         else if (x<3.5) return 1.08496;
         else if (x<4) return 1.0579;
         else if (x<4.5) return 1.02943;
         else if (x<5) return 1.02136;
         else if (x<6) return 1.01855;
         else if (x<7) return 1.01709;
         else if (x<9) return 1.00907;
         else if (x<14) return 1.00748;
         else if (x<18) return 1.02484;
         else return 1.02539;
      } else if (fabs(eta)<2.1) {
         // 1.8 < |eta| < 2.1
         if (x<2.5) return 1.23506;
         else if (x<3) return 1.07046;
         else if (x<3.5) return 1.05211;
         else if (x<4) return 1.04089;
         else if (x<4.5) return 1.04115;
         else if (x<5) return 1.03067;
         else if (x<6) return 1.02442;
         else if (x<7) return 1.025;
         else if (x<9) return 1.02442;
         else if (x<13) return 0.997836;
         else return 0.944194;
      } else {
         // 2.1 < |eta| < 2.4
         if (x<2.5) return 1.21185;
         else if (x<3) return 1.10746;
         else if (x<3.5) return 1.07255;
         else if (x<4) return 1.03562;
         else if (x<4.5) return 1.03939;
         else if (x<5) return 1.02434;
         else if (x<6.5) return 1.02967;
         else if (x<8.5) return 1.02523;
         else if (x<12) return 1.03297;
         else return 0.990749;
      }
   }

   // denominator (from MC)
   double den=1;
   if (fabs(eta)<1.2) den = (34.38245*(TMath::Erf((x-5.78815)/2.97251)*TMath::Exp(-1.37492*x)))+0.97770;
   else if (fabs(eta)<1.8) den = (52.18025*(TMath::Erf((x-6.06559)/6.11135)*TMath::Exp(-1.42980*x)))+0.94384;
   else if (fabs(eta)<2.1) den = (7.30528*(TMath::Erf((x-5.21429)/11.40230)*TMath::Exp(-0.76187*x)))+0.89352;
   else den = (17.36511*(TMath::Erf((x-5.04177)/41.72924)*TMath::Exp(-0.79676*x)))+0.87670;

   // numerator (from data)
   double num=1;
   if (fabs(eta)<1.2)
   {
      if (idx==0) num = (94.95898*(TMath::Erf((x-4.65953)/10.56520)*TMath::Exp(-1.23463*x)))+0.97158;
      else if (idx == -1   ) num = (94.99980*(TMath::Erf((x-4.65807)/10.55174)*TMath::Exp(-1.23425*x)))+0.97187;
      else if (idx == -2   ) num = (94.81058*(TMath::Erf((x-4.65940)/10.58672)*TMath::Exp(-1.23529*x)))+0.97128;
      else if (idx == 1   ) num = (79.62461*(TMath::Erf((x-4.82543)/11.23210)*TMath::Exp(-1.23869*x)))+0.97457;
      else if (idx == 2   ) num = (94.99542*(TMath::Erf((x-4.44709)/9.44793)*TMath::Exp(-1.19983*x)))+0.96680;
      else if (idx == 3   ) num = (94.98887*(TMath::Erf((x-4.68303)/10.46381)*TMath::Exp(-1.23223*x)))+0.97086;
      else if (idx == 4   ) num = (83.60833*(TMath::Erf((x-4.65639)/3.68324)*TMath::Exp(-1.47476*x)))+0.97234;
      else if (idx == 5   ) num = (94.99396*(TMath::Erf((x-4.59152)/10.27326)*TMath::Exp(-1.23227*x)))+0.96901;
      else if (idx == 6   ) num = (94.97777*(TMath::Erf((x-4.68077)/10.48047)*TMath::Exp(-1.23276*x)))+0.97109;
      else if (idx == 7   ) num = (94.99981*(TMath::Erf((x-4.55298)/10.02616)*TMath::Exp(-1.22110*x)))+0.96809;
      else if (idx == 8   ) num = (94.98539*(TMath::Erf((x-4.64730)/10.43905)*TMath::Exp(-1.23107*x)))+0.97270;
      else if (idx == 9   ) num = (94.84365*(TMath::Erf((x-4.71948)/17.27127)*TMath::Exp(-1.10875*x)))+0.97224;
      else if (idx == 10  ) num = (94.97880*(TMath::Erf((x-4.69593)/8.33277)*TMath::Exp(-1.31128*x)))+0.97041;
      else if (idx == 11  ) num = (83.41183*(TMath::Erf((x-4.85284)/4.07608)*TMath::Exp(-1.49380*x)))+0.97468;
      else if (idx == 12  ) num = (91.78785*(TMath::Erf((x-4.65702)/10.63130)*TMath::Exp(-1.22846*x)))+0.97263;
      else if (idx == 13  ) num = (94.93209*(TMath::Erf((x-4.73885)/7.89230)*TMath::Exp(-1.33259*x)))+0.97334;
      else if (idx == 14  ) num = (93.60680*(TMath::Erf((x-4.66341)/10.58746)*TMath::Exp(-1.23526*x)))+0.97139;
      else if (idx == 15  ) num = (94.70109*(TMath::Erf((x-4.61046)/10.17859)*TMath::Exp(-1.23150*x)))+0.97115;
      else if (idx == 16  ) num = (94.91765*(TMath::Erf((x-4.45659)/9.48272)*TMath::Exp(-1.20495*x)))+0.96682;
      else if (idx == 17  ) num = (94.01915*(TMath::Erf((x-4.67156)/6.68081)*TMath::Exp(-1.35698*x)))+0.97170;
      else if (idx == 18  ) num = (72.28045*(TMath::Erf((x-4.71042)/3.39003)*TMath::Exp(-1.44913*x)))+0.97357;
      else if (idx == 19  ) num = (91.14635*(TMath::Erf((x-4.65763)/10.55453)*TMath::Exp(-1.23443*x)))+0.97177;
      else if (idx == 20  ) num = (76.57997*(TMath::Erf((x-4.64648)/17.58464)*TMath::Exp(-1.05187*x)))+0.97037;
      else if (idx == 21  ) num = (94.99686*(TMath::Erf((x-4.66455)/10.42308)*TMath::Exp(-1.22947*x)))+0.97291;
      else if (idx == 22  ) num = (94.65006*(TMath::Erf((x-4.52603)/13.78582)*TMath::Exp(-1.14028*x)))+0.96658;
      else if (idx == 23  ) num = (94.98251*(TMath::Erf((x-4.65507)/10.51786)*TMath::Exp(-1.23334*x)))+0.97204;
      else if (idx == 24  ) num = (94.91316*(TMath::Erf((x-4.87135)/9.85275)*TMath::Exp(-1.29515*x)))+0.97444;
      else if (idx == 25  ) num = (94.95375*(TMath::Erf((x-4.49593)/9.58096)*TMath::Exp(-1.21389*x)))+0.96826;
      else if (idx == 26  ) num = (94.99997*(TMath::Erf((x-4.60803)/10.00009)*TMath::Exp(-1.22102*x)))+0.97059;
      else if (idx == 27  ) num = (94.98938*(TMath::Erf((x-4.70396)/10.57365)*TMath::Exp(-1.24305*x)))+0.97298;
      else if (idx == 28  ) num = (45.24690*(TMath::Erf((x-4.68607)/26.96508)*TMath::Exp(-0.82826*x)))+0.96784;
      else if (idx == 29  ) num = (94.97071*(TMath::Erf((x-4.60057)/10.47429)*TMath::Exp(-1.22429*x)))+0.96918;
      else if (idx == 30  ) num = (89.49531*(TMath::Erf((x-4.80483)/11.10528)*TMath::Exp(-1.24170*x)))+0.97398;
      else if (idx == 31  ) num = (85.77267*(TMath::Erf((x-4.94907)/11.44498)*TMath::Exp(-1.26081*x)))+0.97431;
      else if (idx == 32  ) num = (94.94059*(TMath::Erf((x-4.84603)/8.47552)*TMath::Exp(-1.32931*x)))+0.97422;
      else if (idx == 33  ) num = (92.12659*(TMath::Erf((x-4.57787)/6.48871)*TMath::Exp(-1.33308*x)))+0.97153;
      else if (idx == 34  ) num = (94.55590*(TMath::Erf((x-4.65596)/10.51236)*TMath::Exp(-1.23187*x)))+0.97312;
      else if (idx == 35  ) num = (94.60278*(TMath::Erf((x-4.60033)/7.16401)*TMath::Exp(-1.32244*x)))+0.97110;
      else if (idx == 36  ) num = (91.46832*(TMath::Erf((x-4.65424)/10.52190)*TMath::Exp(-1.23287*x)))+0.97256;
      else if (idx == 37  ) num = (75.61280*(TMath::Erf((x-4.66246)/3.44527)*TMath::Exp(-1.45972*x)))+0.97354;
      else if (idx == 38  ) num = (94.98658*(TMath::Erf((x-4.65153)/10.51864)*TMath::Exp(-1.23256*x)))+0.97209;
      else if (idx == 39  ) num = (86.25862*(TMath::Erf((x-4.93750)/3.39579)*TMath::Exp(-1.57226*x)))+0.97517;
      else if (idx == 40  ) num = (94.99998*(TMath::Erf((x-4.53230)/10.09710)*TMath::Exp(-1.21042*x)))+0.96831;
      else if (idx == 41  ) num = (94.98050*(TMath::Erf((x-4.53565)/9.94806)*TMath::Exp(-1.22442*x)))+0.96944;
      else if (idx == 42  ) num = (94.99231*(TMath::Erf((x-4.73434)/10.72249)*TMath::Exp(-1.23909*x)))+0.97352;
      else if (idx == 43  ) num = (94.99403*(TMath::Erf((x-4.51061)/9.75000)*TMath::Exp(-1.21471*x)))+0.96966;
      else if (idx == 44  ) num = (94.99735*(TMath::Erf((x-4.70648)/12.61464)*TMath::Exp(-1.18920*x)))+0.97144;
      else if (idx == 45  ) num = (94.88331*(TMath::Erf((x-4.61208)/10.37632)*TMath::Exp(-1.22663*x)))+0.97124;
      else if (idx == 46  ) num = (90.70548*(TMath::Erf((x-4.57695)/12.51559)*TMath::Exp(-1.16758*x)))+0.96935;
      else if (idx == 47  ) num = (70.86822*(TMath::Erf((x-4.77464)/3.26427)*TMath::Exp(-1.48358*x)))+0.97503;
      else if (idx == 48  ) num = (80.29902*(TMath::Erf((x-4.82726)/3.83929)*TMath::Exp(-1.47828*x)))+0.97644;
      else if (idx == 49  ) num = (88.08291*(TMath::Erf((x-5.03750)/3.43585)*TMath::Exp(-1.59195*x)))+0.97624;
      else if (idx == 50  ) num = (94.99161*(TMath::Erf((x-4.65905)/10.36907)*TMath::Exp(-1.23038*x)))+0.97166;
      else if (idx == 51  ) num = (81.32188*(TMath::Erf((x-4.64543)/3.35603)*TMath::Exp(-1.48719*x)))+0.97236;
      else if (idx == 52  ) num = (94.96043*(TMath::Erf((x-4.66109)/3.91745)*TMath::Exp(-1.47067*x)))+0.97327;
      else if (idx == 53  ) num = (94.65605*(TMath::Erf((x-4.65468)/10.53864)*TMath::Exp(-1.23422*x)))+0.97192;
      else if (idx == 54  ) num = (94.99197*(TMath::Erf((x-4.65906)/10.51665)*TMath::Exp(-1.23384*x)))+0.97102;
      else if (idx == 55  ) num = (77.24015*(TMath::Erf((x-4.63106)/15.88488)*TMath::Exp(-1.06686*x)))+0.96957;
      else if (idx == 56  ) num = (65.89186*(TMath::Erf((x-4.74288)/17.71565)*TMath::Exp(-1.04042*x)))+0.97150;
      else if (idx == 57  ) num = (90.08158*(TMath::Erf((x-4.73213)/10.86032)*TMath::Exp(-1.24291*x)))+0.97104;
      else if (idx == 58  ) num = (94.62793*(TMath::Erf((x-4.60195)/10.46235)*TMath::Exp(-1.22081*x)))+0.97075;
      else if (idx == 59  ) num = (94.98532*(TMath::Erf((x-4.66784)/10.34598)*TMath::Exp(-1.22932*x)))+0.97199;
      else if (idx == 60  ) num = (93.42292*(TMath::Erf((x-4.71021)/5.83036)*TMath::Exp(-1.40465*x)))+0.97367;
      else if (idx == 61  ) num = (94.97582*(TMath::Erf((x-4.73223)/8.65485)*TMath::Exp(-1.29026*x)))+0.97279;
      else if (idx == 62  ) num = (78.83736*(TMath::Erf((x-4.77246)/4.42878)*TMath::Exp(-1.42042*x)))+0.97472;
      else if (idx == 63  ) num = (88.00814*(TMath::Erf((x-4.87140)/11.39018)*TMath::Exp(-1.24780*x)))+0.97432;
      else if (idx == 64  ) num = (94.99995*(TMath::Erf((x-4.69569)/8.64960)*TMath::Exp(-1.29373*x)))+0.97167;
      else if (idx == 65  ) num = (62.16357*(TMath::Erf((x-4.74551)/19.53328)*TMath::Exp(-0.99868*x)))+0.97086;
      else if (idx == 66  ) num = (67.78201*(TMath::Erf((x-4.70567)/3.11945)*TMath::Exp(-1.47057*x)))+0.97302;
      else if (idx == 67  ) num = (94.96391*(TMath::Erf((x-4.60729)/10.13037)*TMath::Exp(-1.22921*x)))+0.97100;
      else if (idx == 68  ) num = (73.01425*(TMath::Erf((x-4.72950)/3.11440)*TMath::Exp(-1.47550*x)))+0.97395;
      else if (idx == 69  ) num = (94.94816*(TMath::Erf((x-4.66074)/10.56569)*TMath::Exp(-1.23533*x)))+0.97124;
      else if (idx == 70  ) num = (94.98099*(TMath::Erf((x-4.67358)/10.54960)*TMath::Exp(-1.23403*x)))+0.97115;
      else if (idx == 71  ) num = (51.04438*(TMath::Erf((x-4.72847)/25.60315)*TMath::Exp(-0.87251*x)))+0.96861;
      else if (idx == 72  ) num = (88.85719*(TMath::Erf((x-4.62887)/16.70353)*TMath::Exp(-1.09737*x)))+0.96831;
      else if (idx == 73  ) num = (89.52393*(TMath::Erf((x-4.66673)/10.62082)*TMath::Exp(-1.23568*x)))+0.97123;
      else if (idx == 74  ) num = (94.24487*(TMath::Erf((x-4.65569)/6.04911)*TMath::Exp(-1.38455*x)))+0.97175;
      else if (idx == 75  ) num = (93.81451*(TMath::Erf((x-4.66467)/10.60455)*TMath::Exp(-1.23525*x)))+0.97130;
      else if (idx == 76  ) num = (89.20244*(TMath::Erf((x-4.82990)/11.25818)*TMath::Exp(-1.24415*x)))+0.97495;
      else if (idx == 77  ) num = (94.94498*(TMath::Erf((x-4.71088)/2.04616)*TMath::Exp(-1.65933*x)))+0.97429;
      else if (idx == 78  ) num = (88.79046*(TMath::Erf((x-4.85646)/5.63700)*TMath::Exp(-1.42401*x)))+0.97530;
      else if (idx == 79  ) num = (93.75301*(TMath::Erf((x-4.73741)/5.86059)*TMath::Exp(-1.41854*x)))+0.97238;
      else if (idx == 80  ) num = (86.27110*(TMath::Erf((x-4.66847)/16.39790)*TMath::Exp(-1.10181*x)))+0.97067;
      else if (idx == 81  ) num = (91.76393*(TMath::Erf((x-4.65991)/10.56504)*TMath::Exp(-1.23472*x)))+0.97144;
      else if (idx == 82  ) num = (94.99327*(TMath::Erf((x-4.60033)/10.18847)*TMath::Exp(-1.22227*x)))+0.97007;
      else if (idx == 83  ) num = (90.44732*(TMath::Erf((x-4.65290)/16.12208)*TMath::Exp(-1.10933*x)))+0.97080;
      else if (idx == 84  ) num = (94.86477*(TMath::Erf((x-4.72065)/9.02455)*TMath::Exp(-1.28793*x)))+0.97211;
      else if (idx == 85  ) num = (94.92931*(TMath::Erf((x-4.72957)/10.91189)*TMath::Exp(-1.24445*x)))+0.97176;
      else if (idx == 86  ) num = (94.99348*(TMath::Erf((x-4.74048)/10.82351)*TMath::Exp(-1.23925*x)))+0.97396;
      else if (idx == 87  ) num = (80.42100*(TMath::Erf((x-4.70911)/3.52064)*TMath::Exp(-1.48713*x)))+0.97441;
      else if (idx == 88  ) num = (86.31237*(TMath::Erf((x-4.90231)/11.42341)*TMath::Exp(-1.24793*x)))+0.97746;
      else if (idx == 89  ) num = (49.20939*(TMath::Erf((x-4.59000)/32.08714)*TMath::Exp(-0.78492*x)))+0.96362;
      else if (idx == 90  ) num = (80.68575*(TMath::Erf((x-4.62459)/14.88510)*TMath::Exp(-1.10733*x)))+0.97021;
      else if (idx == 91  ) num = (92.77487*(TMath::Erf((x-4.65748)/10.53845)*TMath::Exp(-1.23319*x)))+0.97260;
      else if (idx == 92  ) num = (94.88132*(TMath::Erf((x-4.56300)/9.94787)*TMath::Exp(-1.23004*x)))+0.96815;
      else if (idx == 93  ) num = (66.33027*(TMath::Erf((x-4.61621)/20.94737)*TMath::Exp(-0.97198*x)))+0.96710;
      else if (idx == 94  ) num = (91.22044*(TMath::Erf((x-4.65823)/10.57030)*TMath::Exp(-1.23423*x)))+0.97173;
      else if (idx == 95  ) num = (94.99972*(TMath::Erf((x-4.65232)/10.44270)*TMath::Exp(-1.23101*x)))+0.97298;
      else if (idx == 96  ) num = (69.89613*(TMath::Erf((x-4.62948)/17.52870)*TMath::Exp(-1.03594*x)))+0.96910;
      else if (idx == 97  ) num = (94.87457*(TMath::Erf((x-4.73538)/10.62654)*TMath::Exp(-1.24963*x)))+0.97339;
      else if (idx == 98  ) num = (94.92653*(TMath::Erf((x-4.71389)/10.74769)*TMath::Exp(-1.24068*x)))+0.97360;
      else if (idx == 99  ) num = (53.29070*(TMath::Erf((x-4.52117)/26.07274)*TMath::Exp(-0.84957*x)))+0.96290;
      else if (idx == 100 ) num = (87.72850*(TMath::Erf((x-4.65080)/1.41220)*TMath::Exp(-1.69310*x)))+0.97443;
   }
   else if (fabs(eta)<1.8)
   {
      if (idx==0) num = (95.00000*(TMath::Erf((x-7.75204)/0.00849)*TMath::Exp(-1.90457*x)))+0.96063;
      else if (idx == -1   ) num = (94.95477*(TMath::Erf((x-9.08131)/0.00077)*TMath::Exp(-1.90410*x)))+0.96167;
      else if (idx == -2   ) num = (95.00000*(TMath::Erf((x-9.99133)/0.20167)*TMath::Exp(-1.90507*x)))+0.95962;
      else if (idx == 1   ) num = (94.99998*(TMath::Erf((x-8.79050)/0.00153)*TMath::Exp(-1.90531*x)))+0.95720;
      else if (idx == 2   ) num = (95.00000*(TMath::Erf((x-9.36415)/0.00068)*TMath::Exp(-1.90522*x)))+0.95967;
      else if (idx == 3   ) num = (94.36928*(TMath::Erf((x-8.38390)/0.58414)*TMath::Exp(-1.90449*x)))+0.96084;
      else if (idx == 4   ) num = (95.00000*(TMath::Erf((x-7.66114)/0.00073)*TMath::Exp(-1.89974*x)))+0.96127;
      else if (idx == 5   ) num = (93.34282*(TMath::Erf((x-8.74233)/0.01278)*TMath::Exp(-1.90636*x)))+0.95776;
      else if (idx == 6   ) num = (95.00000*(TMath::Erf((x-9.55069)/0.16830)*TMath::Exp(-1.90001*x)))+0.96144;
      else if (idx == 7   ) num = (95.00000*(TMath::Erf((x-8.86476)/0.12588)*TMath::Exp(-1.90136*x)))+0.96043;
      else if (idx == 8   ) num = (94.97412*(TMath::Erf((x-5.60906)/0.00312)*TMath::Exp(-1.90184*x)))+0.95931;
      else if (idx == 9   ) num = (94.99997*(TMath::Erf((x-9.33723)/0.03285)*TMath::Exp(-1.90132*x)))+0.96230;
      else if (idx == 10  ) num = (92.92375*(TMath::Erf((x-7.80728)/0.00278)*TMath::Exp(-1.90679*x)))+0.95667;
      else if (idx == 11  ) num = (94.99409*(TMath::Erf((x-5.46018)/1.79932)*TMath::Exp(-1.89413*x)))+0.95478;
      else if (idx == 12  ) num = (93.62619*(TMath::Erf((x-9.90830)/0.11309)*TMath::Exp(-1.90251*x)))+0.95965;
      else if (idx == 13  ) num = (94.03035*(TMath::Erf((x-8.49738)/0.14568)*TMath::Exp(-1.90452*x)))+0.96058;
      else if (idx == 14  ) num = (95.00000*(TMath::Erf((x-7.66855)/0.00919)*TMath::Exp(-1.90121*x)))+0.96016;
      else if (idx == 15  ) num = (94.99999*(TMath::Erf((x-7.45748)/2.54010)*TMath::Exp(-1.90024*x)))+0.96048;
      else if (idx == 16  ) num = (94.98042*(TMath::Erf((x-8.89348)/0.00167)*TMath::Exp(-1.91016*x)))+0.95560;
      else if (idx == 17  ) num = (93.81977*(TMath::Erf((x-6.75178)/0.00160)*TMath::Exp(-1.90535*x)))+0.95784;
      else if (idx == 18  ) num = (94.99960*(TMath::Erf((x-9.75067)/0.11047)*TMath::Exp(-1.90430*x)))+0.95905;
      else if (idx == 19  ) num = (93.70859*(TMath::Erf((x-7.57358)/0.00106)*TMath::Exp(-1.90110*x)))+0.96367;
      else if (idx == 20  ) num = (94.99998*(TMath::Erf((x-8.50761)/0.14446)*TMath::Exp(-1.90503*x)))+0.95741;
      else if (idx == 21  ) num = (95.00000*(TMath::Erf((x-9.31854)/0.00000)*TMath::Exp(-1.90203*x)))+0.96072;
      else if (idx == 22  ) num = (93.86751*(TMath::Erf((x-7.72534)/0.00477)*TMath::Exp(-1.90473*x)))+0.96073;
      else if (idx == 23  ) num = (94.99999*(TMath::Erf((x-8.82189)/0.05128)*TMath::Exp(-1.90556*x)))+0.95791;
      else if (idx == 24  ) num = (94.99996*(TMath::Erf((x-9.08699)/0.05972)*TMath::Exp(-1.89526*x)))+0.96414;
      else if (idx == 25  ) num = (94.99987*(TMath::Erf((x-9.45809)/0.56503)*TMath::Exp(-1.90074*x)))+0.96194;
      else if (idx == 26  ) num = (94.99992*(TMath::Erf((x-7.08255)/0.02147)*TMath::Exp(-1.89551*x)))+0.96476;
      else if (idx == 27  ) num = (95.00000*(TMath::Erf((x-7.68444)/0.00009)*TMath::Exp(-1.89360*x)))+0.96006;
      else if (idx == 28  ) num = (95.00000*(TMath::Erf((x-8.99220)/0.17375)*TMath::Exp(-1.90688*x)))+0.95718;
      else if (idx == 29  ) num = (95.00000*(TMath::Erf((x-7.35513)/0.00116)*TMath::Exp(-1.89996*x)))+0.96065;
      else if (idx == 30  ) num = (82.93534*(TMath::Erf((x-7.62710)/1.07430)*TMath::Exp(-1.85878*x)))+0.96638;
      else if (idx == 31  ) num = (94.99999*(TMath::Erf((x-9.96738)/0.67350)*TMath::Exp(-1.90190*x)))+0.96118;
      else if (idx == 32  ) num = (93.87679*(TMath::Erf((x-9.34251)/0.05692)*TMath::Exp(-1.89926*x)))+0.96384;
      else if (idx == 33  ) num = (93.50472*(TMath::Erf((x-7.65043)/0.00020)*TMath::Exp(-1.90571*x)))+0.95927;
      else if (idx == 34  ) num = (95.00000*(TMath::Erf((x-9.25737)/0.00911)*TMath::Exp(-1.89955*x)))+0.96089;
      else if (idx == 35  ) num = (94.99999*(TMath::Erf((x-7.53618)/0.00632)*TMath::Exp(-1.89774*x)))+0.96280;
      else if (idx == 36  ) num = (94.99999*(TMath::Erf((x-8.87891)/0.25210)*TMath::Exp(-1.90433*x)))+0.95971;
      else if (idx == 37  ) num = (94.99998*(TMath::Erf((x-7.69850)/0.00117)*TMath::Exp(-1.90480*x)))+0.96065;
      else if (idx == 38  ) num = (94.77178*(TMath::Erf((x-8.92819)/0.00188)*TMath::Exp(-1.90415*x)))+0.96205;
      else if (idx == 39  ) num = (94.99998*(TMath::Erf((x-7.65028)/0.00180)*TMath::Exp(-1.90082*x)))+0.96165;
      else if (idx == 40  ) num = (94.99999*(TMath::Erf((x-7.64214)/0.01441)*TMath::Exp(-1.90157*x)))+0.96243;
      else if (idx == 41  ) num = (94.99999*(TMath::Erf((x-8.76248)/0.01246)*TMath::Exp(-1.89317*x)))+0.95906;
      else if (idx == 42  ) num = (94.99981*(TMath::Erf((x-9.30464)/0.04120)*TMath::Exp(-1.89993*x)))+0.96277;
      else if (idx == 43  ) num = (94.99946*(TMath::Erf((x-5.45001)/0.00594)*TMath::Exp(-1.90576*x)))+0.95973;
      else if (idx == 44  ) num = (95.00000*(TMath::Erf((x-8.83583)/0.00816)*TMath::Exp(-1.90049*x)))+0.96176;
      else if (idx == 45  ) num = (93.26748*(TMath::Erf((x-9.57930)/0.23960)*TMath::Exp(-1.90438*x)))+0.95962;
      else if (idx == 46  ) num = (94.99997*(TMath::Erf((x-9.56345)/0.01035)*TMath::Exp(-1.90277*x)))+0.96127;
      else if (idx == 47  ) num = (93.64337*(TMath::Erf((x-7.41312)/0.00431)*TMath::Exp(-1.90159*x)))+0.96107;
      else if (idx == 48  ) num = (93.24400*(TMath::Erf((x-7.08976)/0.00000)*TMath::Exp(-1.90509*x)))+0.95912;
      else if (idx == 49  ) num = (94.82898*(TMath::Erf((x-8.34193)/0.02469)*TMath::Exp(-1.90458*x)))+0.96089;
      else if (idx == 50  ) num = (94.99991*(TMath::Erf((x-8.57149)/0.01815)*TMath::Exp(-1.90180*x)))+0.96189;
      else if (idx == 51  ) num = (94.99999*(TMath::Erf((x-9.86931)/1.32990)*TMath::Exp(-1.89665*x)))+0.96301;
      else if (idx == 52  ) num = (94.99973*(TMath::Erf((x-7.22261)/0.08634)*TMath::Exp(-1.90784*x)))+0.95926;
      else if (idx == 53  ) num = (94.76104*(TMath::Erf((x-7.38602)/0.01050)*TMath::Exp(-1.90022*x)))+0.96195;
      else if (idx == 54  ) num = (93.13367*(TMath::Erf((x-9.87979)/0.03035)*TMath::Exp(-1.90179*x)))+0.96038;
      else if (idx == 55  ) num = (92.82257*(TMath::Erf((x-7.67138)/0.00115)*TMath::Exp(-1.90372*x)))+0.96227;
      else if (idx == 56  ) num = (94.99992*(TMath::Erf((x-9.68979)/1.12186)*TMath::Exp(-1.89564*x)))+0.96326;
      else if (idx == 57  ) num = (94.99995*(TMath::Erf((x-7.47044)/0.00257)*TMath::Exp(-1.90105*x)))+0.96181;
      else if (idx == 58  ) num = (95.00000*(TMath::Erf((x-9.22712)/0.00849)*TMath::Exp(-1.89955*x)))+0.96075;
      else if (idx == 59  ) num = (94.99999*(TMath::Erf((x-8.99476)/0.00031)*TMath::Exp(-1.89831*x)))+0.95905;
      else if (idx == 60  ) num = (94.47261*(TMath::Erf((x-8.96667)/0.00015)*TMath::Exp(-1.90447*x)))+0.96091;
      else if (idx == 61  ) num = (94.17738*(TMath::Erf((x-9.41445)/0.06380)*TMath::Exp(-1.91394*x)))+0.95798;
      else if (idx == 62  ) num = (94.98722*(TMath::Erf((x-7.66283)/0.00033)*TMath::Exp(-1.90137*x)))+0.96393;
      else if (idx == 63  ) num = (93.58858*(TMath::Erf((x-8.77809)/0.00303)*TMath::Exp(-1.90420*x)))+0.95874;
      else if (idx == 64  ) num = (94.99519*(TMath::Erf((x-7.61408)/0.00002)*TMath::Exp(-1.90470*x)))+0.96177;
      else if (idx == 65  ) num = (94.99998*(TMath::Erf((x-8.92870)/0.00579)*TMath::Exp(-1.90784*x)))+0.96224;
      else if (idx == 66  ) num = (94.97725*(TMath::Erf((x-7.67990)/0.00281)*TMath::Exp(-1.90083*x)))+0.96463;
      else if (idx == 67  ) num = (94.67120*(TMath::Erf((x-7.64883)/0.00008)*TMath::Exp(-1.90516*x)))+0.95977;
      else if (idx == 68  ) num = (94.99998*(TMath::Erf((x-9.00608)/0.69927)*TMath::Exp(-1.89469*x)))+0.96358;
      else if (idx == 69  ) num = (76.11993*(TMath::Erf((x-8.78992)/0.14786)*TMath::Exp(-1.83350*x)))+0.96128;
      else if (idx == 70  ) num = (95.00000*(TMath::Erf((x-7.68844)/0.00181)*TMath::Exp(-1.89707*x)))+0.96251;
      else if (idx == 71  ) num = (95.00000*(TMath::Erf((x-9.15130)/0.00849)*TMath::Exp(-1.90183*x)))+0.96008;
      else if (idx == 72  ) num = (94.99998*(TMath::Erf((x-7.70671)/0.01511)*TMath::Exp(-1.89788*x)))+0.96432;
      else if (idx == 73  ) num = (93.83262*(TMath::Erf((x-9.35998)/0.05145)*TMath::Exp(-1.90795*x)))+0.96018;
      else if (idx == 74  ) num = (95.00000*(TMath::Erf((x-9.91893)/0.23006)*TMath::Exp(-1.90129*x)))+0.96064;
      else if (idx == 75  ) num = (94.21050*(TMath::Erf((x-5.04317)/1.04725)*TMath::Exp(-1.90041*x)))+0.95826;
      else if (idx == 76  ) num = (94.99999*(TMath::Erf((x-7.71180)/0.00536)*TMath::Exp(-1.90390*x)))+0.96023;
      else if (idx == 77  ) num = (80.86336*(TMath::Erf((x-9.75713)/0.07351)*TMath::Exp(-1.84789*x)))+0.96284;
      else if (idx == 78  ) num = (95.00000*(TMath::Erf((x-7.67632)/0.00002)*TMath::Exp(-1.90136*x)))+0.95989;
      else if (idx == 79  ) num = (95.00000*(TMath::Erf((x-9.81628)/0.05218)*TMath::Exp(-1.91033*x)))+0.96002;
      else if (idx == 80  ) num = (95.00000*(TMath::Erf((x-8.01391)/0.00282)*TMath::Exp(-1.89604*x)))+0.96674;
      else if (idx == 81  ) num = (95.00000*(TMath::Erf((x-7.58161)/0.08980)*TMath::Exp(-1.90197*x)))+0.96068;
      else if (idx == 82  ) num = (94.99900*(TMath::Erf((x-8.68379)/0.09617)*TMath::Exp(-1.90664*x)))+0.95854;
      else if (idx == 83  ) num = (94.99999*(TMath::Erf((x-8.90304)/0.59956)*TMath::Exp(-1.89479*x)))+0.96342;
      else if (idx == 84  ) num = (94.99995*(TMath::Erf((x-7.75710)/0.12196)*TMath::Exp(-1.90019*x)))+0.96211;
      else if (idx == 85  ) num = (95.00000*(TMath::Erf((x-9.34486)/0.00088)*TMath::Exp(-1.90417*x)))+0.96027;
      else if (idx == 86  ) num = (93.44965*(TMath::Erf((x-9.77606)/0.00657)*TMath::Exp(-1.90227*x)))+0.95948;
      else if (idx == 87  ) num = (94.64954*(TMath::Erf((x-9.80298)/1.03673)*TMath::Exp(-1.91147*x)))+0.95481;
      else if (idx == 88  ) num = (94.67289*(TMath::Erf((x-9.90787)/0.93736)*TMath::Exp(-1.90589*x)))+0.96069;
      else if (idx == 89  ) num = (94.99999*(TMath::Erf((x-9.55849)/0.01591)*TMath::Exp(-1.90573*x)))+0.95765;
      else if (idx == 90  ) num = (94.65096*(TMath::Erf((x-5.72649)/0.00153)*TMath::Exp(-1.90239*x)))+0.96374;
      else if (idx == 91  ) num = (94.99998*(TMath::Erf((x-9.48834)/0.00849)*TMath::Exp(-1.90787*x)))+0.95613;
      else if (idx == 92  ) num = (94.99709*(TMath::Erf((x-7.85620)/0.00213)*TMath::Exp(-1.90371*x)))+0.96162;
      else if (idx == 93  ) num = (94.99492*(TMath::Erf((x-8.63369)/0.32777)*TMath::Exp(-1.90069*x)))+0.96153;
      else if (idx == 94  ) num = (94.36333*(TMath::Erf((x-8.88130)/0.05284)*TMath::Exp(-1.90441*x)))+0.96051;
      else if (idx == 95  ) num = (94.84731*(TMath::Erf((x-9.58908)/0.63140)*TMath::Exp(-1.90496*x)))+0.96159;
      else if (idx == 96  ) num = (95.00000*(TMath::Erf((x-9.58648)/0.27599)*TMath::Exp(-1.89687*x)))+0.96146;
      else if (idx == 97  ) num = (94.99990*(TMath::Erf((x-7.66741)/0.01690)*TMath::Exp(-1.89192*x)))+0.96617;
      else if (idx == 98  ) num = (94.13138*(TMath::Erf((x-7.45015)/0.48960)*TMath::Exp(-1.90964*x)))+0.95434;
      else if (idx == 99  ) num = (94.99997*(TMath::Erf((x-9.02589)/1.60204)*TMath::Exp(-1.89855*x)))+0.96385;
      else if (idx == 100 ) num = (94.99172*(TMath::Erf((x-7.40234)/0.00279)*TMath::Exp(-1.89942*x)))+0.96196;
   }
   else if (fabs(eta)<2.1)
   {
      if (idx==0) num = (17.22108*(TMath::Erf((x-3.27215)/49.85358)*TMath::Exp(-0.35627*x)))+0.81185;
      else if (idx == -1   ) num = (16.86934*(TMath::Erf((x-3.23651)/49.99956)*TMath::Exp(-0.34728*x)))+0.80855;
      else if (idx == -2   ) num = (17.71511*(TMath::Erf((x-3.30572)/49.87524)*TMath::Exp(-0.36592*x)))+0.81509;
      else if (idx == 1   ) num = (15.52452*(TMath::Erf((x-2.43357)/49.99629)*TMath::Exp(-0.25829*x)))+0.67726;
      else if (idx == 2   ) num = (15.45609*(TMath::Erf((x-2.75929)/49.40093)*TMath::Exp(-0.29191*x)))+0.74161;
      else if (idx == 3   ) num = (17.39708*(TMath::Erf((x-3.15422)/49.92998)*TMath::Exp(-0.34467*x)))+0.79645;
      else if (idx == 4   ) num = (16.40310*(TMath::Erf((x-3.21802)/49.71067)*TMath::Exp(-0.33525*x)))+0.80677;
      else if (idx == 5   ) num = (16.81416*(TMath::Erf((x-3.53859)/46.35569)*TMath::Exp(-0.39846*x)))+0.84170;
      else if (idx == 6   ) num = (15.52573*(TMath::Erf((x-3.87431)/40.38159)*TMath::Exp(-0.46859*x)))+0.87409;
      else if (idx == 7   ) num = (16.52829*(TMath::Erf((x-3.23880)/49.89723)*TMath::Exp(-0.34266*x)))+0.80927;
      else if (idx == 8   ) num = (17.76198*(TMath::Erf((x-3.90151)/44.12679)*TMath::Exp(-0.47837*x)))+0.87452;
      else if (idx == 9   ) num = (15.59948*(TMath::Erf((x-3.17600)/49.87208)*TMath::Exp(-0.33184*x)))+0.79970;
      else if (idx == 10  ) num = (17.01067*(TMath::Erf((x-3.48745)/47.73339)*TMath::Exp(-0.38912*x)))+0.83766;
      else if (idx == 11  ) num = (16.00768*(TMath::Erf((x-3.49510)/48.23877)*TMath::Exp(-0.38112*x)))+0.83673;
      else if (idx == 12  ) num = (14.25179*(TMath::Erf((x-3.76042)/41.03610)*TMath::Exp(-0.43237*x)))+0.86360;
      else if (idx == 13  ) num = (17.21974*(TMath::Erf((x-3.19347)/49.77770)*TMath::Exp(-0.34538*x)))+0.80216;
      else if (idx == 14  ) num = (17.65287*(TMath::Erf((x-3.45848)/48.04839)*TMath::Exp(-0.38439*x)))+0.83798;
      else if (idx == 15  ) num = (15.97167*(TMath::Erf((x-3.30694)/49.89753)*TMath::Exp(-0.34316*x)))+0.81430;
      else if (idx == 16  ) num = (18.69353*(TMath::Erf((x-2.87783)/49.96150)*TMath::Exp(-0.32662*x)))+0.75261;
      else if (idx == 17  ) num = (18.74491*(TMath::Erf((x-3.30601)/47.72906)*TMath::Exp(-0.39279*x)))+0.82079;
      else if (idx == 18  ) num = (16.60969*(TMath::Erf((x-2.86617)/48.50824)*TMath::Exp(-0.31361*x)))+0.75325;
      else if (idx == 19  ) num = (16.61998*(TMath::Erf((x-2.71094)/49.91101)*TMath::Exp(-0.28896*x)))+0.72422;
      else if (idx == 20  ) num = (17.89872*(TMath::Erf((x-3.35559)/47.82835)*TMath::Exp(-0.38218*x)))+0.82284;
      else if (idx == 21  ) num = (17.23737*(TMath::Erf((x-3.11304)/49.51846)*TMath::Exp(-0.33530*x)))+0.79226;
      else if (idx == 22  ) num = (17.95978*(TMath::Erf((x-3.14510)/49.03258)*TMath::Exp(-0.35291*x)))+0.79663;
      else if (idx == 23  ) num = (17.06800*(TMath::Erf((x-3.26949)/49.94451)*TMath::Exp(-0.35756*x)))+0.81185;
      else if (idx == 24  ) num = (16.11474*(TMath::Erf((x-3.35463)/49.98296)*TMath::Exp(-0.35264*x)))+0.81720;
      else if (idx == 25  ) num = (18.06812*(TMath::Erf((x-3.51061)/49.37552)*TMath::Exp(-0.39096*x)))+0.84078;
      else if (idx == 26  ) num = (16.94617*(TMath::Erf((x-3.21549)/49.63839)*TMath::Exp(-0.34315*x)))+0.80575;
      else if (idx == 27  ) num = (15.76087*(TMath::Erf((x-2.42192)/49.97995)*TMath::Exp(-0.25460*x)))+0.67148;
      else if (idx == 28  ) num = (17.00838*(TMath::Erf((x-3.10462)/49.96157)*TMath::Exp(-0.32892*x)))+0.78661;
      else if (idx == 29  ) num = (17.75847*(TMath::Erf((x-3.22304)/48.79136)*TMath::Exp(-0.36412*x)))+0.80881;
      else if (idx == 30  ) num = (15.83241*(TMath::Erf((x-2.54285)/49.88780)*TMath::Exp(-0.26502*x)))+0.69455;
      else if (idx == 31  ) num = (17.38538*(TMath::Erf((x-3.75302)/47.04318)*TMath::Exp(-0.43000*x)))+0.86402;
      else if (idx == 32  ) num = (17.33584*(TMath::Erf((x-3.09886)/49.99881)*TMath::Exp(-0.33400*x)))+0.78456;
      else if (idx == 33  ) num = (17.41951*(TMath::Erf((x-3.27974)/49.41075)*TMath::Exp(-0.35859*x)))+0.80886;
      else if (idx == 34  ) num = (11.52598*(TMath::Erf((x-3.75099)/34.60261)*TMath::Exp(-0.41140*x)))+0.85848;
      else if (idx == 35  ) num = (17.44241*(TMath::Erf((x-3.60168)/49.23922)*TMath::Exp(-0.40385*x)))+0.84742;
      else if (idx == 36  ) num = (17.80523*(TMath::Erf((x-3.31074)/48.64129)*TMath::Exp(-0.37561*x)))+0.82199;
      else if (idx == 37  ) num = (17.22495*(TMath::Erf((x-3.34681)/49.80529)*TMath::Exp(-0.36074*x)))+0.82106;
      else if (idx == 38  ) num = (16.83667*(TMath::Erf((x-2.72134)/49.82892)*TMath::Exp(-0.29270*x)))+0.73019;
      else if (idx == 39  ) num = (16.26533*(TMath::Erf((x-3.11130)/49.71694)*TMath::Exp(-0.32484*x)))+0.78737;
      else if (idx == 40  ) num = (16.49177*(TMath::Erf((x-3.66916)/46.76356)*TMath::Exp(-0.40944*x)))+0.85458;
      else if (idx == 41  ) num = (17.74282*(TMath::Erf((x-3.45602)/46.47439)*TMath::Exp(-0.40968*x)))+0.83837;
      else if (idx == 42  ) num = (16.33894*(TMath::Erf((x-3.45102)/49.77804)*TMath::Exp(-0.36368*x)))+0.83463;
      else if (idx == 43  ) num = (15.95443*(TMath::Erf((x-3.84792)/48.38855)*TMath::Exp(-0.41080*x)))+0.86581;
      else if (idx == 44  ) num = (15.71101*(TMath::Erf((x-3.33768)/49.87128)*TMath::Exp(-0.33514*x)))+0.82018;
      else if (idx == 45  ) num = (17.04527*(TMath::Erf((x-3.33236)/49.66250)*TMath::Exp(-0.36742*x)))+0.82351;
      else if (idx == 46  ) num = (18.09480*(TMath::Erf((x-3.07670)/48.66071)*TMath::Exp(-0.34681*x)))+0.78749;
      else if (idx == 47  ) num = (14.93832*(TMath::Erf((x-3.43672)/43.43718)*TMath::Exp(-0.37665*x)))+0.83167;
      else if (idx == 48  ) num = (16.43991*(TMath::Erf((x-2.97562)/49.99983)*TMath::Exp(-0.31028*x)))+0.76986;
      else if (idx == 49  ) num = (19.57468*(TMath::Erf((x-3.62668)/49.72489)*TMath::Exp(-0.43636*x)))+0.85842;
      else if (idx == 50  ) num = (17.59196*(TMath::Erf((x-3.44487)/48.41215)*TMath::Exp(-0.38878*x)))+0.83389;
      else if (idx == 51  ) num = (17.51869*(TMath::Erf((x-3.16632)/49.60642)*TMath::Exp(-0.35420*x)))+0.80167;
      else if (idx == 52  ) num = (17.55727*(TMath::Erf((x-2.96283)/49.68127)*TMath::Exp(-0.32864*x)))+0.76946;
      else if (idx == 53  ) num = (17.53462*(TMath::Erf((x-3.32186)/46.92412)*TMath::Exp(-0.37084*x)))+0.81984;
      else if (idx == 54  ) num = (16.10354*(TMath::Erf((x-3.66382)/41.15754)*TMath::Exp(-0.44581*x)))+0.85690;
      else if (idx == 55  ) num = (18.57597*(TMath::Erf((x-3.29585)/49.70225)*TMath::Exp(-0.38348*x)))+0.81952;
      else if (idx == 56  ) num = (12.43161*(TMath::Erf((x-3.51061)/39.03907)*TMath::Exp(-0.36868*x)))+0.83680;
      else if (idx == 57  ) num = (15.36317*(TMath::Erf((x-2.94536)/49.98743)*TMath::Exp(-0.29777*x)))+0.76297;
      else if (idx == 58  ) num = (15.56696*(TMath::Erf((x-2.59156)/49.94925)*TMath::Exp(-0.26647*x)))+0.70669;
      else if (idx == 59  ) num = (17.23313*(TMath::Erf((x-3.27671)/49.33605)*TMath::Exp(-0.35681*x)))+0.81123;
      else if (idx == 60  ) num = (16.78174*(TMath::Erf((x-3.22439)/48.89121)*TMath::Exp(-0.34593*x)))+0.80628;
      else if (idx == 61  ) num = (17.25958*(TMath::Erf((x-3.20458)/49.99984)*TMath::Exp(-0.34697*x)))+0.80076;
      else if (idx == 62  ) num = (15.02159*(TMath::Erf((x-3.59796)/44.98014)*TMath::Exp(-0.38763*x)))+0.84819;
      else if (idx == 63  ) num = (17.94298*(TMath::Erf((x-3.39943)/49.75377)*TMath::Exp(-0.37735*x)))+0.82577;
      else if (idx == 64  ) num = (15.96968*(TMath::Erf((x-3.19874)/49.99935)*TMath::Exp(-0.32893*x)))+0.79997;
      else if (idx == 65  ) num = (16.20438*(TMath::Erf((x-3.69797)/45.35717)*TMath::Exp(-0.42073*x)))+0.85878;
      else if (idx == 66  ) num = (15.34336*(TMath::Erf((x-3.38779)/49.67900)*TMath::Exp(-0.34238*x)))+0.81852;
      else if (idx == 67  ) num = (14.94644*(TMath::Erf((x-2.79297)/49.93378)*TMath::Exp(-0.27943*x)))+0.74092;
      else if (idx == 68  ) num = (18.62756*(TMath::Erf((x-3.03623)/49.97731)*TMath::Exp(-0.35225*x)))+0.77988;
      else if (idx == 69  ) num = (16.98692*(TMath::Erf((x-3.09344)/49.76581)*TMath::Exp(-0.32730*x)))+0.78592;
      else if (idx == 70  ) num = (14.82006*(TMath::Erf((x-3.00078)/49.43806)*TMath::Exp(-0.29934*x)))+0.76894;
      else if (idx == 71  ) num = (17.58607*(TMath::Erf((x-3.08844)/49.48315)*TMath::Exp(-0.33639*x)))+0.78570;
      else if (idx == 72  ) num = (18.12051*(TMath::Erf((x-3.57709)/49.87331)*TMath::Exp(-0.40178*x)))+0.84970;
      else if (idx == 73  ) num = (14.77983*(TMath::Erf((x-3.59669)/45.85244)*TMath::Exp(-0.37899*x)))+0.84477;
      else if (idx == 74  ) num = (17.21112*(TMath::Erf((x-3.53134)/47.91090)*TMath::Exp(-0.39614*x)))+0.84214;
      else if (idx == 75  ) num = (15.08533*(TMath::Erf((x-3.11458)/48.66053)*TMath::Exp(-0.31254*x)))+0.78971;
      else if (idx == 76  ) num = (11.20060*(TMath::Erf((x-3.82721)/29.74826)*TMath::Exp(-0.45851*x)))+0.86867;
      else if (idx == 77  ) num = (17.63639*(TMath::Erf((x-3.13806)/49.94959)*TMath::Exp(-0.34404*x)))+0.79495;
      else if (idx == 78  ) num = (13.70005*(TMath::Erf((x-3.07760)/49.78991)*TMath::Exp(-0.29240*x)))+0.78284;
      else if (idx == 79  ) num = (17.17471*(TMath::Erf((x-3.41393)/49.49769)*TMath::Exp(-0.36644*x)))+0.82726;
      else if (idx == 80  ) num = (14.01413*(TMath::Erf((x-3.12285)/45.25724)*TMath::Exp(-0.31605*x)))+0.78562;
      else if (idx == 81  ) num = (17.86822*(TMath::Erf((x-3.52412)/45.92134)*TMath::Exp(-0.42450*x)))+0.84694;
      else if (idx == 82  ) num = (14.73872*(TMath::Erf((x-3.03222)/49.63267)*TMath::Exp(-0.29297*x)))+0.77890;
      else if (idx == 83  ) num = (15.60574*(TMath::Erf((x-2.90649)/47.46763)*TMath::Exp(-0.30469*x)))+0.75740;
      else if (idx == 84  ) num = (18.38720*(TMath::Erf((x-3.24519)/47.32342)*TMath::Exp(-0.37805*x)))+0.81214;
      else if (idx == 85  ) num = (17.59033*(TMath::Erf((x-3.26517)/49.79067)*TMath::Exp(-0.36382*x)))+0.80898;
      else if (idx == 86  ) num = (17.80933*(TMath::Erf((x-3.15215)/47.99472)*TMath::Exp(-0.35514*x)))+0.79842;
      else if (idx == 87  ) num = (15.96448*(TMath::Erf((x-3.11437)/49.71316)*TMath::Exp(-0.32700*x)))+0.79290;
      else if (idx == 88  ) num = (17.22428*(TMath::Erf((x-3.47041)/49.27225)*TMath::Exp(-0.38151*x)))+0.83625;
      else if (idx == 89  ) num = (17.31821*(TMath::Erf((x-3.45379)/49.96952)*TMath::Exp(-0.38404*x)))+0.83003;
      else if (idx == 90  ) num = (17.91241*(TMath::Erf((x-3.23173)/49.67625)*TMath::Exp(-0.36634*x)))+0.80714;
      else if (idx == 91  ) num = (18.50535*(TMath::Erf((x-3.77631)/46.94574)*TMath::Exp(-0.46140*x)))+0.86724;
      else if (idx == 92  ) num = (15.98155*(TMath::Erf((x-3.35727)/49.87934)*TMath::Exp(-0.34793*x)))+0.81598;
      else if (idx == 93  ) num = (17.17557*(TMath::Erf((x-3.25534)/49.40185)*TMath::Exp(-0.35586*x)))+0.81327;
      else if (idx == 94  ) num = (17.02992*(TMath::Erf((x-2.88489)/49.99321)*TMath::Exp(-0.30920*x)))+0.75598;
      else if (idx == 95  ) num = (15.59849*(TMath::Erf((x-3.13861)/49.61052)*TMath::Exp(-0.31499*x)))+0.79177;
      else if (idx == 96  ) num = (16.99808*(TMath::Erf((x-3.13057)/49.88129)*TMath::Exp(-0.34323*x)))+0.79495;
      else if (idx == 97  ) num = (18.72274*(TMath::Erf((x-3.51926)/49.97318)*TMath::Exp(-0.40434*x)))+0.84404;
      else if (idx == 98  ) num = (13.31813*(TMath::Erf((x-4.07545)/31.74505)*TMath::Exp(-0.53720*x)))+0.88745;
      else if (idx == 99  ) num = (18.02874*(TMath::Erf((x-3.42457)/46.86059)*TMath::Exp(-0.39504*x)))+0.83111;
      else if (idx == 100 ) num = (16.63954*(TMath::Erf((x-3.99177)/49.16659)*TMath::Exp(-0.43050*x)))+0.87610;
   }
   else
   {
      if (idx==0) num = (8.53448*(TMath::Erf((x-3.58338)/46.65403)*TMath::Exp(-0.45945*x)))+0.87671;
      else if (idx == -1   ) (8.51499*(TMath::Erf((x-3.57407)/46.75991)*TMath::Exp(-0.46033*x)))+0.87700;
      else if (idx == -2   ) (8.34522*(TMath::Erf((x-3.61830)/47.69810)*TMath::Exp(-0.45005*x)))+0.87659;
      else if (idx == 1   ) num = (9.50400*(TMath::Erf((x-3.59430)/40.17708)*TMath::Exp(-0.55158*x)))+0.87937;
      else if (idx == 2   ) num = (6.86028*(TMath::Erf((x-3.69193)/49.96846)*TMath::Exp(-0.36263*x)))+0.87739;
      else if (idx == 3   ) num = (5.85417*(TMath::Erf((x-4.12600)/49.61938)*TMath::Exp(-0.37453*x)))+0.88602;
      else if (idx == 4   ) num = (11.33423*(TMath::Erf((x-5.46094)/38.28257)*TMath::Exp(-1.01199*x)))+0.89282;
      else if (idx == 5   ) num = (9.18537*(TMath::Erf((x-3.60933)/44.48213)*TMath::Exp(-0.51850*x)))+0.88095;
      else if (idx == 6   ) num = (3.99444*(TMath::Erf((x-6.73851)/18.11390)*TMath::Exp(-0.97877*x)))+0.89583;
      else if (idx == 7   ) num = (7.85033*(TMath::Erf((x-5.62398)/41.88284)*TMath::Exp(-0.76938*x)))+0.90947;
      else if (idx == 8   ) num = (7.76763*(TMath::Erf((x-3.61400)/49.19226)*TMath::Exp(-0.40274*x)))+0.87622;
      else if (idx == 9   ) num = (7.92488*(TMath::Erf((x-2.84328)/49.95336)*TMath::Exp(-0.33050*x)))+0.83317;
      else if (idx == 10  ) num = (12.13057*(TMath::Erf((x-5.00825)/27.94048)*TMath::Exp(-1.08833*x)))+0.89749;
      else if (idx == 11  ) num = (7.89966*(TMath::Erf((x-9.41016)/49.97682)*TMath::Exp(-1.02539*x)))+0.90504;
      else if (idx == 12  ) num = (7.90740*(TMath::Erf((x-2.68945)/49.99922)*TMath::Exp(-0.32365*x)))+0.82688;
      else if (idx == 13  ) num = (7.72739*(TMath::Erf((x-3.70121)/49.32545)*TMath::Exp(-0.42747*x)))+0.88044;
      else if (idx == 14  ) num = (9.14016*(TMath::Erf((x-3.47039)/43.65971)*TMath::Exp(-0.49530*x)))+0.86921;
      else if (idx == 15  ) num = (7.09797*(TMath::Erf((x-2.28128)/49.99921)*TMath::Exp(-0.25363*x)))+0.78454;
      else if (idx == 16  ) num = (8.98686*(TMath::Erf((x-3.91937)/47.66305)*TMath::Exp(-0.52035*x)))+0.89308;
      else if (idx == 17  ) num = (7.13982*(TMath::Erf((x-8.50069)/45.89805)*TMath::Exp(-0.90803*x)))+0.91110;
      else if (idx == 18  ) num = (7.74457*(TMath::Erf((x-2.42844)/49.97167)*TMath::Exp(-0.28511*x)))+0.80039;
      else if (idx == 19  ) num = (5.73034*(TMath::Erf((x-9.89625)/49.98851)*TMath::Exp(-0.88409*x)))+0.91021;
      else if (idx == 20  ) num = (7.17122*(TMath::Erf((x-2.82689)/49.85219)*TMath::Exp(-0.29497*x)))+0.82661;
      else if (idx == 21  ) num = (8.58598*(TMath::Erf((x-2.67587)/49.89096)*TMath::Exp(-0.33475*x)))+0.81990;
      else if (idx == 22  ) num = (6.55633*(TMath::Erf((x-1.09123)/47.50639)*TMath::Exp(-0.18148*x)))+0.66725;
      else if (idx == 23  ) num = (8.44877*(TMath::Erf((x-3.30560)/42.13558)*TMath::Exp(-0.45806*x)))+0.86272;
      else if (idx == 24  ) num = (11.91803*(TMath::Erf((x-3.82383)/33.99095)*TMath::Exp(-0.76083*x)))+0.89040;
      else if (idx == 25  ) num = (11.67588*(TMath::Erf((x-5.68914)/28.13283)*TMath::Exp(-1.16160*x)))+0.89223;
      else if (idx == 26  ) num = (10.11875*(TMath::Erf((x-2.51657)/46.03570)*TMath::Exp(-0.35343*x)))+0.81000;
      else if (idx == 27  ) num = (8.65406*(TMath::Erf((x-3.55567)/45.69400)*TMath::Exp(-0.45171*x)))+0.87843;
      else if (idx == 28  ) num = (10.80560*(TMath::Erf((x-4.03673)/49.86181)*TMath::Exp(-0.61139*x)))+0.88539;
      else if (idx == 29  ) num = (7.80262*(TMath::Erf((x-3.35448)/44.98677)*TMath::Exp(-0.41805*x)))+0.86616;
      else if (idx == 30  ) num = (7.96901*(TMath::Erf((x-3.45202)/48.67893)*TMath::Exp(-0.41649*x)))+0.86827;
      else if (idx == 31  ) num = (7.67785*(TMath::Erf((x-2.80783)/49.99963)*TMath::Exp(-0.32475*x)))+0.83634;
      else if (idx == 32  ) num = (8.50618*(TMath::Erf((x-2.38473)/49.97459)*TMath::Exp(-0.29218*x)))+0.79394;
      else if (idx == 33  ) num = (6.16334*(TMath::Erf((x-2.53832)/48.08802)*TMath::Exp(-0.25692*x)))+0.80763;
      else if (idx == 34  ) num = (7.43982*(TMath::Erf((x-3.40711)/49.42605)*TMath::Exp(-0.39116*x)))+0.86373;
      else if (idx == 35  ) num = (5.59513*(TMath::Erf((x-2.27544)/46.32219)*TMath::Exp(-0.22107*x)))+0.78564;
      else if (idx == 36  ) num = (7.82935*(TMath::Erf((x-3.03943)/49.98562)*TMath::Exp(-0.35544*x)))+0.84375;
      else if (idx == 37  ) num = (6.44807*(TMath::Erf((x-2.63105)/49.97654)*TMath::Exp(-0.27423*x)))+0.81585;
      else if (idx == 38  ) num = (11.09147*(TMath::Erf((x-3.47927)/34.72083)*TMath::Exp(-0.63872*x)))+0.87922;
      else if (idx == 39  ) num = (6.69529*(TMath::Erf((x-2.79008)/49.96244)*TMath::Exp(-0.28851*x)))+0.82485;
      else if (idx == 40  ) num = (9.01715*(TMath::Erf((x-7.46084)/43.12971)*TMath::Exp(-1.00576*x)))+0.90509;
      else if (idx == 41  ) num = (5.71516*(TMath::Erf((x-3.26275)/49.88688)*TMath::Exp(-0.28811*x)))+0.85309;
      else if (idx == 42  ) num = (10.40998*(TMath::Erf((x-6.51620)/41.13676)*TMath::Exp(-0.98790*x)))+0.90290;
      else if (idx == 43  ) num = (8.56339*(TMath::Erf((x-5.91934)/40.55437)*TMath::Exp(-0.86758*x)))+0.90188;
      else if (idx == 44  ) num = (7.26911*(TMath::Erf((x-6.18070)/34.16506)*TMath::Exp(-0.89866*x)))+0.90647;
      else if (idx == 45  ) num = (8.25674*(TMath::Erf((x-3.19053)/49.27846)*TMath::Exp(-0.39197*x)))+0.86031;
      else if (idx == 46  ) num = (7.94636*(TMath::Erf((x-2.22835)/49.96850)*TMath::Exp(-0.25638*x)))+0.77886;
      else if (idx == 47  ) num = (10.96849*(TMath::Erf((x-5.03017)/48.78341)*TMath::Exp(-0.78751*x)))+0.89775;
      else if (idx == 48  ) num = (8.08066*(TMath::Erf((x-8.70758)/46.03956)*TMath::Exp(-1.00699*x)))+0.91259;
      else if (idx == 49  ) num = (5.79779*(TMath::Erf((x-3.00162)/49.71515)*TMath::Exp(-0.29624*x)))+0.84209;
      else if (idx == 50  ) num = (6.26682*(TMath::Erf((x-1.94404)/49.96837)*TMath::Exp(-0.22497*x)))+0.76184;
      else if (idx == 51  ) num = (7.99360*(TMath::Erf((x-3.72953)/49.06690)*TMath::Exp(-0.44226*x)))+0.87937;
      else if (idx == 52  ) num = (6.74411*(TMath::Erf((x-2.67925)/49.89107)*TMath::Exp(-0.28579*x)))+0.82186;
      else if (idx == 53  ) num = (11.97902*(TMath::Erf((x-9.08508)/49.23950)*TMath::Exp(-1.22062*x)))+0.90045;
      else if (idx == 54  ) num = (11.69372*(TMath::Erf((x-3.40908)/33.65627)*TMath::Exp(-0.66323*x)))+0.87920;
      else if (idx == 55  ) num = (7.92689*(TMath::Erf((x-3.72607)/48.55989)*TMath::Exp(-0.46473*x)))+0.87640;
      else if (idx == 56  ) num = (9.89306*(TMath::Erf((x-5.78692)/42.87703)*TMath::Exp(-0.92625*x)))+0.89330;
      else if (idx == 57  ) num = (7.42886*(TMath::Erf((x-9.69905)/49.46860)*TMath::Exp(-1.02278*x)))+0.90194;
      else if (idx == 58  ) num = (10.93910*(TMath::Erf((x-3.38003)/42.85162)*TMath::Exp(-0.54801*x)))+0.87479;
      else if (idx == 59  ) num = (11.96373*(TMath::Erf((x-4.99215)/31.80681)*TMath::Exp(-1.04250*x)))+0.89082;
      else if (idx == 60  ) num = (6.78999*(TMath::Erf((x-2.25790)/49.93610)*TMath::Exp(-0.24915*x)))+0.78731;
      else if (idx == 61  ) num = (10.90511*(TMath::Erf((x-4.58646)/29.65722)*TMath::Exp(-0.92322*x)))+0.89776;
      else if (idx == 62  ) num = (7.18688*(TMath::Erf((x-2.37780)/49.95194)*TMath::Exp(-0.25924*x)))+0.79360;
      else if (idx == 63  ) num = (6.46950*(TMath::Erf((x-3.93445)/49.93603)*TMath::Exp(-0.38325*x)))+0.87954;
      else if (idx == 64  ) num = (9.24482*(TMath::Erf((x-3.40447)/43.22079)*TMath::Exp(-0.48834*x)))+0.87160;
      else if (idx == 65  ) num = (7.79821*(TMath::Erf((x-4.27426)/49.30841)*TMath::Exp(-0.50075*x)))+0.89581;
      else if (idx == 66  ) num = (10.92694*(TMath::Erf((x-6.09511)/36.84811)*TMath::Exp(-1.05625*x)))+0.89660;
      else if (idx == 67  ) num = (6.54150*(TMath::Erf((x-9.62114)/49.16531)*TMath::Exp(-0.98115*x)))+0.89791;
      else if (idx == 68  ) num = (3.86070*(TMath::Erf((x-9.89463)/33.84597)*TMath::Exp(-0.88978*x)))+0.91047;
      else if (idx == 69  ) num = (11.81084*(TMath::Erf((x-3.70952)/30.81510)*TMath::Exp(-0.76979*x)))+0.88484;
      else if (idx == 70  ) num = (9.13053*(TMath::Erf((x-8.29142)/46.40893)*TMath::Exp(-1.02289*x)))+0.90951;
      else if (idx == 71  ) num = (7.63541*(TMath::Erf((x-2.95231)/49.84217)*TMath::Exp(-0.32615*x)))+0.83914;
      else if (idx == 72  ) num = (8.58968*(TMath::Erf((x-3.81860)/49.46951)*TMath::Exp(-0.46890*x)))+0.88357;
      else if (idx == 73  ) num = (8.35603*(TMath::Erf((x-3.67977)/48.18433)*TMath::Exp(-0.43665*x)))+0.87884;
      else if (idx == 74  ) num = (5.78044*(TMath::Erf((x-1.05033)/48.42144)*TMath::Exp(-0.16396*x)))+0.67765;
      else if (idx == 75  ) num = (8.34006*(TMath::Erf((x-3.34690)/48.54141)*TMath::Exp(-0.40082*x)))+0.86586;
      else if (idx == 76  ) num = (1.57024*(TMath::Erf((x-8.58685)/12.51672)*TMath::Exp(-0.79819*x)))+0.91187;
      else if (idx == 77  ) num = (11.02619*(TMath::Erf((x-5.05555)/30.79948)*TMath::Exp(-0.96908*x)))+0.90283;
      else if (idx == 78  ) num = (5.73146*(TMath::Erf((x-9.58434)/47.39582)*TMath::Exp(-0.91621*x)))+0.90514;
      else if (idx == 79  ) num = (6.30006*(TMath::Erf((x-1.64159)/49.89254)*TMath::Exp(-0.19180*x)))+0.72929;
      else if (idx == 80  ) num = (16.04759*(TMath::Erf((x-5.98188)/42.63048)*TMath::Exp(-1.15534*x)))+0.89830;
      else if (idx == 81  ) num = (4.75832*(TMath::Erf((x-5.98482)/29.87643)*TMath::Exp(-0.75109*x)))+0.90739;
      else if (idx == 82  ) num = (10.50676*(TMath::Erf((x-6.39475)/40.11646)*TMath::Exp(-1.03020*x)))+0.89973;
      else if (idx == 83  ) num = (7.70055*(TMath::Erf((x-3.55397)/48.48093)*TMath::Exp(-0.40275*x)))+0.87489;
      else if (idx == 84  ) num = (11.92815*(TMath::Erf((x-3.18648)/32.00318)*TMath::Exp(-0.63729*x)))+0.87085;
      else if (idx == 85  ) num = (11.42764*(TMath::Erf((x-4.55627)/28.26643)*TMath::Exp(-0.94873*x)))+0.89362;
      else if (idx == 86  ) num = (14.68590*(TMath::Erf((x-5.95223)/37.24739)*TMath::Exp(-1.19948*x)))+0.89497;
      else if (idx == 87  ) num = (17.05090*(TMath::Erf((x-9.34755)/41.53453)*TMath::Exp(-1.48328*x)))+0.89502;
      else if (idx == 88  ) num = (7.84855*(TMath::Erf((x-3.50281)/46.02807)*TMath::Exp(-0.42106*x)))+0.87153;
      else if (idx == 89  ) num = (14.12427*(TMath::Erf((x-6.76234)/47.42049)*TMath::Exp(-1.15482*x)))+0.89811;
      else if (idx == 90  ) num = (7.15395*(TMath::Erf((x-3.65360)/49.72398)*TMath::Exp(-0.39549*x)))+0.87621;
      else if (idx == 91  ) num = (10.22450*(TMath::Erf((x-5.52373)/46.05517)*TMath::Exp(-0.82590*x)))+0.90809;
      else if (idx == 92  ) num = (6.92129*(TMath::Erf((x-2.30888)/49.80654)*TMath::Exp(-0.24540*x)))+0.78974;
      else if (idx == 93  ) num = (9.83439*(TMath::Erf((x-4.06090)/48.45006)*TMath::Exp(-0.56697*x)))+0.89150;
      else if (idx == 94  ) num = (6.33570*(TMath::Erf((x-2.05133)/49.96815)*TMath::Exp(-0.22115*x)))+0.76752;
      else if (idx == 95  ) num = (11.02603*(TMath::Erf((x-5.54674)/38.90357)*TMath::Exp(-0.95717*x)))+0.90001;
      else if (idx == 96  ) num = (9.03013*(TMath::Erf((x-3.70245)/47.89088)*TMath::Exp(-0.50647*x)))+0.87702;
      else if (idx == 97  ) num = (9.58474*(TMath::Erf((x-3.99101)/42.48818)*TMath::Exp(-0.60033*x)))+0.89146;
      else if (idx == 98  ) num = (1.22187*(TMath::Erf((x-7.71773)/9.55293)*TMath::Exp(-0.72138*x)))+0.91884;
      else if (idx == 99  ) num = (11.84832*(TMath::Erf((x-5.59685)/41.41251)*TMath::Exp(-0.94828*x)))+0.90254;
      else if (idx == 100 ) num = (6.38639*(TMath::Erf((x-1.79869)/49.98234)*TMath::Exp(-0.21274*x)))+0.74532;
   }

   // return
   return num/den;
}

///////////////////////////////////////////////////
//             M U I D    P b P b                //
///////////////////////////////////////////////////

// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// !!  ONLY FOR SYSTEMATICS! DO NOT APPLY FOR THE NOMINAL CORRECTION!!! !!
// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

double tnp_weight_muid_pbpb(double x, double eta) {
   // denominator (from MC)
   double den=1;
   if (fabs(eta)<1.2) den = 0.99*TMath::Erf((x+1.16)/3.49);
   else if (fabs(eta)<1.8) den = 0.99*TMath::Erf((x+3.63)/4.27);
   else if (fabs(eta)<2.1) den = 1.00*TMath::Erf((x+4.64)/6.08);
   else den = 0.99*TMath::Erf((x+3.17)/4.98);

   // numerator (from data)
   double num=1;
   if (fabs(eta)<1.2) num = 0.98*TMath::Erf((x+0.39)/2.94);
   else if (fabs(eta)<1.8) num = 0.99*TMath::Erf((x+4.38)/5.03);
   else if (fabs(eta)<2.1) num = 1.00*TMath::Erf((x+5.26)/6.31);
   else num = 1.00*TMath::Erf((x+3.34)/5.38);

   return num/den;
}

///////////////////////////////////////////////////
//                 M U I D    P P                //
///////////////////////////////////////////////////

// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// !!  ONLY FOR SYSTEMATICS! DO NOT APPLY FOR THE NOMINAL CORRECTION!!! !!
// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

double tnp_weight_muid_pp(double x, double eta, int idx) {
   // binned
   if (idx == -10) {
      if (fabs(eta) < 1.2) {
         // 0 < |eta| < 1.2
         if (x<4) return 0.999016;
         else if (x<4.5) return 1.0032;
         else if (x<5) return 1.00129;
         else if (x<5.5) return 0.995773;
         else if (x<6) return 0.996447;
         else if (x<7) return 0.999116;
         else if (x<8) return 0.997846;
         else if (x<10.5) return 0.996956;
         else if (x<14) return 0.998218;
         else if (x<18) return 1.0025;
         else return 1.0019;
      } else if (fabs(eta)<1.8) {
         // 1.2 < |eta| < 1.8
         if (x<3) return 1.00141;
         else if (x<3.5) return 0.998122;
         else if (x<4) return 1.00036;
         else if (x<4.5) return 0.999239;
         else if (x<5) return 0.995965;
         else if (x<6) return 0.999212;
         else if (x<7) return 0.998085;
         else if (x<9) return 1.0001;
         else if (x<14) return 1.0001;
         else if (x<18) return 0.985798;
         else return 0.98404;
      } else if (fabs(eta)<2.1) {
         // 1.8 < |eta| < 2.1
         if (x<2.5) return 1.00627;
         else if (x<3) return 1.0015;
         else if (x<3.5) return 1.00118;
         else if (x<4) return 0.999083;
         else if (x<4.5) return 1.00139;
         else if (x<5) return 0.998681;
         else if (x<6) return 1.00311;
         else if (x<7) return 0.998239;
         else if (x<9) return 0.997688;
         else if (x<12) return 1.00159;
         else if (x<16) return 0.981826;
         else return 1.00123;
      } else {
         // 2.1 < |eta| < 2.4
         if (x<2.5) return 1.00186;
         else if (x<3) return 0.999581;
         else if (x<3.5) return 1.00009;
         else if (x<4) return 0.998081;
         else if (x<4.5) return 1.00169;
         else if (x<5) return 0.998405;
         else if (x<6.5) return 1.0008;
         else if (x<8.5) return 0.996034;
         else if (x<11) return 0.999455;
         else if (x<14) return 0.9939;
         else return 0.999963;
      }
   }

   // denominator (from MC)
   double den=1;
   if (fabs(eta)<1.2) den = (0.17208*TMath::Erf((x-1.91314)/2.21047))+0.81832;
   else if (fabs(eta)<1.8) den = (0.02468*TMath::Erf((x+5.04947)/15.26842))+0.97444;
   else if (fabs(eta)<2.1) den = (0.01153*TMath::Erf((x-1.49227)/2.99647))+0.98563;
   else den = (0.02998*TMath::Erf((x+9.82571)/17.70087))+0.96778;

   // numerator (from data)
   double num=1;
   if (fabs(eta)<1.2)
   {
      if (idx==0) num = (0.65056*TMath::Erf((x+1.06411)/3.60783))+0.33990;
      else if (idx == -1   ) num = (0.65054*TMath::Erf((x+0.52317)/3.22754))+0.33988;
      else if (idx == -2   ) num = (0.65043*TMath::Erf((x+1.05790)/3.61151))+0.33977;
      else if (idx == 1   ) num = (0.65140*TMath::Erf((x+1.75709)/4.08591))+0.34071;
      else if (idx == 2   ) num = (0.64931*TMath::Erf((x-0.41516)/2.48127))+0.33827;
      else if (idx == 3   ) num = (0.65024*TMath::Erf((x+1.08938)/3.58935))+0.33960;
      else if (idx == 4   ) num = (0.64972*TMath::Erf((x-0.02056)/2.78565))+0.33891;
      else if (idx == 5   ) num = (0.64957*TMath::Erf((x+0.03376)/2.84038))+0.33873;
      else if (idx == 6   ) num = (0.64962*TMath::Erf((x-0.75132)/2.27541))+0.33782;
      else if (idx == 7   ) num = (0.64970*TMath::Erf((x+1.08485)/3.59787))+0.33907;
      else if (idx == 8   ) num = (0.65046*TMath::Erf((x-0.28486)/2.59920))+0.33938;
      else if (idx == 9   ) num = (0.65063*TMath::Erf((x+1.07105)/3.60252))+0.33998;
      else if (idx == 10  ) num = (0.65083*TMath::Erf((x+1.06005)/3.61115))+0.34017;
      else if (idx == 11  ) num = (0.64991*TMath::Erf((x-1.13032)/1.97759))+0.33720;
      else if (idx == 12  ) num = (0.65165*TMath::Erf((x+1.00830)/3.64554))+0.34095;
      else if (idx == 13  ) num = (0.65039*TMath::Erf((x+1.10948)/3.57520))+0.33975;
      else if (idx == 14  ) num = (0.65149*TMath::Erf((x+1.01807)/3.63471))+0.34080;
      else if (idx == 15  ) num = (0.64903*TMath::Erf((x-0.00418)/2.76485))+0.33822;
      else if (idx == 16  ) num = (0.65152*TMath::Erf((x+1.02884)/3.62775))+0.34082;
      else if (idx == 17  ) num = (0.64996*TMath::Erf((x-1.07909)/2.01371))+0.33740;
      else if (idx == 18  ) num = (0.65032*TMath::Erf((x+1.04405)/3.62230))+0.33966;
      else if (idx == 19  ) num = (0.65081*TMath::Erf((x+1.07720)/3.59819))+0.34015;
      else if (idx == 20  ) num = (0.65090*TMath::Erf((x+1.02659)/3.62829))+0.34022;
      else if (idx == 21  ) num = (0.65132*TMath::Erf((x+2.45098)/4.66314))+0.34102;
      else if (idx == 22  ) num = (0.64947*TMath::Erf((x+0.15171)/2.90855))+0.33869;
      else if (idx == 23  ) num = (0.65112*TMath::Erf((x+1.05572)/3.60771))+0.34044;
      else if (idx == 24  ) num = (0.64964*TMath::Erf((x+0.04038)/2.84485))+0.33885;
      else if (idx == 25  ) num = (0.65043*TMath::Erf((x+0.04518)/2.86226))+0.33955;
      else if (idx == 26  ) num = (0.64983*TMath::Erf((x-0.28455)/2.61949))+0.33880;
      else if (idx == 27  ) num = (0.64951*TMath::Erf((x-0.48408)/2.45976))+0.33825;
      else if (idx == 28  ) num = (0.65112*TMath::Erf((x+1.02046)/3.63393))+0.34043;
      else if (idx == 29  ) num = (0.65033*TMath::Erf((x-0.74844)/2.26639))+0.33856;
      else if (idx == 30  ) num = (0.65022*TMath::Erf((x+1.10393)/3.57794))+0.33959;
      else if (idx == 31  ) num = (0.64952*TMath::Erf((x+0.07303)/2.82718))+0.33875;
      else if (idx == 32  ) num = (0.64970*TMath::Erf((x-0.90524)/2.16320))+0.33769;
      else if (idx == 33  ) num = (0.65124*TMath::Erf((x+3.09389)/5.06835))+0.34140;
      else if (idx == 34  ) num = (0.64988*TMath::Erf((x-0.73538)/2.25703))+0.33850;
      else if (idx == 35  ) num = (0.65017*TMath::Erf((x-0.27917)/2.65693))+0.33907;
      else if (idx == 36  ) num = (0.65059*TMath::Erf((x+1.11143)/3.57852))+0.33995;
      else if (idx == 37  ) num = (0.65018*TMath::Erf((x+0.03591)/2.87507))+0.33934;
      else if (idx == 38  ) num = (0.64921*TMath::Erf((x-0.01372)/2.84675))+0.33834;
      else if (idx == 39  ) num = (0.65017*TMath::Erf((x+0.01952)/2.82864))+0.33933;
      else if (idx == 40  ) num = (0.65041*TMath::Erf((x+0.33291)/3.12092))+0.33966;
      else if (idx == 41  ) num = (0.65089*TMath::Erf((x+1.01114)/3.63998))+0.34021;
      else if (idx == 42  ) num = (0.64967*TMath::Erf((x-0.44331)/2.49583))+0.33847;
      else if (idx == 43  ) num = (0.65043*TMath::Erf((x+1.05809)/3.61164))+0.33977;
      else if (idx == 44  ) num = (0.64946*TMath::Erf((x-0.87386)/2.18043))+0.33774;
      else if (idx == 45  ) num = (0.65032*TMath::Erf((x-0.10689)/2.75200))+0.33938;
      else if (idx == 46  ) num = (0.65074*TMath::Erf((x+1.05429)/3.61225))+0.34008;
      else if (idx == 47  ) num = (0.65037*TMath::Erf((x+1.04853)/3.61819))+0.33971;
      else if (idx == 48  ) num = (0.65038*TMath::Erf((x+0.24876)/3.05137))+0.33958;
      else if (idx == 49  ) num = (0.65059*TMath::Erf((x+1.95740)/4.16679))+0.34005;
      else if (idx == 50  ) num = (0.65056*TMath::Erf((x+1.06707)/3.60583))+0.33990;
      else if (idx == 51  ) num = (0.65131*TMath::Erf((x+1.03983)/3.62190))+0.34063;
      else if (idx == 52  ) num = (0.64979*TMath::Erf((x+0.13582)/2.89028))+0.33901;
      else if (idx == 53  ) num = (0.65033*TMath::Erf((x+1.79325)/4.08350))+0.33970;
      else if (idx == 54  ) num = (0.65026*TMath::Erf((x+1.03897)/3.62450))+0.33961;
      else if (idx == 55  ) num = (0.64977*TMath::Erf((x-0.29551)/2.61590))+0.33869;
      else if (idx == 56  ) num = (0.65063*TMath::Erf((x-1.37869)/1.89139))+0.33799;
      else if (idx == 57  ) num = (0.65037*TMath::Erf((x+1.05270)/3.61612))+0.33972;
      else if (idx == 58  ) num = (0.65069*TMath::Erf((x-0.71389)/2.30752))+0.33922;
      else if (idx == 59  ) num = (0.65164*TMath::Erf((x+1.07105)/3.60411))+0.34096;
      else if (idx == 60  ) num = (0.65047*TMath::Erf((x-0.31532)/2.63497))+0.33929;
      else if (idx == 61  ) num = (0.65075*TMath::Erf((x+1.07685)/3.59820))+0.34009;
      else if (idx == 62  ) num = (0.65103*TMath::Erf((x+1.05913)/3.60751))+0.34036;
      else if (idx == 63  ) num = (0.65055*TMath::Erf((x+1.09092)/3.58970))+0.33990;
      else if (idx == 64  ) num = (0.65010*TMath::Erf((x-0.24701)/2.65347))+0.33903;
      else if (idx == 65  ) num = (0.65087*TMath::Erf((x+1.05797)/3.60850))+0.34021;
      else if (idx == 66  ) num = (0.65019*TMath::Erf((x-0.03357)/2.79214))+0.33935;
      else if (idx == 67  ) num = (0.65095*TMath::Erf((x+1.03904)/3.61900))+0.34028;
      else if (idx == 68  ) num = (0.65043*TMath::Erf((x+1.07979)/3.59851))+0.33978;
      else if (idx == 69  ) num = (0.65040*TMath::Erf((x+1.08007)/3.59452))+0.33975;
      else if (idx == 70  ) num = (0.65005*TMath::Erf((x-0.21274)/2.66303))+0.33909;
      else if (idx == 71  ) num = (0.65021*TMath::Erf((x-0.11300)/2.76729))+0.33923;
      else if (idx == 72  ) num = (0.64990*TMath::Erf((x-0.40015)/2.50522))+0.33883;
      else if (idx == 73  ) num = (0.65044*TMath::Erf((x+0.24585)/3.02294))+0.33965;
      else if (idx == 74  ) num = (0.64992*TMath::Erf((x-0.15958)/2.74541))+0.33899;
      else if (idx == 75  ) num = (0.65047*TMath::Erf((x+1.06001)/3.61055))+0.33982;
      else if (idx == 76  ) num = (0.65047*TMath::Erf((x+1.05417)/3.61424))+0.33982;
      else if (idx == 77  ) num = (0.65036*TMath::Erf((x-0.02420)/2.81914))+0.33950;
      else if (idx == 78  ) num = (0.65061*TMath::Erf((x-0.53682)/2.47079))+0.33918;
      else if (idx == 79  ) num = (0.64992*TMath::Erf((x-0.53099)/2.44295))+0.33870;
      else if (idx == 80  ) num = (0.65146*TMath::Erf((x+1.02731)/3.62806))+0.34077;
      else if (idx == 81  ) num = (0.65020*TMath::Erf((x-0.00647)/2.83588))+0.33933;
      else if (idx == 82  ) num = (0.64998*TMath::Erf((x+0.13118)/2.91665))+0.33917;
      else if (idx == 83  ) num = (0.65111*TMath::Erf((x+1.01973)/3.63200))+0.34043;
      else if (idx == 84  ) num = (0.64957*TMath::Erf((x-0.61299)/2.37619))+0.33811;
      else if (idx == 85  ) num = (0.65095*TMath::Erf((x+0.99012)/3.65350))+0.34026;
      else if (idx == 86  ) num = (0.65080*TMath::Erf((x+1.08126)/3.59483))+0.34015;
      else if (idx == 87  ) num = (0.65152*TMath::Erf((x+1.05801)/3.61249))+0.34084;
      else if (idx == 88  ) num = (0.65015*TMath::Erf((x+1.07806)/3.59945))+0.33951;
      else if (idx == 89  ) num = (0.65009*TMath::Erf((x-0.78664)/2.21524))+0.33842;
      else if (idx == 90  ) num = (0.64965*TMath::Erf((x-0.22088)/2.67912))+0.33862;
      else if (idx == 91  ) num = (0.65009*TMath::Erf((x-0.02928)/2.80920))+0.33921;
      else if (idx == 92  ) num = (0.65099*TMath::Erf((x+1.03275)/3.62342))+0.34031;
      else if (idx == 93  ) num = (0.65058*TMath::Erf((x+0.20088)/3.00726))+0.33978;
      else if (idx == 94  ) num = (0.64993*TMath::Erf((x+1.13313)/3.55896))+0.33931;
      else if (idx == 95  ) num = (0.65051*TMath::Erf((x-0.31800)/2.61781))+0.33939;
      else if (idx == 96  ) num = (0.65057*TMath::Erf((x+0.30485)/3.06343))+0.33982;
      else if (idx == 97  ) num = (0.65068*TMath::Erf((x+2.46422)/4.59819))+0.34028;
      else if (idx == 98  ) num = (0.65104*TMath::Erf((x+1.73535)/4.10454))+0.34035;
      else if (idx == 99  ) num = (0.65013*TMath::Erf((x+1.10219)/3.58129))+0.33950;
      else if (idx == 100 ) num = (0.64940*TMath::Erf((x-0.53068)/2.41102))+0.33824;
   }
   else if (fabs(eta)<1.8)
   {
      if (idx==0) num = (0.00091*TMath::Erf((x-5.31924)/0.02122))+0.98855;
      else if (idx == -1   ) num = (0.00151*TMath::Erf((x-5.09442)/0.00003))+0.98928;
      else if (idx == -2   ) num = (0.00057*TMath::Erf((x-5.28933)/0.00171))+0.98778;
      else if (idx == 1   ) num = (0.00136*TMath::Erf((x-5.31893)/0.01042))+0.98904;
      else if (idx == 2   ) num = (0.00234*TMath::Erf((x-5.08261)/0.01738))+0.98931;
      else if (idx == 3   ) num = (0.00082*TMath::Erf((x-5.28933)/0.00014))+0.98849;
      else if (idx == 4   ) num = (0.00096*TMath::Erf((x-5.29108)/0.00323))+0.98947;
      else if (idx == 5   ) num = (0.00166*TMath::Erf((x-5.31197)/0.01033))+0.98910;
      else if (idx == 6   ) num = (0.00175*TMath::Erf((x-5.12735)/0.01185))+0.98838;
      else if (idx == 7   ) num = (0.00007*TMath::Erf((x-4.28599)/0.02199))+0.98879;
      else if (idx == 8   ) num = (0.00164*TMath::Erf((x-5.66635)/0.00429))+0.98810;
      else if (idx == 9   ) num = (0.00094*TMath::Erf((x-5.22726)/0.00081))+0.98753;
      else if (idx == 10  ) num = (0.00075*TMath::Erf((x-3.73943)/0.00001))+0.98806;
      else if (idx == 11  ) num = (0.00237*TMath::Erf((x-5.36281)/0.18206))+0.99009;
      else if (idx == 12  ) num = (0.00215*TMath::Erf((x-5.13416)/0.01237))+0.98965;
      else if (idx == 13  ) num = (0.00074*TMath::Erf((x-5.47560)/0.01215))+0.98882;
      else if (idx == 14  ) num = (0.00010*TMath::Erf((x-0.95052)/0.00801))+0.98693;
      else if (idx == 15  ) num = (0.00288*TMath::Erf((x-5.42157)/0.00061))+0.98997;
      else if (idx == 16  ) num = (0.00061*TMath::Erf((x-5.28967)/0.00093))+0.98733;
      else if (idx == 17  ) num = (0.00000*TMath::Erf((x-5.23751)/0.02567))+0.98866;
      else if (idx == 18  ) num = (0.00003*TMath::Erf((x+7.03426)/0.00418))+0.98828;
      else if (idx == 19  ) num = (0.00011*TMath::Erf((x-6.01141)/0.00126))+0.98816;
      else if (idx == 20  ) num = (0.00056*TMath::Erf((x-5.28602)/0.00044))+0.98927;
      else if (idx == 21  ) num = (0.00058*TMath::Erf((x-4.45247)/0.01359))+0.98864;
      else if (idx == 22  ) num = (0.00277*TMath::Erf((x-5.42026)/0.01084))+0.98895;
      else if (idx == 23  ) num = (0.00084*TMath::Erf((x-5.29118)/0.00315))+0.98909;
      else if (idx == 24  ) num = (0.00103*TMath::Erf((x-5.28884)/0.00190))+0.99012;
      else if (idx == 25  ) num = (0.00000*TMath::Erf((x-5.28805)/0.00324))+0.98597;
      else if (idx == 26  ) num = (0.00210*TMath::Erf((x-5.36754)/0.17913))+0.98958;
      else if (idx == 27  ) num = (0.00168*TMath::Erf((x-5.24647)/0.00060))+0.99043;
      else if (idx == 28  ) num = (0.00060*TMath::Erf((x-5.29192)/0.00016))+0.98924;
      else if (idx == 29  ) num = (0.00105*TMath::Erf((x-5.28802)/0.00386))+0.98897;
      else if (idx == 30  ) num = (0.00195*TMath::Erf((x-5.34848)/0.00737))+0.99007;
      else if (idx == 31  ) num = (0.00008*TMath::Erf((x+7.78141)/1.85322))+0.98854;
      else if (idx == 32  ) num = (0.00012*TMath::Erf((x-1.23445)/0.00000))+0.98722;
      else if (idx == 33  ) num = (0.00182*TMath::Erf((x-5.35921)/0.00530))+0.98951;
      else if (idx == 34  ) num = (0.00153*TMath::Erf((x-5.67615)/0.00112))+0.98940;
      else if (idx == 35  ) num = (0.00001*TMath::Erf((x-4.33025)/0.49825))+0.98760;
      else if (idx == 36  ) num = (0.00008*TMath::Erf((x-1.16208)/0.00028))+0.98764;
      else if (idx == 37  ) num = (0.00157*TMath::Erf((x-5.51345)/0.08884))+0.98877;
      else if (idx == 38  ) num = (0.00001*TMath::Erf((x+0.29419)/0.00007))+0.98711;
      else if (idx == 39  ) num = (0.00194*TMath::Erf((x-5.39964)/0.07169))+0.98844;
      else if (idx == 40  ) num = (0.00103*TMath::Erf((x-5.29104)/0.00000))+0.98885;
      else if (idx == 41  ) num = (0.00058*TMath::Erf((x-7.82953)/0.00516))+0.98899;
      else if (idx == 42  ) num = (0.00001*TMath::Erf((x-4.65810)/0.08185))+0.98771;
      else if (idx == 43  ) num = (0.00224*TMath::Erf((x-5.09863)/0.00041))+0.99049;
      else if (idx == 44  ) num = (0.00100*TMath::Erf((x-3.56573)/0.00187))+0.98775;
      else if (idx == 45  ) num = (0.00003*TMath::Erf((x+1.20323)/0.00430))+0.98830;
      else if (idx == 46  ) num = (0.00138*TMath::Erf((x-4.88720)/0.00705))+0.98813;
      else if (idx == 47  ) num = (0.00034*TMath::Erf((x-5.57333)/0.49688))+0.98812;
      else if (idx == 48  ) num = (0.00022*TMath::Erf((x-1.42791)/0.01376))+0.98543;
      else if (idx == 49  ) num = (0.00051*TMath::Erf((x-4.74120)/0.03368))+0.98871;
      else if (idx == 50  ) num = (0.00191*TMath::Erf((x-5.31697)/0.00307))+0.98907;
      else if (idx == 51  ) num = (0.00156*TMath::Erf((x-4.44407)/1.58889))+0.98927;
      else if (idx == 52  ) num = (0.00127*TMath::Erf((x-5.36495)/0.00089))+0.98800;
      else if (idx == 53  ) num = (0.00052*TMath::Erf((x-5.37989)/0.00111))+0.98807;
      else if (idx == 54  ) num = (0.00030*TMath::Erf((x-5.70616)/0.00346))+0.98778;
      else if (idx == 55  ) num = (0.00090*TMath::Erf((x-5.29745)/0.00362))+0.98683;
      else if (idx == 56  ) num = (0.00007*TMath::Erf((x-0.57297)/0.00007))+0.98662;
      else if (idx == 57  ) num = (0.00209*TMath::Erf((x-5.47378)/0.36703))+0.98896;
      else if (idx == 58  ) num = (0.00076*TMath::Erf((x-5.29400)/0.00112))+0.99043;
      else if (idx == 59  ) num = (0.00001*TMath::Erf((x-4.70915)/0.00062))+0.98770;
      else if (idx == 60  ) num = (0.00184*TMath::Erf((x-5.34958)/0.01891))+0.98907;
      else if (idx == 61  ) num = (0.00017*TMath::Erf((x-5.26200)/0.00004))+0.98864;
      else if (idx == 62  ) num = (0.00151*TMath::Erf((x+9.95548)/0.36913))+0.98687;
      else if (idx == 63  ) num = (0.00273*TMath::Erf((x-5.87543)/0.02136))+0.99180;
      else if (idx == 64  ) num = (0.00138*TMath::Erf((x-5.30464)/0.26765))+0.98770;
      else if (idx == 65  ) num = (0.00103*TMath::Erf((x-5.27233)/0.00087))+0.98925;
      else if (idx == 66  ) num = (0.03589*TMath::Erf((x+9.41988)/0.97132))+0.95144;
      else if (idx == 67  ) num = (0.00106*TMath::Erf((x-5.26233)/0.32092))+0.98934;
      else if (idx == 68  ) num = (0.00005*TMath::Erf((x-5.27658)/0.00021))+0.98813;
      else if (idx == 69  ) num = (0.00150*TMath::Erf((x-5.25288)/0.00255))+0.98858;
      else if (idx == 70  ) num = (0.00000*TMath::Erf((x-5.28632)/0.12637))+0.98722;
      else if (idx == 71  ) num = (0.00174*TMath::Erf((x-5.34719)/0.00323))+0.98940;
      else if (idx == 72  ) num = (0.00000*TMath::Erf((x-5.28742)/0.00041))+0.98660;
      else if (idx == 73  ) num = (0.00114*TMath::Erf((x-5.20864)/0.00078))+0.98808;
      else if (idx == 74  ) num = (0.00076*TMath::Erf((x-5.51852)/0.00318))+0.98818;
      else if (idx == 75  ) num = (0.00245*TMath::Erf((x-5.37386)/0.15901))+0.98995;
      else if (idx == 76  ) num = (0.00000*TMath::Erf((x+3.13812)/0.00453))+0.98849;
      else if (idx == 77  ) num = (0.00145*TMath::Erf((x-5.29583)/0.01900))+0.99006;
      else if (idx == 78  ) num = (0.00000*TMath::Erf((x+9.80866)/17.93786))+0.98549;
      else if (idx == 79  ) num = (0.00000*TMath::Erf((x-5.68307)/0.00076))+0.98500;
      else if (idx == 80  ) num = (0.00114*TMath::Erf((x-5.28706)/0.00025))+0.98992;
      else if (idx == 81  ) num = (0.00012*TMath::Erf((x-5.24563)/0.00162))+0.98752;
      else if (idx == 82  ) num = (0.00092*TMath::Erf((x-5.88510)/0.24883))+0.98954;
      else if (idx == 83  ) num = (0.00145*TMath::Erf((x-5.34872)/0.07423))+0.98913;
      else if (idx == 84  ) num = (0.00120*TMath::Erf((x-5.40806)/0.42025))+0.98989;
      else if (idx == 85  ) num = (0.00050*TMath::Erf((x-5.21218)/0.00006))+0.98841;
      else if (idx == 86  ) num = (0.00034*TMath::Erf((x-5.09431)/0.00028))+0.98889;
      else if (idx == 87  ) num = (0.00097*TMath::Erf((x-5.17970)/0.00237))+0.98726;
      else if (idx == 88  ) num = (0.00000*TMath::Erf((x-5.30180)/1.13220))+0.98676;
      else if (idx == 89  ) num = (0.00077*TMath::Erf((x-4.43925)/0.00002))+0.98728;
      else if (idx == 90  ) num = (0.00061*TMath::Erf((x-5.37427)/0.00015))+0.98916;
      else if (idx == 91  ) num = (0.00035*TMath::Erf((x-4.71424)/0.00390))+0.98833;
      else if (idx == 92  ) num = (0.00164*TMath::Erf((x-5.31881)/0.00336))+0.98823;
      else if (idx == 93  ) num = (0.00024*TMath::Erf((x-5.90145)/0.02904))+0.98708;
      else if (idx == 94  ) num = (0.00147*TMath::Erf((x-5.28772)/0.00651))+0.98882;
      else if (idx == 95  ) num = (0.00245*TMath::Erf((x-5.57178)/0.27759))+0.98838;
      else if (idx == 96  ) num = (0.00125*TMath::Erf((x-5.29809)/0.00573))+0.98925;
      else if (idx == 97  ) num = (0.00186*TMath::Erf((x-5.59014)/0.01209))+0.98979;
      else if (idx == 98  ) num = (0.00064*TMath::Erf((x-5.38035)/0.01080))+0.98921;
      else if (idx == 99  ) num = (0.00142*TMath::Erf((x-5.48559)/0.00006))+0.98971;
      else if (idx == 100 ) num = (0.00081*TMath::Erf((x-5.28933)/0.00112))+0.98748;
   }
   else if (fabs(eta)<2.1)
   {
      if (idx==0) num = (0.00044*TMath::Erf((x-3.74162)/0.00002))+0.99393;
      else if (idx == -1   ) num = (0.00046*TMath::Erf((x-3.74800)/0.00020))+0.99443;
      else if (idx == -2   ) num = (0.00001*TMath::Erf((x+8.89205)/49.99955))+0.99366;
      else if (idx == 1   ) num = (0.00011*TMath::Erf((x-3.74475)/0.00002))+0.99261;
      else if (idx == 2   ) num = (0.00006*TMath::Erf((x+9.93632)/48.12037))+0.99197;
      else if (idx == 3   ) num = (0.00051*TMath::Erf((x-3.71871)/0.00079))+0.99218;
      else if (idx == 4   ) num = (0.00049*TMath::Erf((x-3.73395)/0.00185))+0.99378;
      else if (idx == 5   ) num = (0.00000*TMath::Erf((x+2.56941)/48.04950))+0.99444;
      else if (idx == 6   ) num = (0.00000*TMath::Erf((x-4.20254)/49.74085))+0.99307;
      else if (idx == 7   ) num = (0.00155*TMath::Erf((x-3.74698)/0.02312))+0.99291;
      else if (idx == 8   ) num = (0.06347*TMath::Erf((x+9.93533)/2.53092))+0.92571;
      else if (idx == 9   ) num = (0.06346*TMath::Erf((x+9.26384)/0.52366))+0.92650;
      else if (idx == 10  ) num = (0.00000*TMath::Erf((x-3.74427)/0.00005))+0.99288;
      else if (idx == 11  ) num = (0.00067*TMath::Erf((x-3.74420)/0.00000))+0.99288;
      else if (idx == 12  ) num = (0.00025*TMath::Erf((x-3.74342)/0.00002))+0.99348;
      else if (idx == 13  ) num = (0.00001*TMath::Erf((x+9.31207)/0.10113))+0.99338;
      else if (idx == 14  ) num = (0.00018*TMath::Erf((x-3.71296)/0.00681))+0.99264;
      else if (idx == 15  ) num = (0.00077*TMath::Erf((x+7.80964)/1.39365))+0.99260;
      else if (idx == 16  ) num = (0.00031*TMath::Erf((x-3.74707)/0.00018))+0.99169;
      else if (idx == 17  ) num = (0.00000*TMath::Erf((x+9.57073)/14.40599))+0.99304;
      else if (idx == 18  ) num = (0.00001*TMath::Erf((x-1.00916)/0.58189))+0.99204;
      else if (idx == 19  ) num = (0.00007*TMath::Erf((x+4.57153)/2.61501))+0.99154;
      else if (idx == 20  ) num = (0.06903*TMath::Erf((x+8.65337)/2.14382))+0.92286;
      else if (idx == 21  ) num = (0.00044*TMath::Erf((x-3.74281)/0.00003))+0.99356;
      else if (idx == 22  ) num = (0.00019*TMath::Erf((x-3.74041)/0.00003))+0.99292;
      else if (idx == 23  ) num = (0.00004*TMath::Erf((x-3.72459)/0.00001))+0.99104;
      else if (idx == 24  ) num = (0.00002*TMath::Erf((x-3.67281)/0.00000))+0.99143;
      else if (idx == 25  ) num = (0.00000*TMath::Erf((x-3.73468)/0.00004))+0.99169;
      else if (idx == 26  ) num = (0.00044*TMath::Erf((x-3.73202)/0.00007))+0.99417;
      else if (idx == 27  ) num = (0.00136*TMath::Erf((x-3.74337)/0.00002))+0.99519;
      else if (idx == 28  ) num = (0.00851*TMath::Erf((x+8.83508)/0.67580))+0.98409;
      else if (idx == 29  ) num = (0.00003*TMath::Erf((x-3.74399)/0.00004))+0.99276;
      else if (idx == 30  ) num = (0.00031*TMath::Erf((x-3.74431)/0.00002))+0.99350;
      else if (idx == 31  ) num = (0.01841*TMath::Erf((x+3.50474)/1.04321))+0.97423;
      else if (idx == 32  ) num = (0.00000*TMath::Erf((x+9.99995)/43.30009))+0.99318;
      else if (idx == 33  ) num = (0.00000*TMath::Erf((x-3.60569)/0.00000))+0.99026;
      else if (idx == 34  ) num = (0.00093*TMath::Erf((x-3.74389)/0.00044))+0.99301;
      else if (idx == 35  ) num = (0.00000*TMath::Erf((x-8.92884)/29.66736))+0.99294;
      else if (idx == 36  ) num = (0.00000*TMath::Erf((x-7.35746)/48.99923))+0.99261;
      else if (idx == 37  ) num = (0.00000*TMath::Erf((x+9.99969)/19.13033))+0.98940;
      else if (idx == 38  ) num = (0.00000*TMath::Erf((x+5.92396)/22.42387))+0.99220;
      else if (idx == 39  ) num = (0.00013*TMath::Erf((x-3.73198)/0.00001))+0.99263;
      else if (idx == 40  ) num = (0.13909*TMath::Erf((x+9.96407)/3.11669))+0.85163;
      else if (idx == 41  ) num = (0.00096*TMath::Erf((x-3.74403)/0.00001))+0.99257;
      else if (idx == 42  ) num = (0.00024*TMath::Erf((x-3.74303)/0.00002))+0.99332;
      else if (idx == 43  ) num = (0.00000*TMath::Erf((x-9.98320)/49.97553))+0.99345;
      else if (idx == 44  ) num = (0.00002*TMath::Erf((x-3.71622)/0.00000))+0.99408;
      else if (idx == 45  ) num = (0.00094*TMath::Erf((x-3.74339)/0.00000))+0.99280;
      else if (idx == 46  ) num = (0.32500*TMath::Erf((x+9.88233)/3.87070))+0.66607;
      else if (idx == 47  ) num = (0.00653*TMath::Erf((x+9.94878)/2.28720))+0.98409;
      else if (idx == 48  ) num = (0.00013*TMath::Erf((x-3.70406)/0.10120))+0.99332;
      else if (idx == 49  ) num = (0.00058*TMath::Erf((x+7.98184)/0.00006))+0.99221;
      else if (idx == 50  ) num = (0.00144*TMath::Erf((x-3.74432)/0.00045))+0.99258;
      else if (idx == 51  ) num = (0.01464*TMath::Erf((x+2.89788)/0.05898))+0.97779;
      else if (idx == 52  ) num = (0.00003*TMath::Erf((x+7.76198)/1.18005))+0.99394;
      else if (idx == 53  ) num = (0.03385*TMath::Erf((x+3.25585)/0.82628))+0.95853;
      else if (idx == 54  ) num = (0.00002*TMath::Erf((x+9.92108)/49.06275))+0.99200;
      else if (idx == 55  ) num = (0.00000*TMath::Erf((x-3.73302)/0.00000))+0.99394;
      else if (idx == 56  ) num = (0.00894*TMath::Erf((x+9.77267)/3.95870))+0.98233;
      else if (idx == 57  ) num = (0.00001*TMath::Erf((x+9.99049)/47.97702))+0.99153;
      else if (idx == 58  ) num = (0.00061*TMath::Erf((x-3.69466)/0.00497))+0.99373;
      else if (idx == 59  ) num = (0.00007*TMath::Erf((x-3.72675)/0.00000))+0.99438;
      else if (idx == 60  ) num = (0.00000*TMath::Erf((x-1.84245)/35.20512))+0.99382;
      else if (idx == 61  ) num = (0.00004*TMath::Erf((x-3.74340)/0.00002))+0.99265;
      else if (idx == 62  ) num = (0.00014*TMath::Erf((x-3.74318)/0.00002))+0.99217;
      else if (idx == 63  ) num = (0.06341*TMath::Erf((x+9.26311)/0.72479))+0.92778;
      else if (idx == 64  ) num = (0.00000*TMath::Erf((x+9.81673)/41.03769))+0.99118;
      else if (idx == 65  ) num = (0.00028*TMath::Erf((x-3.74288)/0.00002))+0.99350;
      else if (idx == 66  ) num = (0.00111*TMath::Erf((x-3.74252)/0.00000))+0.99396;
      else if (idx == 67  ) num = (0.00000*TMath::Erf((x-4.90212)/0.95667))+0.99211;
      else if (idx == 68  ) num = (0.04510*TMath::Erf((x+9.97874)/2.59743))+0.94553;
      else if (idx == 69  ) num = (0.00018*TMath::Erf((x-3.74291)/0.00002))+0.99313;
      else if (idx == 70  ) num = (0.00000*TMath::Erf((x+1.86614)/48.64582))+0.99169;
      else if (idx == 71  ) num = (0.00768*TMath::Erf((x+6.87739)/0.14965))+0.98425;
      else if (idx == 72  ) num = (0.00063*TMath::Erf((x+9.98017)/4.02246))+0.99097;
      else if (idx == 73  ) num = (0.00092*TMath::Erf((x-3.74813)/0.00184))+0.99369;
      else if (idx == 74  ) num = (0.10951*TMath::Erf((x+8.92381)/1.65171))+0.88041;
      else if (idx == 75  ) num = (0.00038*TMath::Erf((x-3.74303)/0.00048))+0.99446;
      else if (idx == 76  ) num = (0.00001*TMath::Erf((x+9.88200)/49.96587))+0.99126;
      else if (idx == 77  ) num = (0.00000*TMath::Erf((x-8.00313)/29.83168))+0.99346;
      else if (idx == 78  ) num = (0.00103*TMath::Erf((x-3.74407)/0.00001))+0.99253;
      else if (idx == 79  ) num = (0.00073*TMath::Erf((x-3.64688)/0.02493))+0.99285;
      else if (idx == 80  ) num = (0.00001*TMath::Erf((x+9.93762)/10.73283))+0.99081;
      else if (idx == 81  ) num = (0.00015*TMath::Erf((x-3.71898)/0.00001))+0.99296;
      else if (idx == 82  ) num = (0.00017*TMath::Erf((x-3.74443)/0.00015))+0.99398;
      else if (idx == 83  ) num = (0.00000*TMath::Erf((x-3.74495)/0.04911))+0.99211;
      else if (idx == 84  ) num = (0.00002*TMath::Erf((x-3.73210)/0.00004))+0.99330;
      else if (idx == 85  ) num = (0.00009*TMath::Erf((x-3.70176)/0.00634))+0.99202;
      else if (idx == 86  ) num = (0.00000*TMath::Erf((x+9.97851)/27.95348))+0.99284;
      else if (idx == 87  ) num = (0.00133*TMath::Erf((x-3.81809)/0.05587))+0.99416;
      else if (idx == 88  ) num = (0.00000*TMath::Erf((x+9.91745)/34.92218))+0.99399;
      else if (idx == 89  ) num = (0.04501*TMath::Erf((x+9.97865)/3.83713))+0.94645;
      else if (idx == 90  ) num = (0.00000*TMath::Erf((x+8.93534)/2.24068))+0.99190;
      else if (idx == 91  ) num = (0.00016*TMath::Erf((x-3.74522)/0.00019))+0.99418;
      else if (idx == 92  ) num = (0.00000*TMath::Erf((x+9.99921)/41.45613))+0.99242;
      else if (idx == 93  ) num = (0.00106*TMath::Erf((x-3.78473)/0.00001))+0.99240;
      else if (idx == 94  ) num = (0.00000*TMath::Erf((x+9.92683)/49.58075))+0.99100;
      else if (idx == 95  ) num = (0.00000*TMath::Erf((x+9.99938)/19.47296))+0.98913;
      else if (idx == 96  ) num = (0.00001*TMath::Erf((x-3.72894)/0.00000))+0.99357;
      else if (idx == 97  ) num = (0.00112*TMath::Erf((x-3.74267)/0.00004))+0.99387;
      else if (idx == 98  ) num = (0.00001*TMath::Erf((x-3.69106)/0.00895))+0.99213;
      else if (idx == 99  ) num = (0.00015*TMath::Erf((x-3.74369)/0.00002))+0.99248;
      else if (idx == 100 ) num = (0.00000*TMath::Erf((x-9.92473)/10.88786))+0.99241;
   }
   else
   {
      if (idx==0) num = (0.11211*TMath::Erf((x+2.94297)/3.65003))+0.87916;
      else if (idx == -1   ) (0.11224*TMath::Erf((x+2.97856)/3.62169))+0.87928;
      else if (idx == -2   ) (0.11202*TMath::Erf((x+2.90917)/3.67630))+0.87907;
      else if (idx == 1   ) num = (0.11266*TMath::Erf((x+3.26116)/3.40371))+0.87971;
      else if (idx == 2   ) num = (0.11278*TMath::Erf((x+8.86857)/8.22389))+0.88041;
      else if (idx == 3   ) num = (0.11105*TMath::Erf((x+3.63962)/3.09457))+0.87814;
      else if (idx == 4   ) num = (0.11175*TMath::Erf((x+3.05517)/3.60295))+0.87881;
      else if (idx == 5   ) num = (0.14737*TMath::Erf((x+2.58311)/2.91122))+0.84266;
      else if (idx == 6   ) num = (0.11225*TMath::Erf((x+4.89655)/4.95859))+0.87931;
      else if (idx == 7   ) num = (0.11132*TMath::Erf((x+3.50267)/4.11009))+0.87837;
      else if (idx == 8   ) num = (0.11282*TMath::Erf((x+2.61242)/3.80932))+0.87984;
      else if (idx == 9   ) num = (0.12196*TMath::Erf((x+8.72790)/7.72326))+0.86864;
      else if (idx == 10  ) num = (0.10989*TMath::Erf((x+4.09925)/2.65863))+0.87699;
      else if (idx == 11  ) num = (0.11232*TMath::Erf((x+3.01604)/3.59817))+0.87936;
      else if (idx == 12  ) num = (0.11216*TMath::Erf((x-0.36922)/1.44337))+0.87880;
      else if (idx == 13  ) num = (0.10977*TMath::Erf((x-1.11106)/0.75535))+0.87674;
      else if (idx == 14  ) num = (0.11156*TMath::Erf((x+3.32609)/3.37220))+0.87863;
      else if (idx == 15  ) num = (0.11122*TMath::Erf((x-0.36922)/1.23939))+0.87823;
      else if (idx == 16  ) num = (0.10964*TMath::Erf((x+3.75370)/2.91934))+0.87671;
      else if (idx == 17  ) num = (0.11203*TMath::Erf((x+2.89069)/3.67957))+0.87908;
      else if (idx == 18  ) num = (0.11259*TMath::Erf((x+3.07696)/3.55081))+0.87962;
      else if (idx == 19  ) num = (0.11223*TMath::Erf((x+7.84275)/8.31113))+0.88062;
      else if (idx == 20  ) num = (0.11087*TMath::Erf((x+3.86135)/2.91096))+0.87798;
      else if (idx == 21  ) num = (0.11115*TMath::Erf((x+3.53040)/3.18379))+0.87823;
      else if (idx == 22  ) num = (0.11098*TMath::Erf((x+3.17605)/3.54864))+0.87804;
      else if (idx == 23  ) num = (0.11288*TMath::Erf((x+6.52764)/7.00953))+0.88081;
      else if (idx == 24  ) num = (0.11127*TMath::Erf((x+3.36671)/3.33216))+0.87834;
      else if (idx == 25  ) num = (0.11305*TMath::Erf((x+9.95964)/9.95192))+0.88135;
      else if (idx == 26  ) num = (0.11048*TMath::Erf((x-0.22250)/1.19051))+0.87755;
      else if (idx == 27  ) num = (0.11135*TMath::Erf((x+3.64956)/3.10065))+0.87844;
      else if (idx == 28  ) num = (0.11087*TMath::Erf((x+3.62877)/3.08414))+0.87796;
      else if (idx == 29  ) num = (0.11173*TMath::Erf((x-0.46468)/1.12311))+0.87871;
      else if (idx == 30  ) num = (0.11065*TMath::Erf((x+3.89131)/2.87848))+0.87776;
      else if (idx == 31  ) num = (0.11043*TMath::Erf((x+3.78069)/2.98548))+0.87753;
      else if (idx == 32  ) num = (0.13811*TMath::Erf((x+2.57512)/3.33208))+0.85203;
      else if (idx == 33  ) num = (0.11225*TMath::Erf((x+3.11490)/3.51644))+0.87930;
      else if (idx == 34  ) num = (0.11144*TMath::Erf((x-0.13315)/1.31436))+0.87850;
      else if (idx == 35  ) num = (0.11199*TMath::Erf((x+2.75254)/3.76630))+0.87904;
      else if (idx == 36  ) num = (0.14888*TMath::Erf((x+2.75565)/3.23377))+0.84141;
      else if (idx == 37  ) num = (0.11311*TMath::Erf((x+2.47432)/3.89358))+0.88012;
      else if (idx == 38  ) num = (0.11232*TMath::Erf((x+2.30412)/3.81590))+0.87936;
      else if (idx == 39  ) num = (0.11116*TMath::Erf((x+3.05226)/3.62864))+0.87821;
      else if (idx == 40  ) num = (0.11164*TMath::Erf((x+0.65315)/2.13176))+0.87860;
      else if (idx == 41  ) num = (0.11262*TMath::Erf((x+3.09488)/3.53161))+0.87965;
      else if (idx == 42  ) num = (0.11031*TMath::Erf((x+3.41307)/3.33866))+0.87738;
      else if (idx == 43  ) num = (0.11099*TMath::Erf((x+3.35482)/3.36172))+0.87806;
      else if (idx == 44  ) num = (0.11128*TMath::Erf((x+3.19037)/3.52323))+0.87834;
      else if (idx == 45  ) num = (0.18168*TMath::Erf((x+2.37248)/2.97586))+0.80957;
      else if (idx == 46  ) num = (0.11251*TMath::Erf((x+2.73064)/3.75479))+0.87954;
      else if (idx == 47  ) num = (0.11080*TMath::Erf((x+3.47739)/3.27221))+0.87788;
      else if (idx == 48  ) num = (0.11121*TMath::Erf((x+3.11292)/3.57264))+0.87827;
      else if (idx == 49  ) num = (0.11681*TMath::Erf((x+9.66216)/8.68106))+0.87501;
      else if (idx == 50  ) num = (0.11133*TMath::Erf((x+1.11286)/2.48321))+0.87836;
      else if (idx == 51  ) num = (0.11195*TMath::Erf((x+0.90040)/2.23668))+0.87897;
      else if (idx == 52  ) num = (0.11082*TMath::Erf((x+3.25779)/3.51116))+0.87788;
      else if (idx == 53  ) num = (0.11214*TMath::Erf((x+2.97443)/3.62764))+0.87918;
      else if (idx == 54  ) num = (0.18879*TMath::Erf((x+2.40617)/3.09619))+0.80237;
      else if (idx == 55  ) num = (0.11098*TMath::Erf((x+3.36255)/3.35019))+0.87805;
      else if (idx == 56  ) num = (0.11296*TMath::Erf((x+7.92731)/8.23665))+0.88117;
      else if (idx == 57  ) num = (0.11147*TMath::Erf((x+3.50998)/3.25038))+0.87855;
      else if (idx == 58  ) num = (0.05674*TMath::Erf((x+3.40671)/4.86129))+0.93502;
      else if (idx == 59  ) num = (0.11282*TMath::Erf((x+2.87857)/3.67112))+0.87984;
      else if (idx == 60  ) num = (0.11149*TMath::Erf((x+3.34265)/3.39538))+0.87856;
      else if (idx == 61  ) num = (0.11028*TMath::Erf((x+3.74364)/2.99285))+0.87737;
      else if (idx == 62  ) num = (0.11152*TMath::Erf((x+2.62390)/3.72324))+0.87856;
      else if (idx == 63  ) num = (0.11171*TMath::Erf((x+3.28214)/3.43321))+0.87878;
      else if (idx == 64  ) num = (0.11238*TMath::Erf((x+3.02641)/3.59118))+0.87942;
      else if (idx == 65  ) num = (0.11134*TMath::Erf((x+3.18240)/3.50659))+0.87841;
      else if (idx == 66  ) num = (0.11075*TMath::Erf((x-1.12188)/0.78050))+0.87760;
      else if (idx == 67  ) num = (0.01702*TMath::Erf((x+3.85514)/21.83256))+0.98185;
      else if (idx == 68  ) num = (0.11117*TMath::Erf((x+3.28784)/3.41492))+0.87824;
      else if (idx == 69  ) num = (0.11268*TMath::Erf((x+2.62978)/3.82481))+0.87970;
      else if (idx == 70  ) num = (0.11278*TMath::Erf((x+2.74491)/3.76043))+0.87980;
      else if (idx == 71  ) num = (0.15667*TMath::Erf((x+2.66343)/3.09659))+0.83405;
      else if (idx == 72  ) num = (0.11384*TMath::Erf((x+5.50814)/6.31793))+0.88127;
      else if (idx == 73  ) num = (0.11126*TMath::Erf((x-0.57078)/1.14464))+0.87822;
      else if (idx == 74  ) num = (0.11086*TMath::Erf((x-0.10698)/1.45435))+0.87788;
      else if (idx == 75  ) num = (0.11346*TMath::Erf((x+2.44107)/3.90195))+0.88045;
      else if (idx == 76  ) num = (0.11298*TMath::Erf((x+3.02274)/3.58883))+0.88000;
      else if (idx == 77  ) num = (0.11101*TMath::Erf((x+3.55403)/3.21814))+0.87809;
      else if (idx == 78  ) num = (0.11187*TMath::Erf((x+2.78042)/3.74376))+0.87892;
      else if (idx == 79  ) num = (0.10862*TMath::Erf((x+3.91998)/2.00861))+0.87567;
      else if (idx == 80  ) num = (0.02333*TMath::Erf((x+3.85618)/25.87296))+0.98041;
      else if (idx == 81  ) num = (0.05732*TMath::Erf((x+3.44084)/4.81024))+0.93587;
      else if (idx == 82  ) num = (0.11126*TMath::Erf((x+2.75816)/3.67109))+0.87830;
      else if (idx == 83  ) num = (0.11371*TMath::Erf((x+2.71757)/3.78028))+0.88069;
      else if (idx == 84  ) num = (0.10894*TMath::Erf((x+4.28746)/2.45077))+0.87603;
      else if (idx == 85  ) num = (0.11219*TMath::Erf((x+3.24109)/3.41522))+0.87925;
      else if (idx == 86  ) num = (0.11157*TMath::Erf((x+3.34927)/3.37726))+0.87864;
      else if (idx == 87  ) num = (0.11309*TMath::Erf((x+2.61514)/3.82557))+0.88010;
      else if (idx == 88  ) num = (0.11146*TMath::Erf((x+2.72269)/3.72550))+0.87850;
      else if (idx == 89  ) num = (0.11105*TMath::Erf((x+1.68376)/2.46584))+0.87812;
      else if (idx == 90  ) num = (0.19083*TMath::Erf((x+2.34328)/3.09712))+0.79911;
      else if (idx == 91  ) num = (0.11129*TMath::Erf((x+4.06185)/2.67938))+0.87841;
      else if (idx == 92  ) num = (0.11069*TMath::Erf((x+3.15954)/3.66631))+0.87774;
      else if (idx == 93  ) num = (0.11242*TMath::Erf((x+1.05967)/2.73612))+0.87941;
      else if (idx == 94  ) num = (0.11042*TMath::Erf((x+3.44630)/3.29238))+0.87749;
      else if (idx == 95  ) num = (0.11220*TMath::Erf((x+4.41341)/4.92044))+0.87928;
      else if (idx == 96  ) num = (0.11225*TMath::Erf((x-0.00129)/1.43556))+0.87928;
      else if (idx == 97  ) num = (0.11244*TMath::Erf((x+2.85988)/3.71552))+0.87947;
      else if (idx == 98  ) num = (0.11047*TMath::Erf((x+3.91826)/2.86855))+0.87757;
      else if (idx == 99  ) num = (0.11120*TMath::Erf((x-0.33278)/1.15806))+0.87826;
      else if (idx == 100 ) num = (0.11336*TMath::Erf((x+2.54492)/3.83795))+0.88035;
   }

   // return
   return num/den;
}

///////////////////////////////////////////////////
//                   S T A    P P                //
///////////////////////////////////////////////////

// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// !!  ONLY FOR SYSTEMATICS! DO NOT APPLY FOR THE NOMINAL CORRECTION!!! !!
// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

double tnp_weight_sta_pp(double x, double eta, int idx) {
   // binned
   if (idx == -10) {
      if (fabs(eta) < 1.2) {
         // 0 < |eta| < 1.2
         if (x<4) return 1.03808;
         else if (x<4.5) return 1.00984;
         else if (x<5) return 1.01512;
         else if (x<5.5) return 1.00469;
         else if (x<6) return 1.00776;
         else if (x<7) return 0.997825;
         else if (x<8) return 0.996708;
         else if (x<9) return 1.00285;
         else if (x<14) return 0.998507;
         else return 1.00917;
      } else if (fabs(eta)<1.8) {
         // 1.2 < |eta| < 1.8
         if (x<3) return 1.04355;
         else if (x<3.5) return 1.02278;
         else if (x<4) return 1.01099;
         else if (x<4.5) return 0.999804;
         else if (x<5) return 1.00963;
         else if (x<6) return 1.01372;
         else if (x<7) return 1.00494;
         else if (x<8) return 1.02321;
         else if (x<9) return 1.00911;
         else if (x<14) return 1.01161;
         else return 1.03605;
      } else if (fabs(eta)<2.1) {
         // 1.8 < |eta| < 2.1
         if (x<2.5) return 1.03342;
         else if (x<3) return 1.00154;
         else if (x<3.5) return 1.00246;
         else if (x<4) return 1.01347;
         else if (x<4.5) return 0.997808;
         else if (x<5) return 1.01391;
         else if (x<6) return 1.01296;
         else if (x<7) return 1.01524;
         else if (x<10) return 0.992407;
         else return 1.0035;
      } else {
         // 2.1 < |eta| < 2.4
         if (x<2.5) return 1.02921;
         else if (x<3) return 1.00856;
         else if (x<3.5) return 0.989795;
         else if (x<4) return 0.96595;
         else if (x<4.5) return 0.974834;
         else if (x<5) return 0.975238;
         else if (x<6) return 1.01298;
         else if (x<7) return 1.01219;
         else if (x<10) return 1.00975;
         else return 1.00634;
      }
   }

   // denominator (from MC)
   double den=1;
   if (fabs(eta)<1.2) den = (1.16795*TMath::Erf((x-2.70934)/1.14920))-0.18306;
   else if (fabs(eta)<1.8) den = (0.06821*TMath::Erf((x-2.40814)/1.06603))+0.90716;
   else if (fabs(eta)<2.1) den = (0.02081*TMath::Erf((x-2.07575)/0.86473))+0.96405;
   else den = (0.03392*TMath::Erf((x-2.61705)/0.01196))+0.94859;

   // numerator (from data)
   double num=1;
   if (fabs(eta)<1.2)
   {
      if (idx==0) num = (1.16758*TMath::Erf((x-2.58133)/1.23203))-0.17965;
      else if (idx == -1   ) num = (1.17053*TMath::Erf((x-2.61300)/1.18712))-0.17622;
      else if (idx == -2   ) num = (1.16382*TMath::Erf((x-2.58590)/1.23885))-0.18326;
      else if (idx == 1   ) num = (1.16700*TMath::Erf((x-2.36020)/1.43181))-0.17582;
      else if (idx == 2   ) num = (1.16539*TMath::Erf((x-2.52115)/1.29782))-0.18122;
      else if (idx == 3   ) num = (1.16762*TMath::Erf((x-2.64785)/1.17143))-0.18082;
      else if (idx == 4   ) num = (1.16447*TMath::Erf((x-2.61742)/1.17935))-0.18252;
      else if (idx == 5   ) num = (1.16884*TMath::Erf((x-2.59168)/1.24108))-0.17854;
      else if (idx == 6   ) num = (1.16686*TMath::Erf((x-2.47371)/1.33061))-0.17837;
      else if (idx == 7   ) num = (1.16720*TMath::Erf((x-2.70913)/1.08270))-0.18266;
      else if (idx == 8   ) num = (1.16525*TMath::Erf((x-2.49888)/1.30110))-0.18124;
      else if (idx == 9   ) num = (1.16789*TMath::Erf((x-2.63047)/1.19730))-0.17882;
      else if (idx == 10  ) num = (1.16684*TMath::Erf((x-2.48989)/1.32979))-0.17845;
      else if (idx == 11  ) num = (1.16694*TMath::Erf((x-2.31255)/1.52756))-0.17495;
      else if (idx == 12  ) num = (1.16801*TMath::Erf((x-2.79174)/1.00617))-0.18359;
      else if (idx == 13  ) num = (1.16614*TMath::Erf((x-2.45351)/1.34162))-0.17859;
      else if (idx == 14  ) num = (1.16806*TMath::Erf((x-2.69153)/1.13098))-0.18142;
      else if (idx == 15  ) num = (1.16761*TMath::Erf((x-2.67314)/1.14122))-0.18127;
      else if (idx == 16  ) num = (1.16706*TMath::Erf((x-2.61257)/1.19390))-0.17943;
      else if (idx == 17  ) num = (1.16672*TMath::Erf((x-2.62486)/1.19387))-0.17975;
      else if (idx == 18  ) num = (1.16785*TMath::Erf((x-2.58425)/1.23435))-0.17941;
      else if (idx == 19  ) num = (1.16728*TMath::Erf((x-2.57546)/1.22612))-0.17987;
      else if (idx == 20  ) num = (1.16771*TMath::Erf((x-2.52427)/1.27853))-0.17916;
      else if (idx == 21  ) num = (1.16550*TMath::Erf((x-2.45544)/1.32700))-0.17934;
      else if (idx == 22  ) num = (1.16540*TMath::Erf((x-2.64923)/1.15499))-0.18093;
      else if (idx == 23  ) num = (1.16491*TMath::Erf((x-2.41059)/1.39382))-0.17896;
      else if (idx == 24  ) num = (1.16691*TMath::Erf((x-2.57260)/1.22369))-0.18019;
      else if (idx == 25  ) num = (1.16559*TMath::Erf((x-2.40739)/1.41465))-0.17803;
      else if (idx == 26  ) num = (1.16560*TMath::Erf((x-2.57422)/1.22594))-0.18145;
      else if (idx == 27  ) num = (1.16506*TMath::Erf((x-2.57091)/1.22315))-0.18194;
      else if (idx == 28  ) num = (1.16746*TMath::Erf((x-2.57831)/1.22997))-0.17972;
      else if (idx == 29  ) num = (1.16745*TMath::Erf((x-2.37610)/1.45160))-0.17563;
      else if (idx == 30  ) num = (1.16624*TMath::Erf((x-2.56506)/1.21575))-0.18076;
      else if (idx == 31  ) num = (1.16768*TMath::Erf((x-2.58133)/1.23236))-0.17954;
      else if (idx == 32  ) num = (1.16633*TMath::Erf((x-2.77967)/1.02073))-0.18490;
      else if (idx == 33  ) num = (1.16544*TMath::Erf((x-2.50802)/1.29525))-0.18074;
      else if (idx == 34  ) num = (1.16493*TMath::Erf((x-2.62524)/1.16450))-0.18142;
      else if (idx == 35  ) num = (1.16703*TMath::Erf((x-2.72122)/1.09428))-0.18283;
      else if (idx == 36  ) num = (1.16503*TMath::Erf((x-2.61976)/1.19304))-0.18153;
      else if (idx == 37  ) num = (1.16833*TMath::Erf((x-2.66642)/1.15551))-0.18052;
      else if (idx == 38  ) num = (1.16370*TMath::Erf((x-2.41708)/1.38067))-0.18037;
      else if (idx == 39  ) num = (1.16723*TMath::Erf((x-2.66487)/1.17290))-0.18133;
      else if (idx == 40  ) num = (1.16572*TMath::Erf((x-2.67899)/1.14427))-0.18309;
      else if (idx == 41  ) num = (1.16642*TMath::Erf((x-2.51860)/1.26732))-0.18064;
      else if (idx == 42  ) num = (1.16556*TMath::Erf((x-2.71821)/1.09995))-0.18411;
      else if (idx == 43  ) num = (1.16613*TMath::Erf((x-2.49473)/1.28035))-0.18028;
      else if (idx == 44  ) num = (1.16866*TMath::Erf((x-2.63350)/1.18488))-0.17785;
      else if (idx == 45  ) num = (1.16749*TMath::Erf((x-2.59076)/1.24032))-0.17982;
      else if (idx == 46  ) num = (1.16790*TMath::Erf((x-2.57461)/1.22577))-0.17927;
      else if (idx == 47  ) num = (1.16824*TMath::Erf((x-2.67387)/1.13265))-0.18075;
      else if (idx == 48  ) num = (1.16616*TMath::Erf((x-2.58478)/1.23561))-0.18102;
      else if (idx == 49  ) num = (1.16640*TMath::Erf((x-2.60869)/1.19460))-0.18020;
      else if (idx == 50  ) num = (1.16448*TMath::Erf((x-2.64067)/1.17439))-0.18165;
      else if (idx == 51  ) num = (1.16665*TMath::Erf((x-2.57761)/1.22805))-0.18050;
      else if (idx == 52  ) num = (1.16633*TMath::Erf((x-2.70705)/1.08890))-0.18336;
      else if (idx == 53  ) num = (1.16360*TMath::Erf((x-2.64722)/1.14220))-0.18470;
      else if (idx == 54  ) num = (1.16622*TMath::Erf((x-2.82307)/0.98234))-0.18571;
      else if (idx == 55  ) num = (1.16861*TMath::Erf((x-2.77445)/1.04888))-0.18241;
      else if (idx == 56  ) num = (1.16738*TMath::Erf((x-2.43860)/1.37573))-0.17695;
      else if (idx == 57  ) num = (1.16663*TMath::Erf((x-2.62544)/1.16394))-0.17980;
      else if (idx == 58  ) num = (1.16687*TMath::Erf((x-2.67946)/1.12929))-0.18223;
      else if (idx == 59  ) num = (1.16561*TMath::Erf((x-2.69918)/1.10140))-0.18375;
      else if (idx == 60  ) num = (1.16874*TMath::Erf((x-2.77648)/1.02043))-0.18254;
      else if (idx == 61  ) num = (1.16806*TMath::Erf((x-2.59030)/1.24059))-0.17926;
      else if (idx == 62  ) num = (1.16554*TMath::Erf((x-2.57731)/1.22923))-0.18154;
      else if (idx == 63  ) num = (1.16623*TMath::Erf((x-2.57743)/1.22907))-0.18088;
      else if (idx == 64  ) num = (1.16837*TMath::Erf((x-2.62142)/1.19239))-0.17837;
      else if (idx == 65  ) num = (1.16696*TMath::Erf((x-2.65505)/1.14375))-0.18166;
      else if (idx == 66  ) num = (1.16823*TMath::Erf((x-2.50619)/1.28983))-0.17855;
      else if (idx == 67  ) num = (1.16823*TMath::Erf((x-2.54596)/1.25876))-0.17895;
      else if (idx == 68  ) num = (1.16819*TMath::Erf((x-2.71943)/1.11222))-0.18167;
      else if (idx == 69  ) num = (1.16651*TMath::Erf((x-2.57525)/1.22662))-0.18060;
      else if (idx == 70  ) num = (1.16765*TMath::Erf((x-2.65457)/1.15639))-0.18092;
      else if (idx == 71  ) num = (1.16828*TMath::Erf((x-2.68893)/1.11361))-0.18110;
      else if (idx == 72  ) num = (1.16794*TMath::Erf((x-2.52886)/1.25919))-0.17863;
      else if (idx == 73  ) num = (1.16316*TMath::Erf((x-2.55720)/1.21036))-0.18360;
      else if (idx == 74  ) num = (1.16626*TMath::Erf((x-2.57454)/1.22533))-0.18083;
      else if (idx == 75  ) num = (1.16514*TMath::Erf((x-2.65011)/1.14863))-0.18327;
      else if (idx == 76  ) num = (1.16653*TMath::Erf((x-2.58162)/1.23233))-0.18065;
      else if (idx == 77  ) num = (1.16709*TMath::Erf((x-2.61645)/1.19296))-0.17998;
      else if (idx == 78  ) num = (1.16623*TMath::Erf((x-2.72503)/1.08064))-0.18382;
      else if (idx == 79  ) num = (1.16746*TMath::Erf((x-2.73278)/1.08737))-0.18267;
      else if (idx == 80  ) num = (1.16881*TMath::Erf((x-2.67436)/1.14886))-0.18021;
      else if (idx == 81  ) num = (1.16197*TMath::Erf((x-2.63443)/1.17541))-0.18442;
      else if (idx == 82  ) num = (1.16672*TMath::Erf((x-2.58033)/1.23165))-0.18045;
      else if (idx == 83  ) num = (1.16586*TMath::Erf((x-2.44743)/1.36027))-0.17865;
      else if (idx == 84  ) num = (1.16851*TMath::Erf((x-2.67130)/1.15253))-0.18032;
      else if (idx == 85  ) num = (1.16804*TMath::Erf((x-2.55509)/1.27405))-0.17945;
      else if (idx == 86  ) num = (1.16542*TMath::Erf((x-2.65429)/1.13064))-0.18315;
      else if (idx == 87  ) num = (1.16560*TMath::Erf((x-2.57285)/1.22490))-0.18144;
      else if (idx == 88  ) num = (1.16796*TMath::Erf((x-2.61488)/1.18860))-0.17843;
      else if (idx == 89  ) num = (1.16788*TMath::Erf((x-2.65523)/1.16118))-0.18082;
      else if (idx == 90  ) num = (1.16749*TMath::Erf((x-2.58958)/1.24030))-0.17981;
      else if (idx == 91  ) num = (1.16681*TMath::Erf((x-2.78033)/1.02002))-0.18434;
      else if (idx == 92  ) num = (1.16691*TMath::Erf((x-2.65075)/1.16838))-0.18151;
      else if (idx == 93  ) num = (1.16390*TMath::Erf((x-2.56670)/1.21834))-0.18301;
      else if (idx == 94  ) num = (1.16549*TMath::Erf((x-2.41220)/1.39811))-0.17823;
      else if (idx == 95  ) num = (1.16820*TMath::Erf((x-2.50374)/1.30755))-0.17745;
      else if (idx == 96  ) num = (1.16587*TMath::Erf((x-2.60871)/1.18093))-0.18073;
      else if (idx == 97  ) num = (1.16760*TMath::Erf((x-2.65529)/1.16194))-0.18099;
      else if (idx == 98  ) num = (1.16504*TMath::Erf((x-2.75330)/1.03414))-0.18559;
      else if (idx == 99  ) num = (1.16392*TMath::Erf((x-2.43573)/1.36728))-0.18025;
      else if (idx == 100 ) num = (1.16500*TMath::Erf((x-2.63876)/1.16753))-0.18134;
   }
   else if (fabs(eta)<1.8)
   {
      if (idx==0) num = (0.23761*TMath::Erf((x+9.72168)/10.29208))+0.75652;
      else if (idx == -1   ) num = (0.23695*TMath::Erf((x+9.99255)/6.13173))+0.75737;
      else if (idx == -2   ) num = (1.32136*TMath::Erf((x+6.37654)/6.09136))-0.33280;
      else if (idx == 1   ) num = (0.23522*TMath::Erf((x+9.28865)/9.95839))+0.75451;
      else if (idx == 2   ) num = (0.23884*TMath::Erf((x+2.58899)/5.20292))+0.75406;
      else if (idx == 3   ) num = (0.23050*TMath::Erf((x+9.97028)/5.55216))+0.75098;
      else if (idx == 4   ) num = (0.28897*TMath::Erf((x+6.09024)/6.29636))+0.69906;
      else if (idx == 5   ) num = (0.24178*TMath::Erf((x+5.55785)/6.97474))+0.74908;
      else if (idx == 6   ) num = (0.23549*TMath::Erf((x-0.29701)/2.06791))+0.74399;
      else if (idx == 7   ) num = (0.23226*TMath::Erf((x+9.86174)/6.97303))+0.75263;
      else if (idx == 8   ) num = (0.23420*TMath::Erf((x+9.93893)/8.97479))+0.75376;
      else if (idx == 9   ) num = (0.23125*TMath::Erf((x+9.55774)/5.65380))+0.75190;
      else if (idx == 10  ) num = (1.46831*TMath::Erf((x+9.28515)/6.84333))-0.48511;
      else if (idx == 11  ) num = (0.27554*TMath::Erf((x-2.30918)/0.44381))+0.70471;
      else if (idx == 12  ) num = (0.23047*TMath::Erf((x+9.99184)/5.21755))+0.75117;
      else if (idx == 13  ) num = (0.23208*TMath::Erf((x+9.97454)/5.00967))+0.75286;
      else if (idx == 14  ) num = (0.33354*TMath::Erf((x+9.00489)/9.10303))+0.65650;
      else if (idx == 15  ) num = (0.23159*TMath::Erf((x+6.11341)/6.59819))+0.75069;
      else if (idx == 16  ) num = (0.25521*TMath::Erf((x+2.32055)/4.34195))+0.73507;
      else if (idx == 17  ) num = (0.22669*TMath::Erf((x+9.83850)/7.23290))+0.74816;
      else if (idx == 18  ) num = (0.22968*TMath::Erf((x+9.43900)/4.47547))+0.75034;
      else if (idx == 19  ) num = (0.23454*TMath::Erf((x+9.97936)/9.64821))+0.75367;
      else if (idx == 20  ) num = (0.24224*TMath::Erf((x-1.42082)/1.37245))+0.74498;
      else if (idx == 21  ) num = (0.49617*TMath::Erf((x+8.68229)/8.31383))+0.49599;
      else if (idx == 22  ) num = (0.23243*TMath::Erf((x+9.77427)/3.87774))+0.75334;
      else if (idx == 23  ) num = (0.22870*TMath::Erf((x+9.55092)/4.47680))+0.74948;
      else if (idx == 24  ) num = (0.23750*TMath::Erf((x+8.56522)/10.30348))+0.75642;
      else if (idx == 25  ) num = (0.22727*TMath::Erf((x+9.93264)/5.06792))+0.74865;
      else if (idx == 26  ) num = (0.23494*TMath::Erf((x+9.99984)/8.35492))+0.75467;
      else if (idx == 27  ) num = (0.23117*TMath::Erf((x+9.90944)/7.46834))+0.75107;
      else if (idx == 28  ) num = (0.23479*TMath::Erf((x+9.56397)/10.74098))+0.75491;
      else if (idx == 29  ) num = (0.25432*TMath::Erf((x-2.24544)/0.47154))+0.73216;
      else if (idx == 30  ) num = (0.23991*TMath::Erf((x+0.57018)/2.90186))+0.74051;
      else if (idx == 31  ) num = (0.23061*TMath::Erf((x+9.71270)/9.88057))+0.75156;
      else if (idx == 32  ) num = (0.23247*TMath::Erf((x+9.99475)/7.61332))+0.75260;
      else if (idx == 33  ) num = (0.23555*TMath::Erf((x+9.99954)/8.85782))+0.75510;
      else if (idx == 34  ) num = (0.23663*TMath::Erf((x-0.77355)/1.64180))+0.74118;
      else if (idx == 35  ) num = (0.30666*TMath::Erf((x+7.83261)/5.55326))+0.67270;
      else if (idx == 36  ) num = (0.23647*TMath::Erf((x+9.99988)/9.27108))+0.75579;
      else if (idx == 37  ) num = (0.23364*TMath::Erf((x+9.95698)/9.26287))+0.75310;
      else if (idx == 38  ) num = (0.37572*TMath::Erf((x-2.35351)/0.35983))+0.60952;
      else if (idx == 39  ) num = (0.23526*TMath::Erf((x+10.00000)/9.12293))+0.75472;
      else if (idx == 40  ) num = (0.23636*TMath::Erf((x+2.26310)/4.70633))+0.75069;
      else if (idx == 41  ) num = (0.23118*TMath::Erf((x-2.42644)/0.30910))+0.75254;
      else if (idx == 42  ) num = (0.24007*TMath::Erf((x-0.49635)/2.03263))+0.74316;
      else if (idx == 43  ) num = (0.23049*TMath::Erf((x+9.99976)/4.42167))+0.75153;
      else if (idx == 44  ) num = (0.23373*TMath::Erf((x-1.51840)/1.19972))+0.75185;
      else if (idx == 45  ) num = (0.23775*TMath::Erf((x+9.58616)/10.34796))+0.75663;
      else if (idx == 46  ) num = (0.23011*TMath::Erf((x+9.99967)/8.80326))+0.75158;
      else if (idx == 47  ) num = (0.23548*TMath::Erf((x-2.12441)/0.50292))+0.74814;
      else if (idx == 48  ) num = (0.23293*TMath::Erf((x+8.11703)/9.72436))+0.75301;
      else if (idx == 49  ) num = (0.23652*TMath::Erf((x+9.92894)/10.10821))+0.75556;
      else if (idx == 50  ) num = (0.92451*TMath::Erf((x+9.12254)/7.13945))+0.05773;
      else if (idx == 51  ) num = (0.23857*TMath::Erf((x-1.85523)/0.80657))+0.74473;
      else if (idx == 52  ) num = (0.23717*TMath::Erf((x+9.99993)/9.83994))+0.75659;
      else if (idx == 53  ) num = (0.23134*TMath::Erf((x+9.81057)/8.18450))+0.75124;
      else if (idx == 54  ) num = (0.23352*TMath::Erf((x+9.99844)/8.93745))+0.75302;
      else if (idx == 55  ) num = (0.23730*TMath::Erf((x+9.97863)/12.34564))+0.75931;
      else if (idx == 56  ) num = (0.00028*TMath::Erf((x+0.19870)/30.42773))+0.98208;
      else if (idx == 57  ) num = (0.22560*TMath::Erf((x+9.81514)/4.18011))+0.74752;
      else if (idx == 58  ) num = (0.23896*TMath::Erf((x-2.33426)/0.34979))+0.74410;
      else if (idx == 59  ) num = (0.23447*TMath::Erf((x+9.99256)/9.53133))+0.75399;
      else if (idx == 60  ) num = (0.24226*TMath::Erf((x-1.96388)/1.03632))+0.74224;
      else if (idx == 61  ) num = (0.22985*TMath::Erf((x+9.96647)/10.48446))+0.75603;
      else if (idx == 62  ) num = (0.23782*TMath::Erf((x-1.92944)/0.82946))+0.74670;
      else if (idx == 63  ) num = (0.22874*TMath::Erf((x+9.83591)/7.06687))+0.74943;
      else if (idx == 64  ) num = (0.23100*TMath::Erf((x+9.17346)/9.36947))+0.75125;
      else if (idx == 65  ) num = (0.36249*TMath::Erf((x+9.06418)/7.05182))+0.61881;
      else if (idx == 66  ) num = (0.22945*TMath::Erf((x+9.67767)/6.32516))+0.74975;
      else if (idx == 67  ) num = (0.23188*TMath::Erf((x+9.90852)/8.13535))+0.75156;
      else if (idx == 68  ) num = (0.23855*TMath::Erf((x+9.97706)/10.79741))+0.75858;
      else if (idx == 69  ) num = (0.23422*TMath::Erf((x+9.96531)/9.59663))+0.75356;
      else if (idx == 70  ) num = (0.23300*TMath::Erf((x+9.99960)/5.14467))+0.75370;
      else if (idx == 71  ) num = (0.23428*TMath::Erf((x+9.98747)/7.29248))+0.75448;
      else if (idx == 72  ) num = (0.27072*TMath::Erf((x-0.04865)/2.51510))+0.71748;
      else if (idx == 73  ) num = (0.22964*TMath::Erf((x+9.13225)/3.56894))+0.75048;
      else if (idx == 74  ) num = (0.23304*TMath::Erf((x+9.99999)/8.69835))+0.75264;
      else if (idx == 75  ) num = (0.22845*TMath::Erf((x+9.74078)/3.43283))+0.74914;
      else if (idx == 76  ) num = (0.23286*TMath::Erf((x+9.78539)/8.07289))+0.75276;
      else if (idx == 77  ) num = (0.23974*TMath::Erf((x-0.11866)/2.30583))+0.74524;
      else if (idx == 78  ) num = (0.23035*TMath::Erf((x+9.99799)/11.39497))+0.76593;
      else if (idx == 79  ) num = (0.36549*TMath::Erf((x-2.43989)/0.32811))+0.61534;
      else if (idx == 80  ) num = (0.46196*TMath::Erf((x+8.81789)/8.12795))+0.52398;
      else if (idx == 81  ) num = (0.22886*TMath::Erf((x+9.63061)/3.59667))+0.74948;
      else if (idx == 82  ) num = (0.23205*TMath::Erf((x+9.95562)/3.50945))+0.75311;
      else if (idx == 83  ) num = (0.00563*TMath::Erf((x+1.88864)/32.43685))+0.97890;
      else if (idx == 84  ) num = (0.00266*TMath::Erf((x-7.93137)/33.69609))+0.98724;
      else if (idx == 85  ) num = (0.23333*TMath::Erf((x-0.59383)/1.80893))+0.75424;
      else if (idx == 86  ) num = (0.23174*TMath::Erf((x+9.57447)/5.83958))+0.75232;
      else if (idx == 87  ) num = (0.22969*TMath::Erf((x+8.73879)/4.66443))+0.75031;
      else if (idx == 88  ) num = (0.22908*TMath::Erf((x+9.93770)/5.91501))+0.74945;
      else if (idx == 89  ) num = (0.24573*TMath::Erf((x+4.16000)/5.90791))+0.74641;
      else if (idx == 90  ) num = (0.23593*TMath::Erf((x+8.50251)/10.09993))+0.75514;
      else if (idx == 91  ) num = (0.23009*TMath::Erf((x+9.98550)/5.95941))+0.75043;
      else if (idx == 92  ) num = (0.01006*TMath::Erf((x+8.80365)/29.17211))+0.97743;
      else if (idx == 93  ) num = (0.23220*TMath::Erf((x+9.77698)/3.59001))+0.75316;
      else if (idx == 94  ) num = (0.23972*TMath::Erf((x-1.89895)/0.85272))+0.74317;
      else if (idx == 95  ) num = (0.23532*TMath::Erf((x+9.99992)/8.30499))+0.75508;
      else if (idx == 96  ) num = (0.22781*TMath::Erf((x+9.98395)/3.83247))+0.74903;
      else if (idx == 97  ) num = (0.22949*TMath::Erf((x+9.35759)/3.17572))+0.75023;
      else if (idx == 98  ) num = (0.23351*TMath::Erf((x+9.96757)/9.55734))+0.75319;
      else if (idx == 99  ) num = (0.25330*TMath::Erf((x+0.57671)/2.80190))+0.73400;
      else if (idx == 100 ) num = (0.45671*TMath::Erf((x+9.81038)/8.30951))+0.53013;
   }
   else if (fabs(eta)<2.1)
   {
      if (idx==0) num = (0.02287*TMath::Erf((x-1.50087)/0.12003))+0.96844;
      else if (idx == -1   ) num = (0.02636*TMath::Erf((x-1.45884)/0.05752))+0.97133;
      else if (idx == -2   ) num = (0.01075*TMath::Erf((x-3.34421)/0.05089))+0.97152;
      else if (idx == 1   ) num = (0.01585*TMath::Erf((x-2.05329)/0.05937))+0.95844;
      else if (idx == 2   ) num = (0.01816*TMath::Erf((x-1.26217)/0.06755))+0.95895;
      else if (idx == 3   ) num = (0.01651*TMath::Erf((x-1.45709)/0.03706))+0.95920;
      else if (idx == 4   ) num = (0.01867*TMath::Erf((x-1.26547)/0.00476))+0.95882;
      else if (idx == 5   ) num = (0.02040*TMath::Erf((x-1.46131)/0.03596))+0.96560;
      else if (idx == 6   ) num = (0.01990*TMath::Erf((x-1.19286)/0.09278))+0.96044;
      else if (idx == 7   ) num = (0.01811*TMath::Erf((x-2.05372)/0.06970))+0.96262;
      else if (idx == 8   ) num = (0.02182*TMath::Erf((x-2.18976)/0.03527))+0.96744;
      else if (idx == 9   ) num = (0.03190*TMath::Erf((x+0.40170)/31.40744))+0.97539;
      else if (idx == 10  ) num = (0.01475*TMath::Erf((x-2.08798)/0.06255))+0.96064;
      else if (idx == 11  ) num = (0.01726*TMath::Erf((x-2.02941)/0.07946))+0.96128;
      else if (idx == 12  ) num = (0.01710*TMath::Erf((x-2.05335)/0.06062))+0.96088;
      else if (idx == 13  ) num = (0.02203*TMath::Erf((x-0.71665)/0.19207))+0.95318;
      else if (idx == 14  ) num = (0.01894*TMath::Erf((x-1.45968)/0.03285))+0.96352;
      else if (idx == 15  ) num = (0.02117*TMath::Erf((x-1.46221)/0.04624))+0.96658;
      else if (idx == 16  ) num = (0.02103*TMath::Erf((x-1.46201)/0.03652))+0.96640;
      else if (idx == 17  ) num = (0.02015*TMath::Erf((x-1.46104)/0.01964))+0.96527;
      else if (idx == 18  ) num = (0.01658*TMath::Erf((x-2.04326)/0.06924))+0.95996;
      else if (idx == 19  ) num = (0.02012*TMath::Erf((x-1.46103)/0.02553))+0.96523;
      else if (idx == 20  ) num = (0.02159*TMath::Erf((x-0.92387)/0.41471))+0.95746;
      else if (idx == 21  ) num = (0.02193*TMath::Erf((x-1.46311)/0.04677))+0.96745;
      else if (idx == 22  ) num = (0.01765*TMath::Erf((x-1.45830)/0.03839))+0.96138;
      else if (idx == 23  ) num = (0.03303*TMath::Erf((x-1.02503)/16.40738))+0.97398;
      else if (idx == 24  ) num = (0.02063*TMath::Erf((x-1.46177)/0.00021))+0.96590;
      else if (idx == 25  ) num = (0.01917*TMath::Erf((x-1.28846)/0.04055))+0.96038;
      else if (idx == 26  ) num = (0.02262*TMath::Erf((x+2.31230)/37.27508))+0.97861;
      else if (idx == 27  ) num = (0.01619*TMath::Erf((x-2.03894)/0.07389))+0.95920;
      else if (idx == 28  ) num = (0.01789*TMath::Erf((x-2.05445)/0.06657))+0.96224;
      else if (idx == 29  ) num = (0.01632*TMath::Erf((x-2.03740)/0.07962))+0.95947;
      else if (idx == 30  ) num = (0.01903*TMath::Erf((x-1.45980)/0.04416))+0.96367;
      else if (idx == 31  ) num = (0.02101*TMath::Erf((x-1.36993)/0.00064))+0.96492;
      else if (idx == 32  ) num = (0.02098*TMath::Erf((x-1.46220)/0.00631))+0.96634;
      else if (idx == 33  ) num = (0.01674*TMath::Erf((x-1.45733)/0.03577))+0.95965;
      else if (idx == 34  ) num = (0.00877*TMath::Erf((x-1.11666)/1.39924))+0.96896;
      else if (idx == 35  ) num = (0.01832*TMath::Erf((x-1.20498)/0.03114))+0.95742;
      else if (idx == 36  ) num = (0.01577*TMath::Erf((x-2.05145)/0.05337))+0.95827;
      else if (idx == 37  ) num = (0.01616*TMath::Erf((x+2.89575)/11.62447))+0.97591;
      else if (idx == 38  ) num = (0.01293*TMath::Erf((x-2.17377)/0.01338))+0.95244;
      else if (idx == 39  ) num = (0.01947*TMath::Erf((x-8.90869)/22.80138))+0.98320;
      else if (idx == 40  ) num = (0.02141*TMath::Erf((x-1.31375)/0.00891))+0.96450;
      else if (idx == 41  ) num = (0.01646*TMath::Erf((x+0.02997)/1.00404))+0.96449;
      else if (idx == 42  ) num = (0.01987*TMath::Erf((x-1.46081)/0.00352))+0.96488;
      else if (idx == 43  ) num = (0.01848*TMath::Erf((x-1.34116)/0.00006))+0.96053;
      else if (idx == 44  ) num = (0.02032*TMath::Erf((x-1.15659)/0.08666))+0.95897;
      else if (idx == 45  ) num = (0.01755*TMath::Erf((x-1.45820)/0.04019))+0.96120;
      else if (idx == 46  ) num = (0.01917*TMath::Erf((x-1.95833)/0.08980))+0.96391;
      else if (idx == 47  ) num = (0.00005*TMath::Erf((x+8.87393)/40.30051))+0.97682;
      else if (idx == 48  ) num = (0.02110*TMath::Erf((x-2.01798)/0.08957))+0.96653;
      else if (idx == 49  ) num = (0.02147*TMath::Erf((x-1.08401)/0.29594))+0.96097;
      else if (idx == 50  ) num = (0.02122*TMath::Erf((x-1.46228)/0.04237))+0.96664;
      else if (idx == 51  ) num = (0.01990*TMath::Erf((x-2.05784)/0.07189))+0.96520;
      else if (idx == 52  ) num = (0.01591*TMath::Erf((x-0.90982)/2.29276))+0.96471;
      else if (idx == 53  ) num = (0.01876*TMath::Erf((x-1.93129)/0.05551))+0.96344;
      else if (idx == 54  ) num = (0.01815*TMath::Erf((x-0.78471)/0.53945))+0.96427;
      else if (idx == 55  ) num = (0.05652*TMath::Erf((x-3.96348)/37.99473))+0.97275;
      else if (idx == 56  ) num = (0.01619*TMath::Erf((x-1.94859)/0.10272))+0.95994;
      else if (idx == 57  ) num = (0.02213*TMath::Erf((x-2.10022)/0.11976))+0.96770;
      else if (idx == 58  ) num = (0.00004*TMath::Erf((x+9.10420)/49.73307))+0.97651;
      else if (idx == 59  ) num = (0.01803*TMath::Erf((x-1.96941)/0.07974))+0.96225;
      else if (idx == 60  ) num = (0.01836*TMath::Erf((x-1.45907)/0.03932))+0.96260;
      else if (idx == 61  ) num = (0.01915*TMath::Erf((x-2.05347)/0.07239))+0.96418;
      else if (idx == 62  ) num = (0.01794*TMath::Erf((x-1.45861)/0.03768))+0.96189;
      else if (idx == 63  ) num = (0.01681*TMath::Erf((x+0.05526)/0.97500))+0.96581;
      else if (idx == 64  ) num = (0.02195*TMath::Erf((x-0.98741)/0.10920))+0.95788;
      else if (idx == 65  ) num = (0.01874*TMath::Erf((x-1.45946)/0.02015))+0.96321;
      else if (idx == 66  ) num = (0.01693*TMath::Erf((x-1.76815)/0.01614))+0.96015;
      else if (idx == 67  ) num = (0.01659*TMath::Erf((x-2.16622)/0.06642))+0.96106;
      else if (idx == 68  ) num = (0.02004*TMath::Erf((x-1.46089)/0.01953))+0.96513;
      else if (idx == 69  ) num = (0.00827*TMath::Erf((x+2.97053)/2.48579))+0.97143;
      else if (idx == 70  ) num = (0.01825*TMath::Erf((x-1.93280)/0.05051))+0.96265;
      else if (idx == 71  ) num = (0.02193*TMath::Erf((x-1.46317)/0.03018))+0.96745;
      else if (idx == 72  ) num = (0.02143*TMath::Erf((x-1.46255)/0.03543))+0.96688;
      else if (idx == 73  ) num = (0.00000*TMath::Erf((x+2.93078)/42.35600))+0.97764;
      else if (idx == 74  ) num = (0.01789*TMath::Erf((x-1.38362)/0.00189))+0.95948;
      else if (idx == 75  ) num = (0.01856*TMath::Erf((x-2.05774)/0.06405))+0.96331;
      else if (idx == 76  ) num = (0.02005*TMath::Erf((x-2.06924)/0.10054))+0.96535;
      else if (idx == 77  ) num = (0.00000*TMath::Erf((x+9.98786)/46.61744))+0.97375;
      else if (idx == 78  ) num = (0.01965*TMath::Erf((x-1.21084)/0.03825))+0.95899;
      else if (idx == 79  ) num = (0.01919*TMath::Erf((x-2.02121)/0.05238))+0.96423;
      else if (idx == 80  ) num = (0.01707*TMath::Erf((x-1.45768)/0.03433))+0.96031;
      else if (idx == 81  ) num = (0.02124*TMath::Erf((x-1.46229)/0.04435))+0.96665;
      else if (idx == 82  ) num = (0.01985*TMath::Erf((x-2.00899)/0.08246))+0.96495;
      else if (idx == 83  ) num = (0.01970*TMath::Erf((x-2.05752)/0.06609))+0.96494;
      else if (idx == 84  ) num = (0.01708*TMath::Erf((x-2.05230)/0.06117))+0.96086;
      else if (idx == 85  ) num = (0.02017*TMath::Erf((x-1.24187)/0.02898))+0.96161;
      else if (idx == 86  ) num = (0.01959*TMath::Erf((x-2.05845)/0.07154))+0.96478;
      else if (idx == 87  ) num = (0.01856*TMath::Erf((x-0.48386)/0.75337))+0.96573;
      else if (idx == 88  ) num = (0.01674*TMath::Erf((x-1.87847)/0.03358))+0.96008;
      else if (idx == 89  ) num = (0.02288*TMath::Erf((x-2.09833)/0.11618))+0.96845;
      else if (idx == 90  ) num = (0.02048*TMath::Erf((x-1.46146)/0.02594))+0.96571;
      else if (idx == 91  ) num = (0.02040*TMath::Erf((x-0.50631)/0.03527))+0.96562;
      else if (idx == 92  ) num = (0.01979*TMath::Erf((x-1.46062)/0.02970))+0.96477;
      else if (idx == 93  ) num = (0.02445*TMath::Erf((x-1.46538)/0.02781))+0.96989;
      else if (idx == 94  ) num = (0.01777*TMath::Erf((x-1.45843)/0.03554))+0.96159;
      else if (idx == 95  ) num = (0.01811*TMath::Erf((x-2.05973)/0.06345))+0.96258;
      else if (idx == 96  ) num = (0.01906*TMath::Erf((x-1.83685)/0.04203))+0.96378;
      else if (idx == 97  ) num = (0.01583*TMath::Erf((x-2.05404)/0.06220))+0.95840;
      else if (idx == 98  ) num = (0.01827*TMath::Erf((x-1.45897)/0.04007))+0.96245;
      else if (idx == 99  ) num = (0.01924*TMath::Erf((x-1.16828)/0.07993))+0.95775;
      else if (idx == 100 ) num = (0.01874*TMath::Erf((x-1.35833)/0.00027))+0.96137;
   }
   else
   {
      if (idx==0) num = (0.02083*TMath::Erf((x-4.83631)/0.17496))+0.97713;
      else if (idx == -1   ) (0.01141*TMath::Erf((x-4.28811)/0.09314))+0.98713;
      else if (idx == -2   ) (0.02626*TMath::Erf((x-4.94732)/0.00139))+0.96124;
      else if (idx == 1   ) num = (0.00555*TMath::Erf((x+7.87988)/5.21963))+0.94851;
      else if (idx == 2   ) num = (0.02281*TMath::Erf((x-4.54077)/0.11052))+0.96447;
      else if (idx == 3   ) num = (0.00190*TMath::Erf((x-4.54219)/0.09950))+0.96377;
      else if (idx == 4   ) num = (0.01723*TMath::Erf((x-4.97943)/0.00554))+0.96331;
      else if (idx == 5   ) num = (0.01909*TMath::Erf((x-5.14565)/0.00011))+0.96900;
      else if (idx == 6   ) num = (0.02805*TMath::Erf((x-4.40536)/0.46855))+0.94926;
      else if (idx == 7   ) num = (0.02725*TMath::Erf((x-5.06102)/0.00217))+0.96460;
      else if (idx == 8   ) num = (0.01434*TMath::Erf((x-4.84939)/0.02907))+0.95883;
      else if (idx == 9   ) num = (0.00767*TMath::Erf((x-4.92131)/0.04242))+0.96812;
      else if (idx == 10  ) num = (0.00733*TMath::Erf((x-4.65939)/0.14754))+0.96149;
      else if (idx == 11  ) num = (0.01770*TMath::Erf((x-4.80576)/0.22152))+0.97490;
      else if (idx == 12  ) num = (0.01923*TMath::Erf((x-5.15080)/0.00127))+0.97540;
      else if (idx == 13  ) num = (0.00990*TMath::Erf((x-4.00934)/0.08705))+0.97022;
      else if (idx == 14  ) num = (0.02008*TMath::Erf((x-5.59348)/1.25712))+0.97356;
      else if (idx == 15  ) num = (0.02143*TMath::Erf((x-4.56116)/0.07820))+0.96323;
      else if (idx == 16  ) num = (0.01490*TMath::Erf((x-4.85318)/0.02858))+0.95973;
      else if (idx == 17  ) num = (0.01701*TMath::Erf((x-4.96325)/0.00422))+0.97206;
      else if (idx == 18  ) num = (0.01179*TMath::Erf((x-4.50487)/0.08794))+0.96179;
      else if (idx == 19  ) num = (0.01234*TMath::Erf((x-4.95933)/0.00009))+0.96255;
      else if (idx == 20  ) num = (0.02869*TMath::Erf((x-4.84493)/0.02463))+0.96529;
      else if (idx == 21  ) num = (0.00669*TMath::Erf((x-4.88064)/0.16658))+0.95899;
      else if (idx == 22  ) num = (0.00149*TMath::Erf((x-5.05659)/0.00000))+0.96283;
      else if (idx == 23  ) num = (0.00888*TMath::Erf((x-4.98202)/0.02586))+0.98042;
      else if (idx == 24  ) num = (0.01953*TMath::Erf((x-4.98023)/0.01786))+0.96336;
      else if (idx == 25  ) num = (0.01379*TMath::Erf((x-2.17337)/0.00001))+0.95969;
      else if (idx == 26  ) num = (0.01917*TMath::Erf((x-4.54745)/0.09252))+0.96620;
      else if (idx == 27  ) num = (0.01523*TMath::Erf((x-5.00232)/0.00071))+0.95558;
      else if (idx == 28  ) num = (0.02445*TMath::Erf((x-4.65432)/0.19351))+0.95973;
      else if (idx == 29  ) num = (0.02215*TMath::Erf((x-5.32135)/1.24175))+0.96996;
      else if (idx == 30  ) num = (0.00271*TMath::Erf((x-5.18995)/0.02271))+0.96378;
      else if (idx == 31  ) num = (0.01869*TMath::Erf((x-4.84961)/0.02753))+0.97646;
      else if (idx == 32  ) num = (0.01793*TMath::Erf((x-6.06612)/0.11208))+0.97401;
      else if (idx == 33  ) num = (0.02199*TMath::Erf((x-4.69642)/0.22393))+0.97131;
      else if (idx == 34  ) num = (0.01738*TMath::Erf((x-4.99575)/0.07972))+0.96293;
      else if (idx == 35  ) num = (0.01993*TMath::Erf((x-5.19265)/0.00042))+0.96978;
      else if (idx == 36  ) num = (0.02208*TMath::Erf((x-4.84477)/0.03146))+0.97383;
      else if (idx == 37  ) num = (0.01495*TMath::Erf((x-4.95226)/0.00421))+0.95755;
      else if (idx == 38  ) num = (0.03090*TMath::Erf((x-5.04792)/0.00002))+0.96005;
      else if (idx == 39  ) num = (0.01425*TMath::Erf((x-4.77414)/0.23143))+0.97361;
      else if (idx == 40  ) num = (0.01913*TMath::Erf((x-5.20355)/0.00017))+0.97117;
      else if (idx == 41  ) num = (0.01689*TMath::Erf((x-4.30409)/0.17986))+0.96387;
      else if (idx == 42  ) num = (0.01768*TMath::Erf((x-5.12493)/0.00557))+0.97348;
      else if (idx == 43  ) num = (0.01624*TMath::Erf((x-4.80636)/0.23290))+0.97559;
      else if (idx == 44  ) num = (0.01722*TMath::Erf((x-4.99540)/0.01462))+0.95652;
      else if (idx == 45  ) num = (0.01500*TMath::Erf((x-4.79652)/0.22511))+0.97083;
      else if (idx == 46  ) num = (0.01159*TMath::Erf((x-5.04586)/0.00033))+0.96586;
      else if (idx == 47  ) num = (0.01592*TMath::Erf((x-3.98110)/0.08957))+0.96208;
      else if (idx == 48  ) num = (0.03670*TMath::Erf((x-2.62988)/0.00012))+0.94548;
      else if (idx == 49  ) num = (0.01143*TMath::Erf((x-4.91937)/0.00514))+0.96755;
      else if (idx == 50  ) num = (0.01528*TMath::Erf((x-3.93478)/0.06169))+0.97705;
      else if (idx == 51  ) num = (0.18250*TMath::Erf((x+6.28934)/48.50149))+0.92197;
      else if (idx == 52  ) num = (0.01849*TMath::Erf((x-5.46753)/0.28787))+0.97339;
      else if (idx == 53  ) num = (0.00973*TMath::Erf((x-2.29016)/0.00299))+0.95644;
      else if (idx == 54  ) num = (0.31659*TMath::Erf((x+2.18875)/5.41395))+0.66951;
      else if (idx == 55  ) num = (0.00670*TMath::Erf((x-5.06381)/0.01165))+0.96290;
      else if (idx == 56  ) num = (0.02475*TMath::Erf((x-4.96878)/0.04845))+0.96490;
      else if (idx == 57  ) num = (0.01971*TMath::Erf((x-4.90637)/0.04100))+0.96372;
      else if (idx == 58  ) num = (0.01716*TMath::Erf((x-5.54702)/1.40871))+0.97690;
      else if (idx == 59  ) num = (0.21603*TMath::Erf((x+5.44206)/8.35299))+0.77403;
      else if (idx == 60  ) num = (0.01727*TMath::Erf((x-4.84178)/0.17221))+0.97402;
      else if (idx == 61  ) num = (0.02406*TMath::Erf((x-4.84577)/0.03556))+0.96953;
      else if (idx == 62  ) num = (0.01783*TMath::Erf((x-5.16863)/0.00017))+0.96910;
      else if (idx == 63  ) num = (0.01873*TMath::Erf((x-5.93611)/0.58987))+0.97550;
      else if (idx == 64  ) num = (0.01887*TMath::Erf((x-4.94287)/0.00000))+0.96633;
      else if (idx == 65  ) num = (0.01524*TMath::Erf((x-5.02844)/0.00000))+0.96967;
      else if (idx == 66  ) num = (0.01802*TMath::Erf((x-4.88252)/0.02702))+0.97480;
      else if (idx == 67  ) num = (0.01022*TMath::Erf((x-5.07486)/0.09763))+0.96992;
      else if (idx == 68  ) num = (0.01721*TMath::Erf((x-4.84884)/0.02872))+0.96674;
      else if (idx == 69  ) num = (0.01609*TMath::Erf((x-4.86477)/0.02774))+0.95911;
      else if (idx == 70  ) num = (0.01784*TMath::Erf((x-4.82968)/0.21252))+0.97110;
      else if (idx == 71  ) num = (0.02505*TMath::Erf((x-4.92321)/0.00039))+0.96728;
      else if (idx == 72  ) num = (0.01299*TMath::Erf((x-4.78533)/0.30676))+0.96687;
      else if (idx == 73  ) num = (0.01093*TMath::Erf((x-4.34425)/0.26524))+0.95598;
      else if (idx == 74  ) num = (0.00720*TMath::Erf((x-4.63671)/0.00472))+0.96508;
      else if (idx == 75  ) num = (0.00777*TMath::Erf((x-4.85264)/0.02760))+0.97566;
      else if (idx == 76  ) num = (0.03977*TMath::Erf((x-2.38583)/0.30282))+0.92776;
      else if (idx == 77  ) num = (0.01083*TMath::Erf((x-5.00230)/0.00300))+0.95981;
      else if (idx == 78  ) num = (0.01812*TMath::Erf((x-4.33122)/0.47876))+0.96370;
      else if (idx == 79  ) num = (0.01963*TMath::Erf((x-4.89361)/0.20327))+0.96871;
      else if (idx == 80  ) num = (0.01906*TMath::Erf((x-4.95174)/0.00015))+0.96562;
      else if (idx == 81  ) num = (0.02039*TMath::Erf((x-4.53137)/0.12727))+0.95220;
      else if (idx == 82  ) num = (0.01510*TMath::Erf((x-5.44330)/0.11108))+0.97286;
      else if (idx == 83  ) num = (0.02143*TMath::Erf((x-4.65729)/0.19487))+0.96675;
      else if (idx == 84  ) num = (0.01479*TMath::Erf((x-4.87895)/0.06744))+0.97443;
      else if (idx == 85  ) num = (0.01816*TMath::Erf((x-5.04605)/0.00942))+0.97218;
      else if (idx == 86  ) num = (0.02904*TMath::Erf((x-2.77814)/0.02514))+0.95522;
      else if (idx == 87  ) num = (0.00191*TMath::Erf((x-5.03333)/0.00156))+0.95281;
      else if (idx == 88  ) num = (0.01356*TMath::Erf((x-4.87673)/0.08328))+0.97719;
      else if (idx == 89  ) num = (0.01506*TMath::Erf((x-4.52777)/0.07850))+0.95519;
      else if (idx == 90  ) num = (0.01496*TMath::Erf((x-4.47060)/0.07973))+0.96341;
      else if (idx == 91  ) num = (0.01651*TMath::Erf((x-5.18388)/0.00143))+0.97731;
      else if (idx == 92  ) num = (0.00637*TMath::Erf((x-4.68587)/0.22955))+0.96910;
      else if (idx == 93  ) num = (0.01671*TMath::Erf((x-4.63749)/0.16547))+0.97792;
      else if (idx == 94  ) num = (0.01396*TMath::Erf((x-5.18854)/0.99073))+0.98061;
      else if (idx == 95  ) num = (0.01587*TMath::Erf((x-4.57829)/0.11996))+0.97381;
      else if (idx == 96  ) num = (0.00828*TMath::Erf((x-4.35268)/0.04347))+0.94894;
      else if (idx == 97  ) num = (0.01747*TMath::Erf((x-4.94796)/0.00005))+0.95710;
      else if (idx == 98  ) num = (0.01641*TMath::Erf((x-4.84917)/0.02839))+0.96311;
      else if (idx == 99  ) num = (0.02324*TMath::Erf((x-4.76281)/0.21302))+0.96379;
      else if (idx == 100 ) num = (0.01298*TMath::Erf((x-4.91372)/0.00148))+0.97587;
   }

   // return
   return num/den;
}

#endif //#ifndef tnp_weight_h
